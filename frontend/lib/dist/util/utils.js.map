{"version":3,"file":"utils.js","names":["Alert","AlertProto","LabelVisibilityMessage","LabelVisibilityMessageProto","Element","Skeleton","SkeletonProto","get","xxhash","decamelize","debounce","delay","fn","timerId","_len","arguments","length","args","Array","_key","clearTimeout","setTimeout","EMBED_QUERY_PARAM_KEY","EMBED_OPTIONS_QUERY_PARAM_KEY","EMBED_SHOW_COLORED_LINE","EMBED_SHOW_TOOLBAR","EMBED_SHOW_PADDING","EMBED_DISABLE_SCROLLING","EMBED_LIGHT_THEME","EMBED_DARK_THEME","EMBED_TRUE","EMBED_HIDE_LOADING_SCREEN","EMBED_SHOW_LOADING_SCREEN_V1","EMBED_SHOW_LOADING_SCREEN_V2","EMBED_QUERY_PARAM_VALUES","LoadingScreenType","getEmbedUrlParams","embedKey","embedUrlParams","Set","urlParams","URLSearchParams","window","location","search","forEach","paramValue","paramKey","toString","toLowerCase","includes","add","preserveEmbedQueryParams","isEmbed","embedOptionsValues","getAll","embedUrlMap","push","embedValue","has","isColoredLineDisplayed","isToolbarDisplayed","isScrollingHidden","isPaddingDisplayed","isLightTheme","isDarkTheme","isInChildFrame","parent","getLoadingScreenType","params","NONE","V1","V2","makeElementWithInfoText","text","alert","body","format","Format","INFO","makeElementWithErrorText","ERROR","makeAppSkeletonElement","skeleton","style","SkeletonStyle","APP","hashString","s","h32","requireNonNull","obj","Error","notUndefined","value","undefined","notNull","notNullOrUndefined","isNullOrUndefined","timeout","ms","Promise","resolve","isFromMac","test","navigator","platform","isFromWindows","getCookie","name","r","document","cookie","match","concat","setCookie","expiration","expirationDate","Date","expirationStr","toUTCString","getElementWidgetID","element","type","isValidFormId","formId","isInForm","widget","LabelVisibilityOptions","labelVisibilityProtoValueToEnum","VISIBLE","Visible","HIDDEN","Hidden","COLLAPSED","Collapsed","findAnIFrameWithClassName","qs","className","i","cd","contentDocument","getElementsByClassName","canAccessIFrame","iframe","contentWindow","doc","html","innerHTML","err","getIFrameEnclosingApp","embeddingId","embeddingIdClassName","getEmbeddingIdClassName","qsStreamlitAppStr","querySelectorAll","foundIFrame","htmlCollection","getElementsByTagName","generateUID","Math","floor","now","random","slice","extractPageNameFromPathName","pathname","basePath","decodeURIComponent","replace","RegExp","keysToSnakeCase","Object","keys","reduce","acc","key","newKey","preserveConsecutiveUppercase","isArray","map","item"],"sources":["../../src/util/utils.ts"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Alert as AlertProto,\n  LabelVisibilityMessage as LabelVisibilityMessageProto,\n  Element,\n  Skeleton as SkeletonProto,\n} from \"@streamlit/lib/src/proto\"\nimport get from \"lodash/get\"\nimport xxhash from \"xxhashjs\"\nimport decamelize from \"decamelize\"\n\n/**\n * Wraps a function to allow it to be called, at most, once per interval\n * (specified in milliseconds). If the wrapper function is called N times\n * within that interval, only the Nth call will go through. The function\n * will only be called after the full interval has elapsed since the last\n * call.\n */\nexport function debounce(delay: number, fn: any): any {\n  let timerId: any\n\n  return (...args: any[]) => {\n    if (timerId) {\n      clearTimeout(timerId)\n    }\n\n    timerId = setTimeout(() => {\n      fn(...args)\n      timerId = null\n    }, delay)\n  }\n}\n\n/**\n * Embed query param values, which can be set in ?embed={value}, all should be lowercase\n */\nexport const EMBED_QUERY_PARAM_KEY = \"embed\"\nexport const EMBED_OPTIONS_QUERY_PARAM_KEY = \"embed_options\"\nexport const EMBED_SHOW_COLORED_LINE = \"show_colored_line\"\nexport const EMBED_SHOW_TOOLBAR = \"show_toolbar\"\nexport const EMBED_SHOW_PADDING = \"show_padding\"\nexport const EMBED_DISABLE_SCROLLING = \"disable_scrolling\"\nexport const EMBED_LIGHT_THEME = \"light_theme\"\nexport const EMBED_DARK_THEME = \"dark_theme\"\nexport const EMBED_TRUE = \"true\"\nexport const EMBED_HIDE_LOADING_SCREEN = \"hide_loading_screen\"\nexport const EMBED_SHOW_LOADING_SCREEN_V1 = \"show_loading_screen_v1\"\nexport const EMBED_SHOW_LOADING_SCREEN_V2 = \"show_loading_screen_v2\"\nexport const EMBED_QUERY_PARAM_VALUES = [\n  EMBED_SHOW_COLORED_LINE,\n  EMBED_SHOW_TOOLBAR,\n  EMBED_SHOW_PADDING,\n  EMBED_DISABLE_SCROLLING,\n  EMBED_LIGHT_THEME,\n  EMBED_DARK_THEME,\n  EMBED_HIDE_LOADING_SCREEN,\n  EMBED_SHOW_LOADING_SCREEN_V1,\n  EMBED_SHOW_LOADING_SCREEN_V2,\n  EMBED_TRUE,\n]\n\nexport enum LoadingScreenType {\n  NONE,\n  V1,\n  V2,\n}\n\n/**\n * Returns list of defined in EMBED_QUERY_PARAM_VALUES url params of given key\n * (EMBED_QUERY_PARAM_KEY, EMBED_OPTIONS_QUERY_PARAM_KEY). Is case insensitive.\n */\nexport function getEmbedUrlParams(embedKey: string): Set<string> {\n  const embedUrlParams = new Set<string>()\n  const urlParams = new URLSearchParams(window.location.search)\n  urlParams.forEach((paramValue, paramKey) => {\n    paramKey = paramKey.toString().toLowerCase()\n    paramValue = paramValue.toString().toLowerCase()\n    if (\n      paramKey === embedKey &&\n      EMBED_QUERY_PARAM_VALUES.includes(paramValue)\n    ) {\n      embedUrlParams.add(paramValue)\n    }\n  })\n  return embedUrlParams\n}\n\n/**\n * Returns \"embed\" and \"embed_options\" query param options in the url. Returns empty string if not embedded.\n * Example:\n *  returns \"embed=true&embed_options=show_loading_screen_v2\" if the url is\n *  http://localhost:3000/test?embed=true&embed_options=show_loading_screen_v2\n */\nexport function preserveEmbedQueryParams(): string {\n  if (!isEmbed()) {\n    return \"\"\n  }\n\n  const embedOptionsValues = new URLSearchParams(\n    window.location.search\n  ).getAll(EMBED_OPTIONS_QUERY_PARAM_KEY)\n\n  // instantiate multiple key values with an array of string pairs\n  // https://stackoverflow.com/questions/72571132/urlsearchparams-with-multiple-values\n  const embedUrlMap: string[][] = []\n  embedUrlMap.push([EMBED_QUERY_PARAM_KEY, EMBED_TRUE])\n  embedOptionsValues.forEach((embedValue: string) => {\n    embedUrlMap.push([EMBED_OPTIONS_QUERY_PARAM_KEY, embedValue])\n  })\n  return new URLSearchParams(embedUrlMap).toString()\n}\n\n/**\n * Returns true if the URL parameters contain ?embed=true (case insensitive).\n */\nexport function isEmbed(): boolean {\n  return getEmbedUrlParams(EMBED_QUERY_PARAM_KEY).has(EMBED_TRUE)\n}\n\n/**\n * Returns true if the URL parameters contain ?embed=true&embed_options=show_colored_line (case insensitive).\n */\nexport function isColoredLineDisplayed(): boolean {\n  return (\n    isEmbed() &&\n    getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY).has(\n      EMBED_SHOW_COLORED_LINE\n    )\n  )\n}\n\n/**\n * Returns true if the URL parameters contain ?embed=true&embed_options=show_toolbar (case insensitive).\n */\nexport function isToolbarDisplayed(): boolean {\n  return (\n    isEmbed() &&\n    getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY).has(EMBED_SHOW_TOOLBAR)\n  )\n}\n\n/**\n * Returns true if the URL parameters contain ?embed=true&embed_options=disable_scrolling (case insensitive).\n */\nexport function isScrollingHidden(): boolean {\n  return (\n    isEmbed() &&\n    getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY).has(\n      EMBED_DISABLE_SCROLLING\n    )\n  )\n}\n\n/**\n * Returns true if the URL parameters contain ?embed=true&embed_options=show_padding (case insensitive).\n */\nexport function isPaddingDisplayed(): boolean {\n  return (\n    isEmbed() &&\n    getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY).has(EMBED_SHOW_PADDING)\n  )\n}\n\n/**\n * Returns true if the URL parameters contain ?embed_options=light_theme (case insensitive).\n */\nexport function isLightTheme(): boolean {\n  // NOTE: We don't check for ?embed=true here, because we want to allow display without any\n  // other embed options (for example in our e2e tests).\n  return getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY).has(\n    EMBED_LIGHT_THEME\n  )\n}\n\n/**\n * Returns true if the URL parameters contain ?embed_options=dark_theme (case insensitive).\n */\nexport function isDarkTheme(): boolean {\n  // NOTE: We don't check for ?embed=true here, because we want to allow display without any\n  // other embed options (for example in our e2e tests).\n  return getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY).has(EMBED_DARK_THEME)\n}\n\n/**\n * Returns true if the parent parameter indicates that we're in an iframe.\n */\nexport function isInChildFrame(): boolean {\n  return window.parent !== window\n}\n\n/**\n * Returns a string with the type of loading screen to use while the app is\n * waiting for the backend to send displayable protos.\n */\nexport function getLoadingScreenType(): LoadingScreenType {\n  const params = getEmbedUrlParams(EMBED_OPTIONS_QUERY_PARAM_KEY)\n\n  return params.has(EMBED_HIDE_LOADING_SCREEN)\n    ? LoadingScreenType.NONE\n    : params.has(EMBED_SHOW_LOADING_SCREEN_V1)\n    ? LoadingScreenType.V1\n    : LoadingScreenType.V2\n}\n\n/** Return an info Element protobuf with the given text. */\nexport function makeElementWithInfoText(text: string): Element {\n  return new Element({\n    alert: {\n      body: text,\n      format: AlertProto.Format.INFO,\n    },\n  })\n}\n\n/** Return an error Element protobuf with the given text. */\nexport function makeElementWithErrorText(text: string): Element {\n  return new Element({\n    alert: {\n      body: text,\n      format: AlertProto.Format.ERROR,\n    },\n  })\n}\n\n/** Return a special internal-only Element showing an app \"skeleton\". */\nexport function makeAppSkeletonElement(): Element {\n  return new Element({\n    skeleton: { style: SkeletonProto.SkeletonStyle.APP },\n  })\n}\n\n/**\n * A helper function to hash a string using xxHash32 algorithm.\n * Seed used: 0xDEADBEEF\n */\nexport function hashString(s: string): string {\n  return xxhash.h32(s, 0xdeadbeef).toString(16)\n}\n\n/**\n * Coerces a possibly-null value into a non-null value, throwing an error\n * if the value is null or undefined.\n */\nexport function requireNonNull<T>(obj: T | null | undefined): T {\n  if (obj == null) {\n    throw new Error(\"value is null\")\n  }\n  return obj\n}\n\n/**\n * A type predicate that is true if the given value is not undefined.\n */\nexport function notUndefined<T>(value: T | undefined): value is T {\n  return value !== undefined\n}\n\n/**\n * A type predicate that is true if the given value is not null.\n */\nexport function notNull<T>(value: T | null): value is T {\n  return value != null\n}\n\n/**\n * A type predicate that is true if the given value is neither undefined\n * nor null.\n */\nexport function notNullOrUndefined<T>(\n  value: T | null | undefined\n): value is T {\n  return <T>value !== null && <T>value !== undefined\n}\n\n/**\n * A type predicate that is true if the given value is either undefined\n * or null.\n */\nexport function isNullOrUndefined<T>(\n  value: T | null | undefined\n): value is null | undefined {\n  return <T>value === null || <T>value === undefined\n}\n\n/**\n * A promise that would be resolved after certain time\n * @param ms number\n */\nexport function timeout(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n\n/**\n * Tests if the app is running from a Mac\n */\nexport function isFromMac(): boolean {\n  return /Mac/i.test(navigator.platform)\n}\n\n/**\n * Tests if the app is running from a Windows\n */\nexport function isFromWindows(): boolean {\n  return /^Win/i.test(navigator.platform)\n}\n\n/**\n * Returns cookie value\n */\nexport function getCookie(name: string): string | undefined {\n  const r = document.cookie.match(`\\\\b${name}=([^;]*)\\\\b`)\n  return r ? r[1] : undefined\n}\n\n/**\n * Sets cookie value\n */\nexport function setCookie(\n  name: string,\n  value?: string,\n  expiration?: Date\n): void {\n  const expirationDate = value ? expiration : new Date()\n  const expirationStr: string = expirationDate\n    ? `expires=${expirationDate.toUTCString()};`\n    : \"\"\n  document.cookie = `${name}=${value};${expirationStr}path=/`\n}\n\n/** Return an Element's widget ID if it's a widget, and undefined otherwise. */\nexport function getElementWidgetID(element: Element): string | undefined {\n  return get(element as any, [requireNonNull(element.type), \"id\"])\n}\n\n/** True if the given form ID is non-null and non-empty. */\nexport function isValidFormId(formId?: string): formId is string {\n  return formId != null && formId.length > 0\n}\n\n/** True if the given widget element is part of a form. */\nexport function isInForm(widget: { formId?: string }): boolean {\n  return isValidFormId(widget.formId)\n}\n\nexport enum LabelVisibilityOptions {\n  Visible,\n  Hidden,\n  Collapsed,\n}\n\nexport function labelVisibilityProtoValueToEnum(\n  value: LabelVisibilityMessageProto.LabelVisibilityOptions | null | undefined\n): LabelVisibilityOptions {\n  switch (value) {\n    case LabelVisibilityMessageProto.LabelVisibilityOptions.VISIBLE:\n      return LabelVisibilityOptions.Visible\n    case LabelVisibilityMessageProto.LabelVisibilityOptions.HIDDEN:\n      return LabelVisibilityOptions.Hidden\n    case LabelVisibilityMessageProto.LabelVisibilityOptions.COLLAPSED:\n      return LabelVisibilityOptions.Collapsed\n    default:\n      return LabelVisibilityOptions.Visible\n  }\n}\n\n/**\n * Looks for an IFrame with given className inside given querySet\n */\nexport function findAnIFrameWithClassName(\n  qs: NodeListOf<HTMLIFrameElement> | HTMLCollectionOf<HTMLIFrameElement>,\n  className: string\n): HTMLIFrameElement | null {\n  for (let i = 0; i < qs.length; i++) {\n    const cd = qs[i].contentDocument\n    if (cd && cd.getElementsByClassName(className).length > 0) {\n      return qs[i]\n    }\n  }\n  return null\n}\n\n/**\n * Returns True if IFrame can be accessed otherwise returns False\n */\nexport function canAccessIFrame(iframe: HTMLIFrameElement): boolean {\n  try {\n    if (iframe.contentWindow === null) return false\n    const doc = iframe.contentDocument || iframe.contentWindow.document\n    const html = doc.body.innerHTML\n    return html !== null && html !== \"\"\n  } catch (err) {\n    return false\n  }\n}\n\n/**\n * Tries to get an IFrame in which Streamlit app is embedded on Cloud deployments.\n * It assumes iframe has title=\"streamlitApp\", iterates over IFrames,\n * and looks which IFrame contains div with stAppId value, otherwise returns first found iFrame or null.\n */\nexport function getIFrameEnclosingApp(\n  embeddingId: string\n): HTMLIFrameElement | null {\n  if (!isInChildFrame()) {\n    return null\n  }\n  const embeddingIdClassName = getEmbeddingIdClassName(embeddingId)\n  const qsStreamlitAppStr = 'iframe[title=\"streamlitApp\"]'\n  let qs = window.document.querySelectorAll(\n    qsStreamlitAppStr\n  ) as NodeListOf<HTMLIFrameElement>\n  let foundIFrame = findAnIFrameWithClassName(qs, embeddingIdClassName)\n  if (foundIFrame && !canAccessIFrame(foundIFrame)) {\n    return null\n  }\n  if (foundIFrame) {\n    return foundIFrame\n  }\n  if (window.parent) {\n    qs = window.parent.document.querySelectorAll(qsStreamlitAppStr)\n  }\n  foundIFrame = findAnIFrameWithClassName(qs, embeddingIdClassName)\n  if (foundIFrame && !canAccessIFrame(foundIFrame)) {\n    return null\n  }\n  if (foundIFrame) {\n    return foundIFrame\n  }\n  let htmlCollection = window.document.getElementsByTagName(\n    \"iframe\"\n  ) as HTMLCollectionOf<HTMLIFrameElement>\n  foundIFrame = findAnIFrameWithClassName(htmlCollection, embeddingIdClassName)\n  if (foundIFrame && !canAccessIFrame(foundIFrame)) {\n    return null\n  }\n  if (foundIFrame) {\n    return foundIFrame\n  }\n  if (window.parent) {\n    htmlCollection = window.parent.document.getElementsByTagName(\"iframe\")\n  }\n  foundIFrame = findAnIFrameWithClassName(htmlCollection, embeddingIdClassName)\n  if (foundIFrame && !canAccessIFrame(foundIFrame)) {\n    return null\n  }\n  return foundIFrame\n}\n\n/**\n * Returns UID generated based on current date and Math.random module\n */\nexport function generateUID(): string {\n  return (\n    Math.floor(Date.now() / 1000).toString(36) +\n    Math.random().toString(36).slice(-6)\n  )\n}\n\n/**\n * Returns stAppEmbeddingId-${this.embeddingId} string,\n * which is used as class to detect iFrame when printing\n */\nexport function getEmbeddingIdClassName(embeddingId: string): string {\n  return `stAppEmbeddingId-${embeddingId}`\n}\n\nexport function extractPageNameFromPathName(\n  pathname: string,\n  basePath: string\n): string {\n  // We'd prefer to write something like\n  //\n  // ```\n  // replace(\n  //   new RegExp(`^/${basePath}/?`),\n  //   \"\"\n  // )\n  // ```\n  //\n  // below, but that doesn't work because basePath may contain unescaped\n  // regex special-characters. This is why we're stuck with the\n  // weird-looking triple `replace()`.\n  return decodeURIComponent(\n    document.location.pathname\n      .replace(`/${basePath}`, \"\")\n      .replace(new RegExp(\"^/?\"), \"\")\n      .replace(new RegExp(\"/$\"), \"\")\n  )\n}\n\n/**\n * Converts object keys from camelCase to snake_case, applied recursively to nested objects and arrays.\n * Keys containing dots are replaced with underscores. The conversion preserves consecutive uppercase letters.\n *\n * @param obj - The input object with keys to be converted. Can include nested objects and arrays.\n * @returns A new object with all keys in snake_case, maintaining the original structure and values.\n *\n * @example\n * keysToSnakeCase({\n *   userId: 1,\n *   user.Info: { firstName: \"John\", lastName: \"Doe\" },\n *   userActivities: [{ loginTime: \"10AM\", logoutTime: \"5PM\" }]\n * });\n * // Returns:\n * // {\n * //   user_id: 1,\n * //   user_info: { first_name: \"John\", last_name: \"Doe\" },\n * //   user_activities: [{ login_time: \"10AM\", logout_time: \"5PM\" }]\n * // }\n */\nexport function keysToSnakeCase(\n  obj: Record<string, any>\n): Record<string, any> {\n  return Object.keys(obj).reduce((acc, key) => {\n    const newKey = decamelize(key, {\n      preserveConsecutiveUppercase: true,\n    }).replace(\".\", \"_\")\n    let value = obj[key]\n\n    if (value && typeof value === \"object\" && !Array.isArray(value)) {\n      value = keysToSnakeCase(value)\n    }\n\n    if (Array.isArray(value)) {\n      value = value.map(item =>\n        typeof item === \"object\" ? keysToSnakeCase(item) : item\n      )\n    }\n\n    acc[newKey] = value\n    return acc\n  }, {} as Record<string, any>)\n}\n"],"mappings":"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"}