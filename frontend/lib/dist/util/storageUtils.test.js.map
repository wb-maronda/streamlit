{"version":3,"file":"storageUtils.test.js","names":["localStorageAvailable","describe","breakLocalStorage","jest","spyOn","window","localStorage","__proto__","mockImplementation","Error","afterEach","restoreAllMocks","clear","it","expect","toBe"],"sources":["../../src/util/storageUtils.test.ts"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { localStorageAvailable } from \"./storageUtils\"\n\ndescribe(\"localStorageAvailable\", () => {\n  // NOTE: localStorage is weird, and calling .spyOn(window.localStorage, \"setItem\")\n  // doesn't work. Accessing .__proto__ here isn't too bad of a crime since\n  // it's test code.\n  const breakLocalStorage = (): void => {\n    jest\n      // eslint-disable-next-line no-proto\n      .spyOn(window.localStorage.__proto__, \"setItem\")\n      .mockImplementation(() => {\n        throw new Error(\"boom\")\n      })\n  }\n\n  afterEach(() => {\n    jest.restoreAllMocks()\n    window.localStorage.clear()\n  })\n\n  it(\"returns false if a localStorage function explodes\", () => {\n    breakLocalStorage()\n    expect(localStorageAvailable()).toBe(false)\n  })\n\n  it(\"returns true if all localStorage functions work\", () => {\n    expect(localStorageAvailable()).toBe(true)\n  })\n})\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,qBAAqB;AAE9BC,QAAQ,CAAC,uBAAuB,EAAE,MAAM;EACtC;EACA;EACA;EACA,MAAMC,iBAAiB,GAAGA,CAAA,KAAY;IACpCC;IACE;IAAA,CACCC,KAAK,CAACC,MAAM,CAACC,YAAY,CAACC,SAAS,EAAE,SAAS,CAAC,CAC/CC,kBAAkB,CAAC,MAAM;MACxB,MAAM,IAAIC,KAAK,CAAC,MAAM,CAAC;IACzB,CAAC,CAAC;EACN,CAAC;EAEDC,SAAS,CAAC,MAAM;IACdP,IAAI,CAACQ,eAAe,CAAC,CAAC;IACtBN,MAAM,CAACC,YAAY,CAACM,KAAK,CAAC,CAAC;EAC7B,CAAC,CAAC;EAEFC,EAAE,CAAC,mDAAmD,EAAE,MAAM;IAC5DX,iBAAiB,CAAC,CAAC;IACnBY,MAAM,CAACd,qBAAqB,CAAC,CAAC,CAAC,CAACe,IAAI,CAAC,KAAK,CAAC;EAC7C,CAAC,CAAC;EAEFF,EAAE,CAAC,iDAAiD,EAAE,MAAM;IAC1DC,MAAM,CAACd,qBAAqB,CAAC,CAAC,CAAC,CAACe,IAAI,CAAC,IAAI,CAAC;EAC5C,CAAC,CAAC;AACJ,CAAC,CAAC"}