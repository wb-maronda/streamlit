{"version":3,"file":"FileHelper.js","names":["isFromWindows","FileSize","BYTE_CONVERSION_SIZE","sizeUnitSequence","Gigabyte","Megabyte","Kilobyte","Byte","getSizeDisplay","size","unit","rounding","arguments","length","undefined","Error","sizeIndex","indexOf","nextUnitSize","concat","toFixed","toUpperCase","sizeConverter","inputUnit","outputUnit","inputLevel","findIndex","outputLevel","levelsBetween","Math","abs","byteDifference"],"sources":["../../src/util/FileHelper.ts"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFromWindows } from \"@streamlit/lib/src/util/utils\"\n\nexport enum FileSize {\n  Gigabyte = \"gb\",\n  Megabyte = \"mb\",\n  Kilobyte = \"kb\",\n  Byte = \"b\",\n}\n\n// There is a shift towards displaying storage in base 10 vs base 2\n// but Windows is still displaying things in base 2. This does not handle\n// all cases but for simplicity general rule is to use base 2 for Windows.\nexport const BYTE_CONVERSION_SIZE = isFromWindows() ? 1024 : 1000\nconst sizeUnitSequence = [\n  FileSize.Gigabyte,\n  FileSize.Megabyte,\n  FileSize.Kilobyte,\n  FileSize.Byte,\n]\n\nexport const getSizeDisplay = (\n  size: number,\n  unit: FileSize,\n  rounding = 1\n): string => {\n  if (!unit) {\n    unit = FileSize.Byte\n  }\n\n  if (rounding < 0) {\n    rounding = 0\n  }\n\n  if (size < 0) {\n    throw new Error(\"Size must be greater than or equal to 0\")\n  }\n\n  const sizeIndex = sizeUnitSequence.indexOf(unit)\n  const nextUnitSize = size / BYTE_CONVERSION_SIZE\n  if (sizeIndex && size > BYTE_CONVERSION_SIZE / 2) {\n    return getSizeDisplay(\n      nextUnitSize,\n      sizeUnitSequence[sizeIndex - 1],\n      rounding\n    )\n  }\n  return `${size.toFixed(rounding)}${unit.toUpperCase()}`\n}\n\nexport const sizeConverter = (\n  size: number,\n  inputUnit: FileSize,\n  outputUnit: FileSize\n): number => {\n  if (size < 0) {\n    throw Error(\"Size must be 0 or greater\")\n  }\n\n  const inputLevel = sizeUnitSequence.findIndex(unit => unit === inputUnit)\n  const outputLevel = sizeUnitSequence.findIndex(unit => unit === outputUnit)\n\n  if (inputLevel === -1 || outputLevel === -1) {\n    // Should not ever occur\n    throw Error(\"Unexpected byte unit provided\")\n  }\n\n  if (inputLevel === outputLevel) {\n    return size\n  }\n\n  const levelsBetween = Math.abs(inputLevel - outputLevel)\n  const byteDifference = BYTE_CONVERSION_SIZE ** levelsBetween\n\n  if (inputLevel > outputLevel) {\n    // Going from smaller to bigger\n    return size / byteDifference\n  }\n  // Going from bigger to smaller\n  return size * byteDifference\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,aAAa;AAEtB,WAAYC,QAAQ;;AAOpB;AACA;AACA;AAAA,WATYA,QAAQ;EAARA,QAAQ;EAARA,QAAQ;EAARA,QAAQ;EAARA,QAAQ;AAAA,GAARA,QAAQ,KAARA,QAAQ;AAUpB,OAAO,MAAMC,oBAAoB,GAAGF,aAAa,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI;AACjE,MAAMG,gBAAgB,GAAG,CACvBF,QAAQ,CAACG,QAAQ,EACjBH,QAAQ,CAACI,QAAQ,EACjBJ,QAAQ,CAACK,QAAQ,EACjBL,QAAQ,CAACM,IAAI,CACd;AAED,OAAO,MAAMC,cAAc,GAAG,SAAAA,CAC5BC,IAAY,EACZC,IAAc,EAEH;EAAA,IADXC,QAAQ,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC;EAEZ,IAAI,CAACF,IAAI,EAAE;IACTA,IAAI,GAAGT,QAAQ,CAACM,IAAI;EACtB;EAEA,IAAII,QAAQ,GAAG,CAAC,EAAE;IAChBA,QAAQ,GAAG,CAAC;EACd;EAEA,IAAIF,IAAI,GAAG,CAAC,EAAE;IACZ,MAAM,IAAIM,KAAK,CAAC,yCAAyC,CAAC;EAC5D;EAEA,MAAMC,SAAS,GAAGb,gBAAgB,CAACc,OAAO,CAACP,IAAI,CAAC;EAChD,MAAMQ,YAAY,GAAGT,IAAI,GAAGP,oBAAoB;EAChD,IAAIc,SAAS,IAAIP,IAAI,GAAGP,oBAAoB,GAAG,CAAC,EAAE;IAChD,OAAOM,cAAc,CACnBU,YAAY,EACZf,gBAAgB,CAACa,SAAS,GAAG,CAAC,CAAC,EAC/BL,QACF,CAAC;EACH;EACA,UAAAQ,MAAA,CAAUV,IAAI,CAACW,OAAO,CAACT,QAAQ,CAAC,EAAAQ,MAAA,CAAGT,IAAI,CAACW,WAAW,CAAC,CAAC;AACvD,CAAC;AAED,OAAO,MAAMC,aAAa,GAAGA,CAC3Bb,IAAY,EACZc,SAAmB,EACnBC,UAAoB,KACT;EACX,IAAIf,IAAI,GAAG,CAAC,EAAE;IACZ,MAAMM,KAAK,CAAC,2BAA2B,CAAC;EAC1C;EAEA,MAAMU,UAAU,GAAGtB,gBAAgB,CAACuB,SAAS,CAAChB,IAAI,IAAIA,IAAI,KAAKa,SAAS,CAAC;EACzE,MAAMI,WAAW,GAAGxB,gBAAgB,CAACuB,SAAS,CAAChB,IAAI,IAAIA,IAAI,KAAKc,UAAU,CAAC;EAE3E,IAAIC,UAAU,KAAK,CAAC,CAAC,IAAIE,WAAW,KAAK,CAAC,CAAC,EAAE;IAC3C;IACA,MAAMZ,KAAK,CAAC,+BAA+B,CAAC;EAC9C;EAEA,IAAIU,UAAU,KAAKE,WAAW,EAAE;IAC9B,OAAOlB,IAAI;EACb;EAEA,MAAMmB,aAAa,GAAGC,IAAI,CAACC,GAAG,CAACL,UAAU,GAAGE,WAAW,CAAC;EACxD,MAAMI,cAAc,GAAG7B,oBAAoB,IAAI0B,aAAa;EAE5D,IAAIH,UAAU,GAAGE,WAAW,EAAE;IAC5B;IACA,OAAOlB,IAAI,GAAGsB,cAAc;EAC9B;EACA;EACA,OAAOtB,IAAI,GAAGsB,cAAc;AAC9B,CAAC"}