{"version":3,"file":"Block.test.js","names":["React","screen","Block","BlockProto","render","BlockNode","ScriptRunState","VerticalBlock","jsx","_jsx","FAKE_SCRIPT_HASH","ResizeObserver","observe","unobserve","disconnect","makeColumn","weight","children","arguments","length","undefined","allowEmpty","column","makeHorizontalBlock","numColumns","Array","from","horizontal","gap","makeVerticalBlock","additionalProps","makeVerticalBlockComponent","node","scriptRunId","scriptRunState","NOT_RUNNING","widgetsDisabled","widgetMgr","uploadClient","componentRegistry","formsData","describe","window","it","block","expect","getAllByTestId","toHaveLength","not","toHaveStyle","id","getByTestId","toBeVisible","toHaveClass","vertical","height","border"],"sources":["../../../../src/components/core/Block/Block.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport \"@testing-library/jest-dom\"\n\nimport { screen } from \"@testing-library/react\"\n\nimport { Block as BlockProto } from \"@streamlit/lib/src/proto\"\nimport { render } from \"@streamlit/lib/src/test_util\"\nimport { BlockNode } from \"@streamlit/lib/src/AppNode\"\nimport { ScriptRunState } from \"@streamlit/lib/src/ScriptRunState\"\n\nimport VerticalBlock from \"./Block\"\n\nconst FAKE_SCRIPT_HASH = \"fake_script_hash\"\nclass ResizeObserver {\n  observe(): void {}\n\n  unobserve(): void {}\n\n  disconnect(): void {}\n}\n\nfunction makeColumn(weight: number, children: BlockNode[] = []): BlockNode {\n  return new BlockNode(\n    FAKE_SCRIPT_HASH,\n    children,\n    new BlockProto({ allowEmpty: true, column: { weight } })\n  )\n}\n\nfunction makeHorizontalBlock(numColumns: number): BlockNode {\n  const weight = 1 / numColumns\n\n  return new BlockNode(\n    FAKE_SCRIPT_HASH,\n    Array.from({ length: numColumns }, () => makeColumn(weight)),\n    new BlockProto({ allowEmpty: true, horizontal: { gap: \"small\" } })\n  )\n}\n\nfunction makeVerticalBlock(\n  children: BlockNode[] = [],\n  additionalProps: Partial<BlockProto> = {}\n): BlockNode {\n  return new BlockNode(\n    FAKE_SCRIPT_HASH,\n    children,\n    new BlockProto({ allowEmpty: true, ...additionalProps })\n  )\n}\n\nfunction makeVerticalBlockComponent(node: BlockNode): ReactElement {\n  return (\n    <VerticalBlock\n      node={node}\n      scriptRunId={\"\"}\n      scriptRunState={ScriptRunState.NOT_RUNNING}\n      widgetsDisabled={false}\n      // @ts-expect-error\n      widgetMgr={undefined}\n      // @ts-expect-error\n      uploadClient={undefined}\n      // @ts-expect-error\n      componentRegistry={undefined}\n      // @ts-expect-error\n      formsData={undefined}\n    />\n  )\n}\n\ndescribe(\"Vertical Block Component\", () => {\n  window.ResizeObserver = ResizeObserver\n  it(\"should render a horizontal block with empty columns\", () => {\n    const block: BlockNode = makeVerticalBlock([makeHorizontalBlock(4)])\n    render(makeVerticalBlockComponent(block))\n\n    expect(screen.getAllByTestId(\"stColumn\")).toHaveLength(4)\n    expect(\n      screen.getAllByTestId(\"stVerticalBlockBorderWrapper\")[0]\n    ).not.toHaveStyle(\"overflow: auto\")\n  })\n\n  it(\"should add the user-specified key as class\", () => {\n    const block: BlockNode = makeVerticalBlock([], {\n      id: \"$$ID-899e9b72e1539f21f8e82565d36609d0-first container\",\n    })\n    render(makeVerticalBlockComponent(block))\n\n    expect(screen.getByTestId(\"stVerticalBlock\")).toBeVisible()\n    expect(screen.getByTestId(\"stVerticalBlock\")).toHaveClass(\n      \"st-key-first-container\"\n    )\n  })\n\n  it(\"should activate scrolling when height is set\", () => {\n    const block: BlockNode = makeVerticalBlock([makeHorizontalBlock(4)], {\n      vertical: { height: 100 },\n    })\n\n    render(makeVerticalBlockComponent(block))\n\n    expect(\n      screen.getAllByTestId(\"stVerticalBlockBorderWrapper\")[0]\n    ).toHaveStyle(\"overflow: auto\")\n  })\n\n  it(\"should show border when border is True\", () => {\n    const block: BlockNode = makeVerticalBlock([makeHorizontalBlock(4)], {\n      vertical: { border: true },\n    })\n\n    render(makeVerticalBlockComponent(block))\n\n    expect(\n      screen.getAllByTestId(\"stVerticalBlockBorderWrapper\")[0]\n    ).toHaveStyle(\"border: 1px solid rgba(49, 51, 63, 0.2);\")\n  })\n})\n"],"mappings":"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"}