{"version":3,"file":"Favicon.test.js","names":["mockEndpoints","handleFavicon","getFaviconHref","faviconElement","document","querySelector","href","head","innerHTML","PIZZA_TWEMOJI_URL","SATELLITE_TWEMOJI_URL","CRESCENT_MOON_TWEMOJI_URL","FLAG_MATERIAL_ICON_URL","SMART_DISPLAY_MATERIAL_ICON_URL","ACCESSIBILITY_NEW_MATERIAL_ICON_URL","test","expect","toBe","describe","buildMediaURL","jest","fn","mockReturnValue","endpoints","it","toHaveBeenCalledWith","sendMessageToHost","favicon","type"],"sources":["../../../../src/components/elements/Favicon/Favicon.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { mockEndpoints } from \"@streamlit/lib/src/mocks/mocks\"\nimport { handleFavicon } from \"./Favicon\"\n\nfunction getFaviconHref(): string {\n  const faviconElement: HTMLLinkElement | null = document.querySelector(\n    \"link[rel='shortcut icon']\"\n  )\n  return faviconElement ? faviconElement.href : \"\"\n}\n\ndocument.head.innerHTML = `<link rel=\"shortcut icon\" href=\"default.png\">`\n\nconst PIZZA_TWEMOJI_URL =\n  \"https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f355.png\"\nconst SATELLITE_TWEMOJI_URL =\n  \"https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f6f0.png\"\nconst CRESCENT_MOON_TWEMOJI_URL =\n  \"https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f319.png\"\n\nconst FLAG_MATERIAL_ICON_URL =\n  \"https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/flag/default/24px.svg\"\n\nconst SMART_DISPLAY_MATERIAL_ICON_URL =\n  \"https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/smart_display/default/24px.svg\"\n\nconst ACCESSIBILITY_NEW_MATERIAL_ICON_URL =\n  \"https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/accessibility_new/default/24px.svg\"\n\ntest(\"is set up with the default favicon\", () => {\n  expect(getFaviconHref()).toBe(\"http://localhost/default.png\")\n})\n\ndescribe(\"Favicon element\", () => {\n  const buildMediaURL = jest.fn().mockReturnValue(\"https://mock.media.url\")\n  const endpoints = mockEndpoints({ buildMediaURL: buildMediaURL })\n\n  it(\"sets the favicon in the DOM\", () => {\n    handleFavicon(\"https://some/random/favicon.png\", jest.fn(), endpoints)\n    expect(buildMediaURL).toHaveBeenCalledWith(\n      \"https://some/random/favicon.png\"\n    )\n    expect(getFaviconHref()).toBe(\"https://mock.media.url/\")\n  })\n\n  it(\"accepts emojis directly\", () => {\n    handleFavicon(\"🍕\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(PIZZA_TWEMOJI_URL)\n  })\n\n  it(\"handles emoji variants correctly\", () => {\n    handleFavicon(\"🛰\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(SATELLITE_TWEMOJI_URL)\n  })\n\n  it(\"handles material icon correctly\", () => {\n    handleFavicon(\":material/flag:\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(FLAG_MATERIAL_ICON_URL)\n\n    handleFavicon(\":material/smart_display:\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(SMART_DISPLAY_MATERIAL_ICON_URL)\n\n    handleFavicon(\":material/accessibility_new:\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(ACCESSIBILITY_NEW_MATERIAL_ICON_URL)\n  })\n\n  it(\"handles emoji shortcodes containing a dash correctly\", () => {\n    handleFavicon(\":crescent-moon:\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(CRESCENT_MOON_TWEMOJI_URL)\n  })\n\n  it(\"accepts emoji shortcodes\", () => {\n    handleFavicon(\":pizza:\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(PIZZA_TWEMOJI_URL)\n  })\n\n  it(\"updates the favicon when it changes\", () => {\n    handleFavicon(\"/media/1234567890.png\", jest.fn(), endpoints)\n    handleFavicon(\":pizza:\", jest.fn(), endpoints)\n    expect(getFaviconHref()).toBe(PIZZA_TWEMOJI_URL)\n  })\n\n  it(\"sends SET_PAGE_FAVICON message to host\", () => {\n    const sendMessageToHost = jest.fn()\n    handleFavicon(\n      \"https://streamlit.io/path/to/favicon.png\",\n      sendMessageToHost,\n      endpoints\n    )\n    expect(sendMessageToHost).toHaveBeenCalledWith({\n      favicon: \"https://mock.media.url\",\n      type: \"SET_PAGE_FAVICON\",\n    })\n  })\n})\n"],"mappings":"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"}