{"version":3,"file":"Favicon.js","names":["nodeEmoji","grabTheRightIcon","iconToUrl","icon","iconRegexp","matchResult","match","iconUrl","concat","handleFavicon","favicon","sendMessageToHost","endpoints","emoji","extractEmoji","imageUrl","startsWith","codepoint","emojiUrl","buildMediaURL","overwriteFavicon","type","faviconElement","document","querySelector","href","maybeEmoji","shortcode","replace","hasEmoji","get"],"sources":["../../../../src/components/elements/Favicon/Favicon.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport nodeEmoji from \"node-emoji\"\nimport { grabTheRightIcon } from \"@streamlit/lib/src/vendor/twemoji\"\nimport { IGuestToHostMessage } from \"@streamlit/lib/src/hostComm/types\"\nimport { StreamlitEndpoints } from \"@streamlit/lib/src/StreamlitEndpoints\"\n\nfunction iconToUrl(icon: string): string {\n  const iconRegexp = /^:(.+)\\/(.+):$/\n  const matchResult = icon.match(iconRegexp)\n  if (matchResult === null) {\n    // If the icon is invalid, return just an empty string\n    return \"\"\n  }\n\n  const iconUrl = `https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/${matchResult[2]}/default/24px.svg`\n  return iconUrl\n}\n\n/**\n * Set the provided url/emoji as the page favicon.\n *\n * @param {string} favicon an image url, or an emoji like üçï or :pizza:\n * @param sendMessageToHost a function that posts messages to the app's parent iframe\n * @param endpoints\n */\nexport function handleFavicon(\n  favicon: string,\n  sendMessageToHost: (message: IGuestToHostMessage) => void,\n  endpoints: StreamlitEndpoints\n): void {\n  const emoji = extractEmoji(favicon)\n  let imageUrl\n\n  if (emoji && !favicon.startsWith(\":material\")) {\n    // Find the corresponding Twitter emoji on the CDN.\n    const codepoint = grabTheRightIcon(emoji)\n    const emojiUrl = `https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/${codepoint}.png`\n\n    imageUrl = emojiUrl\n  } else if (favicon.startsWith(\":material\")) {\n    imageUrl = iconToUrl(favicon)\n  } else {\n    imageUrl = endpoints.buildMediaURL(favicon)\n  }\n\n  overwriteFavicon(imageUrl)\n\n  sendMessageToHost({\n    type: \"SET_PAGE_FAVICON\",\n    favicon: imageUrl,\n  })\n}\n\n// Update the favicon in the DOM with the specified image.\nfunction overwriteFavicon(imageUrl: string): void {\n  const faviconElement: HTMLLinkElement | null = document.querySelector(\n    \"link[rel='shortcut icon']\"\n  )\n\n  if (faviconElement) {\n    faviconElement.href = imageUrl\n  }\n}\n\n// Return the emoji if it exists, or empty string otherwise\nfunction extractEmoji(maybeEmoji: string): string {\n  const shortcode = maybeEmoji.replace(\"-\", \"_\")\n  if (nodeEmoji.hasEmoji(nodeEmoji.get(shortcode))) {\n    // Format: pizza or :pizza:\n    // Since hasEmoji(':pizza:') == true, we must do this check first\n    return nodeEmoji.get(shortcode)\n  }\n  if (nodeEmoji.hasEmoji(maybeEmoji)) {\n    // Format: üçï\n    return maybeEmoji\n  }\n  return \"\"\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,SAAS,MAAM,YAAY;AAClC,SAASC,gBAAgB;AAIzB,SAASC,SAASA,CAACC,IAAY,EAAU;EACvC,MAAMC,UAAU,GAAG,gBAAgB;EACnC,MAAMC,WAAW,GAAGF,IAAI,CAACG,KAAK,CAACF,UAAU,CAAC;EAC1C,IAAIC,WAAW,KAAK,IAAI,EAAE;IACxB;IACA,OAAO,EAAE;EACX;EAEA,MAAME,OAAO,+EAAAC,MAAA,CAA+EH,WAAW,CAAC,CAAC,CAAC,sBAAmB;EAC7H,OAAOE,OAAO;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASE,aAAaA,CAC3BC,OAAe,EACfC,iBAAyD,EACzDC,SAA6B,EACvB;EACN,MAAMC,KAAK,GAAGC,YAAY,CAACJ,OAAO,CAAC;EACnC,IAAIK,QAAQ;EAEZ,IAAIF,KAAK,IAAI,CAACH,OAAO,CAACM,UAAU,CAAC,WAAW,CAAC,EAAE;IAC7C;IACA,MAAMC,SAAS,GAAGhB,gBAAgB,CAACY,KAAK,CAAC;IACzC,MAAMK,QAAQ,sEAAAV,MAAA,CAAsES,SAAS,SAAM;IAEnGF,QAAQ,GAAGG,QAAQ;EACrB,CAAC,MAAM,IAAIR,OAAO,CAACM,UAAU,CAAC,WAAW,CAAC,EAAE;IAC1CD,QAAQ,GAAGb,SAAS,CAACQ,OAAO,CAAC;EAC/B,CAAC,MAAM;IACLK,QAAQ,GAAGH,SAAS,CAACO,aAAa,CAACT,OAAO,CAAC;EAC7C;EAEAU,gBAAgB,CAACL,QAAQ,CAAC;EAE1BJ,iBAAiB,CAAC;IAChBU,IAAI,EAAE,kBAAkB;IACxBX,OAAO,EAAEK;EACX,CAAC,CAAC;AACJ;;AAEA;AACA,SAASK,gBAAgBA,CAACL,QAAgB,EAAQ;EAChD,MAAMO,cAAsC,GAAGC,QAAQ,CAACC,aAAa,CACnE,2BACF,CAAC;EAED,IAAIF,cAAc,EAAE;IAClBA,cAAc,CAACG,IAAI,GAAGV,QAAQ;EAChC;AACF;;AAEA;AACA,SAASD,YAAYA,CAACY,UAAkB,EAAU;EAChD,MAAMC,SAAS,GAAGD,UAAU,CAACE,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC;EAC9C,IAAI5B,SAAS,CAAC6B,QAAQ,CAAC7B,SAAS,CAAC8B,GAAG,CAACH,SAAS,CAAC,CAAC,EAAE;IAChD;IACA;IACA,OAAO3B,SAAS,CAAC8B,GAAG,CAACH,SAAS,CAAC;EACjC;EACA,IAAI3B,SAAS,CAAC6B,QAAQ,CAACH,UAAU,CAAC,EAAE;IAClC;IACA,OAAOA,UAAU;EACnB;EACA,OAAO,EAAE;AACX"}