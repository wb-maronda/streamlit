{"version":3,"file":"ChatMessage.js","names":["React","useTheme","Face","SmartToy","Block","BlockProto","Icon","DynamicIcon","StyledAvatarBackground","StyledAvatarIcon","StyledAvatarImage","StyledChatMessageContainer","StyledMessageContent","jsx","_jsx","jsxs","_jsxs","ChatMessageAvatar","props","avatar","avatarType","name","endpoints","theme","ChatMessage","AvatarType","IMAGE","src","buildMediaURL","alt","EMOJI","children","ICON","background","colors","red60","content","size","orange60","startsWith","iconValue","color","bodyText","charAt","toUpperCase","_ref","element","className","includes","toLowerCase"],"sources":["../../../../src/components/elements/ChatMessage/ChatMessage.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport { useTheme } from \"@emotion/react\"\nimport { Face, SmartToy } from \"@emotion-icons/material-outlined\"\n\nimport { Block as BlockProto } from \"@streamlit/lib/src/proto\"\nimport Icon, { DynamicIcon } from \"@streamlit/lib/src/components/shared/Icon\"\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\nimport { StreamlitEndpoints } from \"@streamlit/lib/src/StreamlitEndpoints\"\n\nimport {\n  StyledAvatarBackground,\n  StyledAvatarIcon,\n  StyledAvatarImage,\n  StyledChatMessageContainer,\n  StyledMessageContent,\n} from \"./styled-components\"\n\ninterface ChatMessageAvatarProps {\n  name: string\n  avatar?: string\n  avatarType?: BlockProto.ChatMessage.AvatarType\n  endpoints: StreamlitEndpoints\n}\n\nfunction ChatMessageAvatar(\n  props: Readonly<ChatMessageAvatarProps>\n): ReactElement {\n  const { avatar, avatarType, name, endpoints } = props\n  const theme: EmotionTheme = useTheme()\n\n  if (avatar) {\n    switch (avatarType) {\n      case BlockProto.ChatMessage.AvatarType.IMAGE:\n        return (\n          <StyledAvatarImage\n            src={endpoints.buildMediaURL(avatar)}\n            alt={`${name} avatar`}\n          />\n        )\n      case BlockProto.ChatMessage.AvatarType.EMOJI:\n        return <StyledAvatarBackground>{avatar}</StyledAvatarBackground>\n      case BlockProto.ChatMessage.AvatarType.ICON:\n        if (avatar === \"user\") {\n          return (\n            <StyledAvatarIcon\n              data-testid=\"stChatMessageAvatarUser\"\n              background={theme.colors.red60}\n            >\n              <Icon content={Face} size=\"lg\" />\n            </StyledAvatarIcon>\n          )\n        } else if (avatar === \"assistant\") {\n          return (\n            <StyledAvatarIcon\n              data-testid=\"stChatMessageAvatarAssistant\"\n              background={theme.colors.orange60}\n            >\n              <Icon content={SmartToy} size=\"lg\" />\n            </StyledAvatarIcon>\n          )\n        } else if (avatar.startsWith(\":material\")) {\n          return (\n            <StyledAvatarBackground data-testid=\"stChatMessageAvatarCustom\">\n              <DynamicIcon\n                size=\"lg\"\n                iconValue={avatar}\n                color={theme.colors.bodyText}\n              />\n            </StyledAvatarBackground>\n          )\n        }\n    }\n  }\n\n  // Fallback to first character of the name label if nothing else can be matched:\n  return (\n    <StyledAvatarBackground>\n      {name ? name.charAt(0).toUpperCase() : \"üßë‚Äçüíª\"}\n    </StyledAvatarBackground>\n  )\n}\n\nexport interface ChatMessageProps {\n  endpoints: StreamlitEndpoints\n  element: BlockProto.ChatMessage\n}\n\nconst ChatMessage: React.FC<React.PropsWithChildren<ChatMessageProps>> = ({\n  endpoints,\n  element,\n  children,\n}): ReactElement => {\n  const { avatar, avatarType, name } = element\n\n  return (\n    <StyledChatMessageContainer\n      className=\"stChatMessage\"\n      data-testid=\"stChatMessage\"\n      background={[\"user\", \"human\"].includes(name.toLowerCase())}\n    >\n      <ChatMessageAvatar\n        name={name}\n        avatar={avatar}\n        avatarType={avatarType}\n        endpoints={endpoints}\n      />\n      <StyledMessageContent\n        data-testid=\"stChatMessageContent\"\n        aria-label={`Chat message from ${name}`}\n      >\n        {children}\n      </StyledMessageContent>\n    </StyledChatMessageContainer>\n  )\n}\n\nexport default ChatMessage\n"],"mappings":"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"}