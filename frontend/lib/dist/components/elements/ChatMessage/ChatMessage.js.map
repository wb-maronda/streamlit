{"version":3,"file":"ChatMessage.js","names":["React","useTheme","Face","SmartToy","Block","BlockProto","Icon","DynamicIcon","StyledChatMessageContainer","StyledMessageContent","StyledAvatarImage","StyledAvatarIcon","StyledAvatarBackground","jsx","_jsx","jsxs","_jsxs","ChatMessageAvatar","props","avatar","avatarType","name","endpoints","theme","ChatMessage","AvatarType","IMAGE","src","buildMediaURL","alt","concat","EMOJI","children","ICON","background","colors","red60","content","size","orange60","startsWith","iconValue","color","bodyText","charAt","toUpperCase","_ref","element","className","includes","toLowerCase"],"sources":["../../../../src/components/elements/ChatMessage/ChatMessage.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\nimport { useTheme } from \"@emotion/react\"\nimport { Face, SmartToy } from \"@emotion-icons/material-outlined\"\n\nimport { Block as BlockProto } from \"@streamlit/lib/src/proto\"\nimport Icon, { DynamicIcon } from \"@streamlit/lib/src/components/shared/Icon\"\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\nimport { StreamlitEndpoints } from \"@streamlit/lib/src/StreamlitEndpoints\"\n\nimport {\n  StyledChatMessageContainer,\n  StyledMessageContent,\n  StyledAvatarImage,\n  StyledAvatarIcon,\n  StyledAvatarBackground,\n} from \"./styled-components\"\n\ninterface ChatMessageAvatarProps {\n  name: string\n  avatar?: string\n  avatarType?: BlockProto.ChatMessage.AvatarType\n  endpoints: StreamlitEndpoints\n}\n\nfunction ChatMessageAvatar(props: ChatMessageAvatarProps): ReactElement {\n  const { avatar, avatarType, name, endpoints } = props\n  const theme: EmotionTheme = useTheme()\n\n  if (avatar) {\n    switch (avatarType) {\n      case BlockProto.ChatMessage.AvatarType.IMAGE:\n        return (\n          <StyledAvatarImage\n            src={endpoints.buildMediaURL(avatar)}\n            alt={`${name} avatar`}\n          />\n        )\n      case BlockProto.ChatMessage.AvatarType.EMOJI:\n        return <StyledAvatarBackground>{avatar}</StyledAvatarBackground>\n      case BlockProto.ChatMessage.AvatarType.ICON:\n        if (avatar === \"user\") {\n          return (\n            <StyledAvatarIcon\n              data-testid=\"chatAvatarIcon-user\"\n              background={theme.colors.red60}\n            >\n              <Icon content={Face} size=\"lg\" />\n            </StyledAvatarIcon>\n          )\n        } else if (avatar === \"assistant\") {\n          return (\n            <StyledAvatarIcon\n              data-testid=\"chatAvatarIcon-assistant\"\n              background={theme.colors.orange60}\n            >\n              <Icon content={SmartToy} size=\"lg\" />\n            </StyledAvatarIcon>\n          )\n        } else if (avatar.startsWith(\":material\")) {\n          return (\n            <StyledAvatarBackground data-testid=\"chatAvatarIcon-custom\">\n              <DynamicIcon\n                size=\"lg\"\n                iconValue={avatar}\n                color={theme.colors.bodyText}\n              />\n            </StyledAvatarBackground>\n          )\n        }\n    }\n  }\n\n  // Fallback to first character of the name label if nothing else can be matched:\n  return (\n    <StyledAvatarBackground>\n      {name ? name.charAt(0).toUpperCase() : \"üßë‚Äçüíª\"}\n    </StyledAvatarBackground>\n  )\n}\n\nexport interface ChatMessageProps {\n  endpoints: StreamlitEndpoints\n  element: BlockProto.ChatMessage\n}\n\nconst ChatMessage: React.FC<React.PropsWithChildren<ChatMessageProps>> = ({\n  endpoints,\n  element,\n  children,\n}): ReactElement => {\n  const { avatar, avatarType, name } = element\n\n  return (\n    <StyledChatMessageContainer\n      className=\"stChatMessage\"\n      data-testid=\"stChatMessage\"\n      background={[\"user\", \"human\"].includes(name.toLowerCase())}\n    >\n      <ChatMessageAvatar\n        name={name}\n        avatar={avatar}\n        avatarType={avatarType}\n        endpoints={endpoints}\n      />\n      <StyledMessageContent\n        data-testid=\"stChatMessageContent\"\n        aria-label={`Chat message from ${name}`}\n      >\n        {children}\n      </StyledMessageContent>\n    </StyledChatMessageContainer>\n  )\n}\n\nexport default ChatMessage\n"],"mappings":"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"}