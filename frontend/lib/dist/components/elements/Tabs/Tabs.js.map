{"version":3,"file":"Tabs.js","names":["React","useContext","useEffect","useRef","useState","useTheme","Tab","UITab","Tabs","UITabs","isElementStale","LibContext","StreamlitMarkdown","StyledTabContainer","jsx","_jsx","props","widgetsDisabled","node","isStale","scriptRunState","scriptRunId","fragmentIdsThisRun","allTabLabels","activeTabKey","setActiveTabKey","activeTabName","setActiveTabName","children","deltaBlock","tab","label","tabListRef","theme","isOverflowing","setIsOverflowing","newTabKey","indexOf","current","scrollWidth","clientWidth","length","TAB_HEIGHT","TAB_BORDER_HEIGHT","spacing","threeXS","className","tabHeight","activateOnFocus","activeKey","onChange","_ref","renderAll","disabled","overrides","TabHighlight","style","backgroundColor","colors","fadedText40","primary","height","TabBorder","borderColorLight","TabList","ref","gap","lg","marginBottom","paddingBottom","overflowY","opacity","transition","Root","transform","map","appNode","index","isStaleTab","childProps","nodeLabel","toString","isSelected","isLast","title","source","allowHTML","isLabel","TabPanel","paddingLeft","none","paddingRight","paddingTop","whiteSpace","fontSize","fontSizes","sm","background","color","bodyText","outline","renderTabContent"],"sources":["../../../../src/components/elements/Tabs/Tabs.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ReactElement,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\"\n\nimport { useTheme } from \"@emotion/react\"\nimport { Tab as UITab, Tabs as UITabs } from \"baseui/tabs-motion\"\n\nimport { AppNode, BlockNode } from \"@streamlit/lib/src/AppNode\"\nimport { BlockPropsWithoutWidth } from \"@streamlit/lib/src/components/core/Block\"\nimport { isElementStale } from \"@streamlit/lib/src/components/core/Block/utils\"\nimport { LibContext } from \"@streamlit/lib/src/components/core/LibContext\"\nimport StreamlitMarkdown from \"@streamlit/lib/src/components/shared/StreamlitMarkdown\"\n\nimport { StyledTabContainer } from \"./styled-components\"\n\nexport interface TabProps extends BlockPropsWithoutWidth {\n  widgetsDisabled: boolean\n  node: BlockNode\n  isStale: boolean\n  renderTabContent: (childProps: any) => ReactElement\n}\n\nfunction Tabs(props: Readonly<TabProps>): ReactElement {\n  const { widgetsDisabled, node, isStale, scriptRunState, scriptRunId } = props\n  const { fragmentIdsThisRun } = useContext(LibContext)\n\n  let allTabLabels: string[] = []\n  const [activeTabKey, setActiveTabKey] = useState<React.Key>(0)\n  const [activeTabName, setActiveTabName] = useState<string>(\n    // @ts-expect-error\n    node.children[0].deltaBlock.tab.label || \"0\"\n  )\n\n  const tabListRef = useRef<HTMLUListElement>(null)\n  const theme = useTheme()\n\n  const [isOverflowing, setIsOverflowing] = useState(false)\n\n  // Reconciles active key & tab name\n  useEffect(() => {\n    const newTabKey = allTabLabels.indexOf(activeTabName)\n    if (newTabKey === -1) {\n      setActiveTabKey(0)\n      setActiveTabName(allTabLabels[0])\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [allTabLabels])\n\n  useEffect(() => {\n    if (tabListRef.current) {\n      const { scrollWidth, clientWidth } = tabListRef.current\n      setIsOverflowing(scrollWidth > clientWidth)\n    }\n\n    // If tab # changes, match the selected tab label, otherwise default to first tab\n    const newTabKey = allTabLabels.indexOf(activeTabName)\n    if (newTabKey !== -1) {\n      setActiveTabKey(newTabKey)\n      setActiveTabName(allTabLabels[newTabKey])\n    } else {\n      setActiveTabKey(0)\n      setActiveTabName(allTabLabels[0])\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [node.children.length])\n\n  const TAB_HEIGHT = \"2.5rem\"\n  const TAB_BORDER_HEIGHT = theme.spacing.threeXS\n  return (\n    <StyledTabContainer\n      className=\"stTabs\"\n      data-testid=\"stTabs\"\n      isOverflowing={isOverflowing}\n      tabHeight={TAB_HEIGHT}\n    >\n      <UITabs\n        activateOnFocus\n        activeKey={activeTabKey}\n        onChange={({ activeKey }) => {\n          setActiveTabKey(activeKey)\n          setActiveTabName(allTabLabels[activeKey as number])\n        }}\n        /* renderAll on UITabs should always be set to true to avoid scrolling issue\n           https://github.com/streamlit/streamlit/issues/5069\n         */\n        renderAll={true}\n        disabled={widgetsDisabled}\n        overrides={{\n          TabHighlight: {\n            style: () => ({\n              backgroundColor: widgetsDisabled\n                ? theme.colors.fadedText40\n                : theme.colors.primary,\n              height: TAB_BORDER_HEIGHT,\n            }),\n          },\n          TabBorder: {\n            style: () => ({\n              backgroundColor: theme.colors.borderColorLight,\n              height: TAB_BORDER_HEIGHT,\n            }),\n          },\n          TabList: {\n            props: { ref: tabListRef },\n            style: () => ({\n              gap: theme.spacing.lg,\n              marginBottom: `-${TAB_BORDER_HEIGHT}`,\n              paddingBottom: TAB_BORDER_HEIGHT,\n              overflowY: \"hidden\",\n              ...(isStale\n                ? {\n                    opacity: 0.33,\n                    transition: \"opacity 1s ease-in 0.5s\",\n                  }\n                : {}),\n            }),\n          },\n          Root: {\n            style: () => ({\n              // resetting transform to fix full screen wrapper\n              transform: \"none\",\n            }),\n          },\n        }}\n      >\n        {node.children.map((appNode: AppNode, index: number): ReactElement => {\n          // Reset available tab labels when rerendering\n          if (index === 0) {\n            allTabLabels = []\n          }\n\n          // If the tab is stale, disable it\n          const isStaleTab = isElementStale(\n            appNode,\n            scriptRunState,\n            scriptRunId,\n            fragmentIdsThisRun\n          )\n\n          // Ensure stale tab's elements are also marked stale/disabled\n          const childProps = {\n            ...props,\n            isStale: isStale || isStaleTab,\n            widgetsDisabled,\n            node: appNode as BlockNode,\n          }\n          let nodeLabel = index.toString()\n          if (childProps.node.deltaBlock?.tab?.label) {\n            nodeLabel = childProps.node.deltaBlock.tab.label\n          }\n          allTabLabels[index] = nodeLabel\n\n          const isSelected = activeTabKey.toString() === index.toString()\n          const isLast = index === node.children.length - 1\n\n          return (\n            <UITab\n              data-testid=\"stTab\"\n              title={\n                <StreamlitMarkdown\n                  source={nodeLabel}\n                  allowHTML={false}\n                  isLabel\n                />\n              }\n              key={index}\n              disabled={widgetsDisabled}\n              overrides={{\n                TabPanel: {\n                  style: () => ({\n                    paddingLeft: theme.spacing.none,\n                    paddingRight: theme.spacing.none,\n                    paddingBottom: theme.spacing.none,\n                    paddingTop: theme.spacing.lg,\n                  }),\n                },\n                Tab: {\n                  style: () => ({\n                    height: TAB_HEIGHT,\n                    whiteSpace: \"nowrap\",\n                    paddingLeft: theme.spacing.none,\n                    paddingRight: theme.spacing.none,\n                    paddingTop: theme.spacing.none,\n                    paddingBottom: theme.spacing.none,\n                    fontSize: theme.fontSizes.sm,\n                    background: \"transparent\",\n                    color: widgetsDisabled\n                      ? theme.colors.fadedText40\n                      : theme.colors.bodyText,\n                    \":focus\": {\n                      outline: \"none\",\n                      color: widgetsDisabled\n                        ? theme.colors.fadedText40\n                        : theme.colors.primary,\n                      background: \"none\",\n                    },\n                    \":hover\": {\n                      color: widgetsDisabled\n                        ? theme.colors.fadedText40\n                        : theme.colors.primary,\n                      background: \"none\",\n                    },\n                    ...(isSelected\n                      ? {\n                          color: widgetsDisabled\n                            ? theme.colors.fadedText40\n                            : theme.colors.primary,\n                        }\n                      : {}),\n                    ...(isOverflowing && isLast\n                      ? {\n                          // Add minimal required padding to hide the overscroll gradient\n                          paddingRight: \"0.6rem\",\n                        }\n                      : {}),\n                    ...(!isStale && isStaleTab\n                      ? {\n                          // Apply stale effect if only this specific\n                          // tab is stale but not the entire tab container.\n                          opacity: 0.33,\n                          transition: \"opacity 1s ease-in 0.5s\",\n                        }\n                      : {}),\n                  }),\n                },\n              }}\n            >\n              {props.renderTabContent(childProps)}\n            </UITab>\n          )\n        })}\n      </UITabs>\n    </StyledTabContainer>\n  )\n}\n\nexport default Tabs\n"],"mappings":"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"}