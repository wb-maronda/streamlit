{"version":3,"file":"Dialog.js","names":["React","useEffect","useMemo","useState","useTheme","SIZE","Modal","ModalBody","ModalHeader","Block","BlockProto","IsDialogContext","notNullOrUndefined","StyledDialogContent","Fragment","_Fragment","jsx","_jsx","jsxs","_jsxs","parseWidthConfig","width","theme","Dialog","DialogWidth","LARGE","paddingDifferenceDialogAndAppView","spacing","lg","sizes","contentMaxWidth","default","_ref","element","deltaMsgReceivedAt","children","title","dismissible","isOpen","initialIsOpen","setIsOpen","size","SMALL","closeable","onClose","DialogWithProvider","props","Provider","value"],"sources":["../../../../src/components/elements/Dialog/Dialog.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement, useEffect, useMemo, useState } from \"react\"\n\nimport { useTheme } from \"@emotion/react\"\nimport { SIZE } from \"baseui/modal\"\n\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\nimport Modal, {\n  ModalBody,\n  ModalHeader,\n} from \"@streamlit/lib/src/components/shared/Modal\"\nimport { Block as BlockProto } from \"@streamlit/lib/src/proto\"\nimport IsDialogContext from \"@streamlit/lib/src/components/core/IsDialogContext\"\nimport { notNullOrUndefined } from \"@streamlit/lib/src/util/utils\"\n\nimport { StyledDialogContent } from \"./styled-components\"\n\nexport interface Props {\n  element: BlockProto.Dialog\n  deltaMsgReceivedAt?: number\n}\n\nfunction parseWidthConfig(\n  width: BlockProto.Dialog.DialogWidth,\n  theme: EmotionTheme\n): string {\n  if (width === BlockProto.Dialog.DialogWidth.LARGE) {\n    // This is the same width incl. padding as the AppView container is using 704px (736px (= contentMaxWidth) - 32px padding).\n    // The dialog's total left and right padding is 48px. So the dialog needs a total width of 752px (=704px + 48px).\n    // The used calculation here makes the relation to the app content width more comprehendable than hardcoding.\n    // Note that a Modal has max-width:100%, so it looks good on mobile independent of the calculated size here.\n    const paddingDifferenceDialogAndAppView = theme.spacing.lg // the dialog has 0.5rem more padding left and right => 1rem\n    return `calc(${theme.sizes.contentMaxWidth} + ${paddingDifferenceDialogAndAppView})`\n  }\n\n  return SIZE.default\n}\n\nconst Dialog: React.FC<React.PropsWithChildren<Props>> = ({\n  element,\n  deltaMsgReceivedAt,\n  children,\n}): ReactElement => {\n  const { title, dismissible, width, isOpen: initialIsOpen } = element\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n\n  useEffect(() => {\n    // Only apply the open state if it was actually set in the proto.\n    if (notNullOrUndefined(initialIsOpen)) {\n      setIsOpen(initialIsOpen)\n    }\n\n    // when the deltaMsgReceivedAt changes, we might want to open the dialog again.\n    // since dismissing is a UI-only action, the initialIsOpen prop might not have\n    // changed which would lead to the dialog not opening again.\n  }, [initialIsOpen, deltaMsgReceivedAt])\n\n  const theme = useTheme()\n  const size: string = useMemo(\n    () =>\n      parseWidthConfig(width ?? BlockProto.Dialog.DialogWidth.SMALL, theme),\n    [width, theme]\n  )\n\n  // don't use the Modal's isOpen prop as it feels laggy when using it\n  if (!isOpen) {\n    return <></>\n  }\n\n  return (\n    <Modal\n      isOpen\n      closeable={dismissible}\n      onClose={() => setIsOpen(false)}\n      size={size}\n    >\n      <ModalHeader>{title}</ModalHeader>\n      <ModalBody>\n        <StyledDialogContent>{children}</StyledDialogContent>\n      </ModalBody>\n    </Modal>\n  )\n}\n\nfunction DialogWithProvider(\n  props: React.PropsWithChildren<Props>\n): ReactElement {\n  return (\n    <IsDialogContext.Provider value={true}>\n      <Dialog {...props} />\n    </IsDialogContext.Provider>\n  )\n}\n\nexport default DialogWithProvider\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,IAAkBC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AAEzE,SAASC,QAAQ,QAAQ,gBAAgB;AACzC,SAASC,IAAI,QAAQ,cAAc;AAGnC,OAAOC,KAAK,IACVC,SAAS,EACTC,WAAW;AAEb,SAASC,KAAK,IAAIC,UAAU;AAC5B,OAAOC,eAAe;AACtB,SAASC,kBAAkB;AAE3B,SAASC,mBAAmB;AAA6B,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAOzD,SAASC,gBAAgBA,CACvBC,KAAoC,EACpCC,KAAmB,EACX;EACR,IAAID,KAAK,KAAKX,UAAU,CAACa,MAAM,CAACC,WAAW,CAACC,KAAK,EAAE;IACjD;IACA;IACA;IACA;IACA,MAAMC,iCAAiC,GAAGJ,KAAK,CAACK,OAAO,CAACC,EAAE,EAAC;IAC3D,OAAQ,QAAON,KAAK,CAACO,KAAK,CAACC,eAAgB,MAAKJ,iCAAkC,GAAE;EACtF;EAEA,OAAOrB,IAAI,CAAC0B,OAAO;AACrB;AAEA,MAAMR,MAAgD,GAAGS,IAAA,IAIrC;EAAA,IAJsC;IACxDC,OAAO;IACPC,kBAAkB;IAClBC;EACF,CAAC,GAAAH,IAAA;EACC,MAAM;IAAEI,KAAK;IAAEC,WAAW;IAAEhB,KAAK;IAAEiB,MAAM,EAAEC;EAAc,CAAC,GAAGN,OAAO;EACpE,MAAM,CAACK,MAAM,EAAEE,SAAS,CAAC,GAAGrC,QAAQ,CAAU,KAAK,CAAC;EAEpDF,SAAS,CAAC,MAAM;IACd;IACA,IAAIW,kBAAkB,CAAC2B,aAAa,CAAC,EAAE;MACrCC,SAAS,CAACD,aAAa,CAAC;IAC1B;;IAEA;IACA;IACA;EACF,CAAC,EAAE,CAACA,aAAa,EAAEL,kBAAkB,CAAC,CAAC;EAEvC,MAAMZ,KAAK,GAAGlB,QAAQ,CAAC,CAAC;EACxB,MAAMqC,IAAY,GAAGvC,OAAO,CAC1B,MACEkB,gBAAgB,CAACC,KAAK,IAAIX,UAAU,CAACa,MAAM,CAACC,WAAW,CAACkB,KAAK,EAAEpB,KAAK,CAAC,EACvE,CAACD,KAAK,EAAEC,KAAK,CACf,CAAC;;EAED;EACA,IAAI,CAACgB,MAAM,EAAE;IACX,oBAAOrB,IAAA,CAAAF,SAAA,IAAI,CAAC;EACd;EAEA,oBACEI,KAAA,CAACb,KAAK;IACJgC,MAAM;IACNK,SAAS,EAAEN,WAAY;IACvBO,OAAO,EAAEA,CAAA,KAAMJ,SAAS,CAAC,KAAK,CAAE;IAChCC,IAAI,EAAEA,IAAK;IAAAN,QAAA,gBAEXlB,IAAA,CAACT,WAAW;MAAA2B,QAAA,EAAEC;IAAK,CAAc,CAAC,eAClCnB,IAAA,CAACV,SAAS;MAAA4B,QAAA,eACRlB,IAAA,CAACJ,mBAAmB;QAAAsB,QAAA,EAAEA;MAAQ,CAAsB;IAAC,CAC5C,CAAC;EAAA,CACP,CAAC;AAEZ,CAAC;AAED,SAASU,kBAAkBA,CACzBC,KAAqC,EACvB;EACd,oBACE7B,IAAA,CAACN,eAAe,CAACoC,QAAQ;IAACC,KAAK,EAAE,IAAK;IAAAb,QAAA,eACpClB,IAAA,CAACM,MAAM;MAAA,GAAKuB;IAAK,CAAG;EAAC,CACG,CAAC;AAE/B;AAEA,eAAeD,kBAAkB"}