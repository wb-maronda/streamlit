{"version":3,"file":"Toast.js","names":["React","useState","useEffect","useCallback","useMemo","withTheme","toaster","hasLightBackgroundColor","StreamlitMarkdown","Kind","AlertElement","StyledViewButton","StyledToastWrapper","StyledMessageWrapper","DynamicIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","generateToastOverrides","theme","lightBackground","Body","props","style","display","flexDirection","gap","spacing","md","width","sizes","sidebar","marginTop","borderTopLeftRadius","radii","default","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","paddingTop","lg","paddingBottom","paddingLeft","twoXL","paddingRight","backgroundColor","colors","gray10","gray90","color","bodyText","boxShadow","CloseIcon","fadedText40","fontSizes","height","marginRight","concat","shortenMessage","fullMessage","characterLimit","length","message","replace","substring","split","slice","join","trim","Toast","_ref","body","icon","displayMessage","shortened","expanded","setExpanded","toastKey","setToastKey","handleClick","styleOverrides","toastContent","children","iconValue","size","testid","source","allowHTML","isToast","className","onClick","inSidebar","newKey","info","overrides","update","transitionDuration","clear","sidebarErrorMessage","kind","ERROR"],"sources":["../../../../src/components/elements/Toast/Toast.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ReactElement,\n  useState,\n  useEffect,\n  useCallback,\n  useMemo,\n} from \"react\"\nimport { withTheme } from \"@emotion/react\"\nimport { toaster, ToastOverrides } from \"baseui/toast\"\n\nimport {\n  hasLightBackgroundColor,\n  EmotionTheme,\n} from \"@streamlit/lib/src/theme\"\n\nimport StreamlitMarkdown from \"@streamlit/lib/src/components/shared/StreamlitMarkdown\"\nimport { Kind } from \"@streamlit/lib/src/components/shared/AlertContainer\"\nimport AlertElement from \"@streamlit/lib/src/components/elements/AlertElement/AlertElement\"\n\nimport {\n  StyledViewButton,\n  StyledToastWrapper,\n  StyledMessageWrapper,\n} from \"./styled-components\"\nimport { DynamicIcon } from \"@streamlit/lib/src/components/shared/Icon\"\n\nexport interface ToastProps {\n  theme: EmotionTheme\n  body: string\n  icon?: string\n  width: number\n}\n\nfunction generateToastOverrides(theme: EmotionTheme): ToastOverrides {\n  const lightBackground = hasLightBackgroundColor(theme)\n  return {\n    Body: {\n      props: {\n        \"data-testid\": \"stToast\",\n      },\n      style: {\n        display: \"flex\",\n        flexDirection: \"row\",\n        gap: theme.spacing.md,\n        width: theme.sizes.sidebar,\n        marginTop: \"8px\",\n        // Warnings logged if you use shorthand property here:\n        borderTopLeftRadius: theme.radii.default,\n        borderTopRightRadius: theme.radii.default,\n        borderBottomLeftRadius: theme.radii.default,\n        borderBottomRightRadius: theme.radii.default,\n        paddingTop: theme.spacing.lg,\n        paddingBottom: theme.spacing.lg,\n        paddingLeft: theme.spacing.twoXL,\n        paddingRight: theme.spacing.twoXL,\n        backgroundColor: lightBackground\n          ? theme.colors.gray10\n          : theme.colors.gray90,\n        color: theme.colors.bodyText,\n        // Take standard BaseWeb shadow and adjust for dark backgrounds\n        boxShadow: lightBackground\n          ? \"0px 4px 16px rgba(0, 0, 0, 0.16)\"\n          : \"0px 4px 16px rgba(0, 0, 0, 0.7)\",\n      },\n    },\n    CloseIcon: {\n      style: {\n        color: theme.colors.fadedText40,\n        width: theme.fontSizes.lg,\n        height: theme.fontSizes.lg,\n        marginRight: `calc(-1 * ${theme.spacing.lg} / 2)`,\n        \":hover\": {\n          color: theme.colors.bodyText,\n        },\n      },\n    },\n  }\n}\n\n// Function used to truncate toast messages that are longer than three lines.\nexport function shortenMessage(fullMessage: string): string {\n  const characterLimit = 104\n\n  if (fullMessage.length > characterLimit) {\n    let message = fullMessage.replace(/^(.{104}[^\\s]*).*/, \"$1\")\n\n    if (message.length > characterLimit) {\n      message = message\n        .substring(0, characterLimit)\n        .split(\" \")\n        .slice(0, -1)\n        .join(\" \")\n    }\n\n    return message.trim()\n  }\n\n  return fullMessage\n}\n\nexport function Toast({ theme, body, icon, width }: ToastProps): ReactElement {\n  const displayMessage = shortenMessage(body)\n  const shortened = body !== displayMessage\n\n  const [expanded, setExpanded] = useState(!shortened)\n  const [toastKey, setToastKey] = useState<React.Key>(0)\n\n  const handleClick = useCallback((): void => {\n    setExpanded(!expanded)\n  }, [expanded])\n\n  const styleOverrides = useMemo(() => generateToastOverrides(theme), [theme])\n\n  const toastContent = useMemo(\n    () => (\n      <>\n        <StyledToastWrapper expanded={expanded}>\n          {icon && (\n            <DynamicIcon\n              iconValue={icon}\n              size=\"xl\"\n              testid=\"stToastDynamicIcon\"\n            />\n          )}\n          <StyledMessageWrapper>\n            <StreamlitMarkdown\n              source={expanded ? body : displayMessage}\n              allowHTML={false}\n              isToast\n            />\n            {shortened && (\n              <StyledViewButton\n                data-testid=\"toastViewButton\"\n                className=\"toastViewButton\"\n                onClick={handleClick}\n              >\n                {expanded ? \"view less\" : \"view more\"}\n              </StyledViewButton>\n            )}\n          </StyledMessageWrapper>\n        </StyledToastWrapper>\n      </>\n    ),\n    [shortened, expanded, body, icon, displayMessage, handleClick]\n  )\n\n  useEffect(() => {\n    // Handles the error case where st.sidebar.toast is called since\n    // baseweb would throw error anyway (no toast container in sidebar)\n    if (theme.inSidebar) return\n\n    // Uses toaster utility to create toast on mount and generate unique key\n    // to reference that toast for update/removal\n    const newKey = toaster.info(toastContent, {\n      overrides: { ...styleOverrides },\n    })\n    setToastKey(newKey)\n\n    return () => {\n      // Disable transition so toast doesn't flicker on removal\n      toaster.update(newKey, {\n        overrides: { Body: { style: { transitionDuration: 0 } } },\n      })\n      // Remove toast on unmount\n      toaster.clear(newKey)\n    }\n\n    // Array must be empty to run as mount/cleanup\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  useEffect(() => {\n    // Handles expand/collapse button behavior for long toast messages\n    toaster.update(toastKey, {\n      children: toastContent,\n      overrides: { ...styleOverrides },\n    })\n  }, [toastKey, toastContent, styleOverrides])\n\n  const sidebarErrorMessage = (\n    <AlertElement\n      kind={Kind.ERROR}\n      body=\"Streamlit API Error: `st.toast` cannot be called directly on the sidebar with `st.sidebar.toast`.\n        See our `st.toast` API [docs](https://docs.streamlit.io/develop/api-reference/status/st.toast) for more information.\"\n      width={width}\n    />\n  )\n  return (\n    // Shows error if toast is called on st.sidebar\n    <>{theme.inSidebar && sidebarErrorMessage}</>\n  )\n}\n\nexport default withTheme(Toast)\n"],"mappings":"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"}