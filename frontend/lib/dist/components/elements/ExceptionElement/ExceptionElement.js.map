{"version":3,"file":"ExceptionElement.js","names":["React","notNullOrUndefined","AlertContainer","Kind","StreamlitMarkdown","StyledMessageType","StyledStackTrace","StyledStackTraceRow","StyledStackTraceTitle","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","isNonEmptyString","value","ExceptionMessage","_ref","type","message","messageIsMarkdown","markdown","source","allowHTML","children","StackTrace","_ref2","stackTrace","map","row","index","ExceptionElement","_ref3","element","width","className","kind","isWarning","WARNING","ERROR","length"],"sources":["../../../../src/components/elements/ExceptionElement/ExceptionElement.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport { notNullOrUndefined } from \"@streamlit/lib/src/util/utils\"\nimport AlertContainer, {\n  Kind,\n} from \"@streamlit/lib/src/components/shared/AlertContainer\"\nimport StreamlitMarkdown from \"@streamlit/lib/src/components/shared/StreamlitMarkdown\"\nimport { Exception as ExceptionProto } from \"@streamlit/lib/src/proto\"\n\nimport {\n  StyledMessageType,\n  StyledStackTrace,\n  StyledStackTraceRow,\n  StyledStackTraceTitle,\n} from \"./styled-components\"\n\nexport interface ExceptionElementProps {\n  width: number\n  element: ExceptionProto\n}\n\ninterface ExceptionMessageProps {\n  type: string\n  message: string\n  messageIsMarkdown: boolean\n}\n\ninterface StackTraceProps {\n  stackTrace: string[]\n}\n\n/**\n * Return true if the string is non-null and non-empty.\n */\nfunction isNonEmptyString(value: string | null | undefined): boolean {\n  return notNullOrUndefined(value) && value !== \"\"\n}\n\nfunction ExceptionMessage({\n  type,\n  message,\n  messageIsMarkdown,\n}: Readonly<ExceptionMessageProps>): ReactElement {\n  // Build the message display.\n  // On the backend, we use the StreamlitException type for errors that\n  // originate from inside Streamlit. These errors have Markdown-formatted\n  // messages, and so we wrap those messages inside our Markdown renderer.\n\n  if (messageIsMarkdown) {\n    let markdown = `**${type}**`\n    if (message) {\n      markdown += `: ${message}`\n    }\n    return <StreamlitMarkdown source={markdown} allowHTML={false} />\n  }\n  return (\n    <>\n      <StyledMessageType>{type}</StyledMessageType>\n      {isNonEmptyString(message) ? `: ${message}` : null}\n    </>\n  )\n}\n\nfunction StackTrace({ stackTrace }: Readonly<StackTraceProps>): ReactElement {\n  // Build the stack trace display, if we got a stack trace.\n  return (\n    <>\n      <StyledStackTraceTitle>Traceback:</StyledStackTraceTitle>\n      <StyledStackTrace>\n        <code>\n          {stackTrace.map((row: string, index: number) => (\n            <StyledStackTraceRow key={index} data-testid=\"stExceptionTraceRow\">\n              {row}\n            </StyledStackTraceRow>\n          ))}\n        </code>\n      </StyledStackTrace>\n    </>\n  )\n}\n\n/**\n * Functional element representing formatted text.\n */\nexport default function ExceptionElement({\n  element,\n  width,\n}: Readonly<ExceptionElementProps>): ReactElement {\n  return (\n    <div className=\"stException\" data-testid=\"stException\">\n      <AlertContainer\n        kind={element.isWarning ? Kind.WARNING : Kind.ERROR}\n        width={width}\n      >\n        <div data-testid=\"stExceptionMessage\">\n          <ExceptionMessage\n            type={element.type}\n            message={element.message}\n            messageIsMarkdown={element.messageIsMarkdown}\n          />\n        </div>\n        {element.stackTrace && element.stackTrace.length > 0 ? (\n          <StackTrace stackTrace={element.stackTrace} />\n        ) : null}\n      </AlertContainer>\n    </div>\n  )\n}\n"],"mappings":"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"}