{"version":3,"file":"ExceptionElement.js","names":["React","AlertContainer","Kind","StreamlitMarkdown","StyledMessageType","StyledStackTrace","StyledStackTraceRow","StyledStackTraceTitle","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","isNonEmptyString","value","ExceptionMessage","_ref","type","message","messageIsMarkdown","markdown","concat","source","allowHTML","children","StackTrace","_ref2","stackTrace","map","row","index","ExceptionElement","_ref3","element","width","className","kind","isWarning","WARNING","ERROR","length"],"sources":["../../../../src/components/elements/ExceptionElement/ExceptionElement.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\nimport AlertContainer, {\n  Kind,\n} from \"@streamlit/lib/src/components/shared/AlertContainer\"\nimport StreamlitMarkdown from \"@streamlit/lib/src/components/shared/StreamlitMarkdown\"\nimport { Exception as ExceptionProto } from \"@streamlit/lib/src/proto\"\nimport {\n  StyledMessageType,\n  StyledStackTrace,\n  StyledStackTraceRow,\n  StyledStackTraceTitle,\n} from \"./styled-components\"\n\nexport interface ExceptionElementProps {\n  width: number\n  element: ExceptionProto\n}\n\ninterface ExceptionMessageProps {\n  type: string\n  message: string\n  messageIsMarkdown: boolean\n}\n\ninterface StackTraceProps {\n  stackTrace: string[]\n}\n\n/**\n * Return true if the string is non-null and non-empty.\n */\nfunction isNonEmptyString(value: string | null | undefined): boolean {\n  return value != null && value !== \"\"\n}\n\nfunction ExceptionMessage({\n  type,\n  message,\n  messageIsMarkdown,\n}: ExceptionMessageProps): ReactElement {\n  // Build the message display.\n  // On the backend, we use the StreamlitException type for errors that\n  // originate from inside Streamlit. These errors have Markdown-formatted\n  // messages, and so we wrap those messages inside our Markdown renderer.\n\n  if (messageIsMarkdown) {\n    let markdown = `**${type}**`\n    if (message) {\n      markdown += `: ${message}`\n    }\n    return <StreamlitMarkdown source={markdown} allowHTML={false} />\n  }\n  return (\n    <>\n      <StyledMessageType>{type}</StyledMessageType>\n      {isNonEmptyString(message) ? `: ${message}` : null}\n    </>\n  )\n}\n\nfunction StackTrace({ stackTrace }: StackTraceProps): ReactElement {\n  // Build the stack trace display, if we got a stack trace.\n  return (\n    <>\n      <StyledStackTraceTitle>Traceback:</StyledStackTraceTitle>\n      <StyledStackTrace>\n        <code>\n          {stackTrace.map((row: string, index: number) => (\n            <StyledStackTraceRow key={index} data-testid=\"stExceptionTraceRow\">\n              {row}\n            </StyledStackTraceRow>\n          ))}\n        </code>\n      </StyledStackTrace>\n    </>\n  )\n}\n\n/**\n * Functional element representing formatted text.\n */\nexport default function ExceptionElement({\n  element,\n  width,\n}: ExceptionElementProps): ReactElement {\n  return (\n    <div className=\"stException\" data-testid=\"stException\">\n      <AlertContainer\n        kind={element.isWarning ? Kind.WARNING : Kind.ERROR}\n        width={width}\n      >\n        <div className=\"message\">\n          <ExceptionMessage\n            type={element.type}\n            message={element.message}\n            messageIsMarkdown={element.messageIsMarkdown}\n          />\n        </div>\n        {element.stackTrace && element.stackTrace.length > 0 ? (\n          <StackTrace stackTrace={element.stackTrace} />\n        ) : null}\n      </AlertContainer>\n    </div>\n  )\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,MAAwB,OAAO;AAC3C,OAAOC,cAAc,IACnBC,IAAI;AAEN,OAAOC,iBAAiB;AAExB,SACEC,iBAAiB,EACjBC,gBAAgB,EAChBC,mBAAmB,EACnBC,qBAAqB;AACK,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAiB5B;AACA;AACA;AACA,SAASC,gBAAgBA,CAACC,KAAgC,EAAW;EACnE,OAAOA,KAAK,IAAI,IAAI,IAAIA,KAAK,KAAK,EAAE;AACtC;AAEA,SAASC,gBAAgBA,CAAAC,IAAA,EAIe;EAAA,IAJd;IACxBC,IAAI;IACJC,OAAO;IACPC;EACqB,CAAC,GAAAH,IAAA;EACtB;EACA;EACA;EACA;;EAEA,IAAIG,iBAAiB,EAAE;IACrB,IAAIC,QAAQ,QAAAC,MAAA,CAAQJ,IAAI,OAAI;IAC5B,IAAIC,OAAO,EAAE;MACXE,QAAQ,SAAAC,MAAA,CAASH,OAAO,CAAE;IAC5B;IACA,oBAAOV,IAAA,CAACN,iBAAiB;MAACoB,MAAM,EAAEF,QAAS;MAACG,SAAS,EAAE;IAAM,CAAE,CAAC;EAClE;EACA,oBACEX,KAAA,CAAAF,SAAA;IAAAc,QAAA,gBACEhB,IAAA,CAACL,iBAAiB;MAAAqB,QAAA,EAAEP;IAAI,CAAoB,CAAC,EAC5CJ,gBAAgB,CAACK,OAAO,CAAC,QAAAG,MAAA,CAAQH,OAAO,IAAK,IAAI;EAAA,CAClD,CAAC;AAEP;AAEA,SAASO,UAAUA,CAAAC,KAAA,EAAgD;EAAA,IAA/C;IAAEC;EAA4B,CAAC,GAAAD,KAAA;EACjD;EACA,oBACEd,KAAA,CAAAF,SAAA;IAAAc,QAAA,gBACEhB,IAAA,CAACF,qBAAqB;MAAAkB,QAAA,EAAC;IAAU,CAAuB,CAAC,eACzDhB,IAAA,CAACJ,gBAAgB;MAAAoB,QAAA,eACfhB,IAAA;QAAAgB,QAAA,EACGG,UAAU,CAACC,GAAG,CAAC,CAACC,GAAW,EAAEC,KAAa,kBACzCtB,IAAA,CAACH,mBAAmB;UAAa,eAAY,qBAAqB;UAAAmB,QAAA,EAC/DK;QAAG,GADoBC,KAEL,CACtB;MAAC,CACE;IAAC,CACS,CAAC;EAAA,CACnB,CAAC;AAEP;;AAEA;AACA;AACA;AACA,eAAe,SAASC,gBAAgBA,CAAAC,KAAA,EAGA;EAAA,IAHC;IACvCC,OAAO;IACPC;EACqB,CAAC,GAAAF,KAAA;EACtB,oBACExB,IAAA;IAAK2B,SAAS,EAAC,aAAa;IAAC,eAAY,aAAa;IAAAX,QAAA,eACpDZ,KAAA,CAACZ,cAAc;MACboC,IAAI,EAAEH,OAAO,CAACI,SAAS,GAAGpC,IAAI,CAACqC,OAAO,GAAGrC,IAAI,CAACsC,KAAM;MACpDL,KAAK,EAAEA,KAAM;MAAAV,QAAA,gBAEbhB,IAAA;QAAK2B,SAAS,EAAC,SAAS;QAAAX,QAAA,eACtBhB,IAAA,CAACO,gBAAgB;UACfE,IAAI,EAAEgB,OAAO,CAAChB,IAAK;UACnBC,OAAO,EAAEe,OAAO,CAACf,OAAQ;UACzBC,iBAAiB,EAAEc,OAAO,CAACd;QAAkB,CAC9C;MAAC,CACC,CAAC,EACLc,OAAO,CAACN,UAAU,IAAIM,OAAO,CAACN,UAAU,CAACa,MAAM,GAAG,CAAC,gBAClDhC,IAAA,CAACiB,UAAU;QAACE,UAAU,EAAEM,OAAO,CAACN;MAAW,CAAE,CAAC,GAC5C,IAAI;IAAA,CACM;EAAC,CACd,CAAC;AAEV"}