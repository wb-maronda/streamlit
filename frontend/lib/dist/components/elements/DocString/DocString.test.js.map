{"version":3,"file":"DocString.test.js","names":["React","screen","DocString","DocStringProto","render","Member","jsx","_jsx","getProps","elementProps","arguments","length","undefined","element","create","name","value","docString","type","width","describe","props","it","expect","getByTestId","toBeInTheDocument","toHaveTextContent","queryByTestId","not","members","getAllByTestId","toHaveLength","member","queryByText"],"sources":["../../../../src/components/elements/DocString/DocString.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\n\nimport \"@testing-library/jest-dom\"\nimport { screen } from \"@testing-library/react\"\n\nimport { DocString as DocStringProto } from \"@streamlit/lib/src/proto\"\nimport { render } from \"@streamlit/lib/src/test_util\"\n\nimport DocString, { DocStringProps, Member } from \"./DocString\"\n\nconst getProps = (\n  elementProps: Partial<DocStringProto> = {}\n): DocStringProps => ({\n  element: DocStringProto.create({\n    name: \"st.balloons\",\n    value: \"streamlit.balloons()\",\n    docString: \"docstring\",\n    type: \"method\",\n    ...elementProps,\n  }),\n  width: 0,\n})\n\ndescribe(\"DocString Element\", () => {\n  const props = getProps()\n\n  it(\"renders without crashing\", () => {\n    render(<DocString {...props} />)\n    expect(screen.getByTestId(\"stHelp\")).toBeInTheDocument()\n  })\n\n  it(\"should render a doc-string\", () => {\n    render(<DocString {...props} />)\n    expect(screen.getByTestId(\"stHelpDoc\")).toHaveTextContent(\n      props.element.docString\n    )\n  })\n\n  it(\"should render 'no docs' text when empty\", () => {\n    const props = getProps({\n      docString: undefined,\n    })\n    render(<DocString {...props} />)\n\n    expect(screen.getByTestId(\"stHelpDoc\")).toHaveTextContent(\n      \"No docs available\"\n    )\n  })\n\n  describe(\"doc-header\", () => {\n    it(\"should render a name\", () => {\n      render(<DocString {...props} />)\n      expect(screen.getByTestId(\"stHelpName\")).toHaveTextContent(\"st.balloons\")\n    })\n\n    it(\"should render value\", () => {\n      render(<DocString {...props} />)\n      expect(screen.getByTestId(\"stHelpValue\")).toHaveTextContent(\n        \"streamlit.balloons()\"\n      )\n    })\n\n    it(\"should render a type\", () => {\n      render(<DocString {...props} />)\n      expect(screen.getByTestId(\"stHelpType\")).toHaveTextContent(\"method\")\n    })\n\n    describe(\"should render empty when\", () => {\n      const props = getProps({\n        name: undefined,\n        value: undefined,\n        type: undefined,\n      })\n\n      it(\"there's no name\", () => {\n        render(<DocString {...props} />)\n        expect(screen.queryByTestId(\"stHelpName\")).not.toBeInTheDocument()\n      })\n\n      it(\"there's no value\", () => {\n        render(<DocString {...props} />)\n        expect(screen.queryByTestId(\"stHelpValue\")).not.toBeInTheDocument()\n      })\n\n      it(\"there's no type\", () => {\n        render(<DocString {...props} />)\n        expect(screen.queryByTestId(\"stHelpType\")).not.toBeInTheDocument()\n      })\n    })\n\n    // Testing cases that we expect to happen (won't test every combination)\n    it(\"should render a type and value when there's no name\", () => {\n      const props = getProps({\n        name: undefined,\n      })\n      render(<DocString {...props} />)\n\n      expect(screen.queryByTestId(\"stHelpName\")).not.toBeInTheDocument()\n\n      expect(screen.getByTestId(\"stHelpType\")).toHaveTextContent(\"method\")\n      expect(screen.getByTestId(\"stHelpValue\")).toHaveTextContent(\n        \"streamlit.balloons()\"\n      )\n    })\n\n    // Testing cases that we expect to happen (won't test every combination)\n    it(\"should render a name and type when there's no value\", () => {\n      const props = getProps({\n        value: undefined,\n      })\n      render(<DocString {...props} />)\n\n      expect(screen.queryByTestId(\"stHelpValue\")).not.toBeInTheDocument()\n\n      expect(screen.getByTestId(\"stHelpName\")).toHaveTextContent(\"st.balloons\")\n      expect(screen.getByTestId(\"stHelpType\")).toHaveTextContent(\"method\")\n    })\n  })\n\n  describe(\"members table\", () => {\n    it(\"should render no members when there are none\", () => {\n      render(<DocString {...props} />)\n      expect(\n        screen.queryByTestId(\"stHelpMembersTable\")\n      ).not.toBeInTheDocument()\n    })\n\n    it(\"should render members\", () => {\n      const props = getProps({\n        members: [\n          {\n            name: \"member1\",\n            value: \"value1\",\n            type: \"type1\",\n          },\n          {\n            name: \"member2\",\n            value: \"value2\",\n            type: \"type2\",\n          },\n        ],\n      })\n      render(<DocString {...props} />)\n\n      expect(screen.getByTestId(\"stHelpMembersTable\")).toBeInTheDocument()\n      expect(screen.getAllByTestId(\"stHelpMember\")).toHaveLength(2)\n    })\n  })\n})\n\ndescribe(\"Member Element\", () => {\n  it(\"should render value-oriented members\", () => {\n    const props = {\n      member: {\n        name: \"member1\",\n        type: \"type1\",\n        value: \"value1\",\n      },\n    }\n\n    render(<Member {...props} />)\n\n    expect(screen.getByTestId(\"stHelpMemberDocValue\")).toHaveTextContent(\n      \"value1\"\n    )\n    expect(screen.getByTestId(\"stHelpMemberDocName\")).toHaveTextContent(\n      \"member1\"\n    )\n    expect(screen.getByTestId(\"stHelpMemberDocType\")).toHaveTextContent(\n      \"type1\"\n    )\n  })\n\n  it(\"should render doc-oriented members\", () => {\n    const props = {\n      member: {\n        name: \"member1\",\n        type: \"type1\",\n        docString: \"docstring1\",\n      },\n    }\n\n    render(<Member {...props} />)\n\n    expect(screen.getByTestId(\"stHelpMemberDocName\")).toHaveTextContent(\n      \"member1\"\n    )\n    expect(screen.getByTestId(\"stHelpMemberDocType\")).toHaveTextContent(\n      \"type1\"\n    )\n    expect(screen.getByTestId(\"stHelpMemberDocString\")).toHaveTextContent(\n      \"docstring1\"\n    )\n  })\n\n  it(\"should prefer value over doc\", () => {\n    const props = {\n      member: {\n        name: \"member1\",\n        type: \"type1\",\n        value: \"value1\",\n        docString: \"docstring1\",\n      },\n    }\n\n    render(<Member {...props} />)\n\n    expect(screen.getByTestId(\"stHelpMemberDocValue\")).toHaveTextContent(\n      \"value1\"\n    )\n    expect(screen.getByTestId(\"stHelpMemberDocName\")).toHaveTextContent(\n      \"member1\"\n    )\n    expect(screen.getByTestId(\"stHelpMemberDocType\")).toHaveTextContent(\n      \"type1\"\n    )\n    expect(\n      screen.queryByTestId(\"stHelpMemberDocString\")\n    ).not.toBeInTheDocument()\n    expect(screen.queryByText(\"docstring1\")).not.toBeInTheDocument()\n  })\n\n  it(\"should tell you when there are no docs\", () => {\n    const props = {\n      member: {\n        name: \"member1\",\n        type: \"type1\",\n      },\n    }\n\n    render(<Member {...props} />)\n\n    expect(screen.getByTestId(\"stHelpMemberDocString\")).toHaveTextContent(\n      \"No docs available\"\n    )\n  })\n\n  it(\"should only show type if present\", () => {\n    const props = {\n      member: {\n        name: \"member1\",\n      },\n    }\n\n    render(<Member {...props} />)\n\n    expect(screen.queryByTestId(\"stHelpMemberDocType\")).not.toBeInTheDocument()\n  })\n})\n"],"mappings":"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"}