{"version":3,"file":"IFrame.test.js","names":["React","screen","render","DEFAULT_IFRAME_FEATURE_POLICY","DEFAULT_IFRAME_SANDBOX_POLICY","IFrame","IFrameProto","jsx","_jsx","getProps","elementProps","arguments","length","undefined","element","create","width","describe","it","props","iframeElement","getByTestId","expect","toBeInTheDocument","toHaveClass","height","toHaveAttribute","src","srcdoc","not","hasWidth","scrolling","toHaveStyle"],"sources":["../../../../src/components/elements/IFrame/IFrame.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\n\nimport \"@testing-library/jest-dom\"\nimport { screen } from \"@testing-library/react\"\n\nimport { render } from \"@streamlit/lib/src/test_util\"\nimport {\n  DEFAULT_IFRAME_FEATURE_POLICY,\n  DEFAULT_IFRAME_SANDBOX_POLICY,\n} from \"@streamlit/lib/src/util/IFrameUtil\"\nimport { IFrame as IFrameProto } from \"@streamlit/lib/src/proto\"\n\nimport IFrame, { IFrameProps } from \"./IFrame\"\n\nconst getProps = (elementProps: Partial<IFrameProto> = {}): IFrameProps => ({\n  element: IFrameProto.create({\n    ...elementProps,\n  }),\n  width: 100,\n})\n\ndescribe(\"st.iframe\", () => {\n  it(\"should render an iframe\", () => {\n    const props = getProps({})\n    render(<IFrame {...props} />)\n    const iframeElement = screen.getByTestId(\"stIFrame\")\n    expect(iframeElement).toBeInTheDocument()\n    expect(iframeElement).toHaveClass(\"stIFrame\")\n  })\n\n  it(\"should set iframe height\", () => {\n    const props = getProps({\n      height: 400,\n    })\n    render(<IFrame {...props} />)\n    expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\"height\", \"400\")\n  })\n\n  describe(\"Render iframe with `src` parameter\", () => {\n    const props = getProps({\n      src: \"foo\",\n      srcdoc: \"bar\",\n    })\n\n    it(\"should set `srcDoc` to undefined if src is defined\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).not.toHaveAttribute(\"srcdoc\")\n    })\n\n    it(\"should set `src`\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\"src\", \"foo\")\n    })\n\n    it(\"should use our default feature policy\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\n        \"allow\",\n        DEFAULT_IFRAME_FEATURE_POLICY\n      )\n    })\n\n    it(\"should use our default sandbox policy\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\n        \"sandbox\",\n        DEFAULT_IFRAME_SANDBOX_POLICY\n      )\n    })\n  })\n\n  describe(\"Render iframe with `srcDoc` parameter\", () => {\n    const props = getProps({\n      srcdoc: \"bar\",\n    })\n\n    it(\"should set `srcDoc`\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\"srcdoc\", \"bar\")\n    })\n\n    it(\"should use our default feature policy\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\n        \"allow\",\n        DEFAULT_IFRAME_FEATURE_POLICY\n      )\n    })\n\n    it(\"should use our default sandbox policy\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\n        \"sandbox\",\n        DEFAULT_IFRAME_SANDBOX_POLICY\n      )\n    })\n  })\n\n  describe(\"Render iframe with specified width\", () => {\n    const props = getProps({\n      hasWidth: true,\n      width: 200,\n    })\n    it(\"should set element width\", () => {\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\"width\", \"200\")\n    })\n\n    it(\"should set app width\", () => {\n      const props = getProps({})\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\"width\", \"100\")\n    })\n  })\n\n  describe(\"Render iframe with scrolling\", () => {\n    it(\"should set scrolling to auto\", () => {\n      const props = getProps({\n        scrolling: true,\n      })\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\n        \"scrolling\",\n        \"auto\"\n      )\n      expect(screen.getByTestId(\"stIFrame\")).not.toHaveStyle(\n        \"overflow: hidden\"\n      )\n    })\n\n    it(\"should set `overflow` to hidden\", () => {\n      const props = getProps({})\n      render(<IFrame {...props} />)\n      expect(screen.getByTestId(\"stIFrame\")).toHaveStyle(\"overflow: hidden\")\n      expect(screen.getByTestId(\"stIFrame\")).toHaveAttribute(\"scrolling\", \"no\")\n    })\n  })\n})\n"],"mappings":"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"}