{"version":3,"file":"GraphVizChart.js","names":["React","useEffect","select","graphviz","logError","withFullScreenWrapper","StyledGraphVizChart","jsx","_jsx","GraphVizChart","_ref","element","isFullScreen","chartId","elementId","zoom","fit","scale","engine","renderDot","spec","useContainerWidth","node","removeAttribute","error","className","id"],"sources":["../../../../src/components/elements/GraphVizChart/GraphVizChart.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement, useEffect } from \"react\"\n\nimport { select } from \"d3\"\nimport { Engine, graphviz } from \"d3-graphviz\"\n\nimport { logError } from \"@streamlit/lib/src/util/log\"\nimport { withFullScreenWrapper } from \"@streamlit/lib/src/components/shared/FullScreenWrapper\"\nimport { GraphVizChart as GraphVizChartProto } from \"@streamlit/lib/src/proto\"\n\nimport { StyledGraphVizChart } from \"./styled-components\"\n\nexport interface GraphVizChartProps {\n  element: GraphVizChartProto\n  isFullScreen: boolean\n}\n\nexport function GraphVizChart({\n  element,\n  isFullScreen,\n}: Readonly<GraphVizChartProps>): ReactElement {\n  const chartId = `st-graphviz-chart-${element.elementId}`\n\n  useEffect(() => {\n    try {\n      graphviz(`#${chartId}`)\n        .zoom(false)\n        .fit(true)\n        .scale(1)\n        .engine(element.engine as Engine)\n        .renderDot(element.spec)\n\n      if (isFullScreen || element.useContainerWidth) {\n        const node = select(`#${chartId} > svg`).node() as SVGGraphicsElement\n        // We explicitly remove width and height to let CSS and the SVG viewBox\n        // define its dimensions\n        node.removeAttribute(\"width\")\n        node.removeAttribute(\"height\")\n      }\n    } catch (error) {\n      logError(error)\n    }\n  }, [\n    chartId,\n    element.engine,\n    element.spec,\n    element.useContainerWidth,\n    isFullScreen,\n  ])\n\n  return (\n    <StyledGraphVizChart\n      className=\"stGraphVizChart\"\n      data-testid=\"stGraphVizChart\"\n      id={chartId}\n      isFullScreen={isFullScreen}\n    />\n  )\n}\n\nexport default withFullScreenWrapper(GraphVizChart)\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,IAAkBC,SAAS,QAAQ,OAAO;AAEtD,SAASC,MAAM,QAAQ,IAAI;AAC3B,SAAiBC,QAAQ,QAAQ,aAAa;AAE9C,SAASC,QAAQ;AACjB,SAASC,qBAAqB;AAG9B,SAASC,mBAAmB;AAA6B,SAAAC,GAAA,IAAAC,IAAA;AAOzD,OAAO,SAASC,aAAaA,CAAAC,IAAA,EAGkB;EAAA,IAHjB;IAC5BC,OAAO;IACPC;EAC4B,CAAC,GAAAF,IAAA;EAC7B,MAAMG,OAAO,GAAI,qBAAoBF,OAAO,CAACG,SAAU,EAAC;EAExDb,SAAS,CAAC,MAAM;IACd,IAAI;MACFE,QAAQ,CAAE,IAAGU,OAAQ,EAAC,CAAC,CACpBE,IAAI,CAAC,KAAK,CAAC,CACXC,GAAG,CAAC,IAAI,CAAC,CACTC,KAAK,CAAC,CAAC,CAAC,CACRC,MAAM,CAACP,OAAO,CAACO,MAAgB,CAAC,CAChCC,SAAS,CAACR,OAAO,CAACS,IAAI,CAAC;MAE1B,IAAIR,YAAY,IAAID,OAAO,CAACU,iBAAiB,EAAE;QAC7C,MAAMC,IAAI,GAAGpB,MAAM,CAAE,IAAGW,OAAQ,QAAO,CAAC,CAACS,IAAI,CAAC,CAAuB;QACrE;QACA;QACAA,IAAI,CAACC,eAAe,CAAC,OAAO,CAAC;QAC7BD,IAAI,CAACC,eAAe,CAAC,QAAQ,CAAC;MAChC;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdpB,QAAQ,CAACoB,KAAK,CAAC;IACjB;EACF,CAAC,EAAE,CACDX,OAAO,EACPF,OAAO,CAACO,MAAM,EACdP,OAAO,CAACS,IAAI,EACZT,OAAO,CAACU,iBAAiB,EACzBT,YAAY,CACb,CAAC;EAEF,oBACEJ,IAAA,CAACF,mBAAmB;IAClBmB,SAAS,EAAC,iBAAiB;IAC3B,eAAY,iBAAiB;IAC7BC,EAAE,EAAEb,OAAQ;IACZD,YAAY,EAAEA;EAAa,CAC5B,CAAC;AAEN;AAEA,eAAeP,qBAAqB,CAACI,aAAa,CAAC"}