{"version":3,"file":"Slider.js","names":["React","pick","Slider","UISlider","withTheme","sprintf","FormClearHelper","SliderProto","debounce","labelVisibilityProtoValueToEnum","moment","WidgetLabel","StyledWidgetLabelHelp","TooltipIcon","Placement","StyledThumb","StyledThumbValue","StyledTickBar","StyledTickBarItem","jsx","_jsx","jsxs","_jsxs","DEBOUNCE_TIME_MS","PureComponent","constructor","props","formClearHelper","state","sliderRef","createRef","thumbRef","thumbValueRef","commitWidgetValueDebounced","commitWidgetValue","source","widgetMgr","element","fragmentId","setDoubleArrayValue","value","onFormCleared","setState","_","prevProps","default","fromUi","handleChange","_ref","renderThumb","forwardRef","ref","_this$thumbValueRef","$value","$thumbIndex","thumbIndex","formattedValue","formatValue","passThrough","ariaValueText","options","length","isDateTimeType","disabled","$disabled","label","children","className","renderTickBar","max","min","bind","initialValue","storedValue","getDoubleArrayValue","undefined","componentDidMount","setTimeout","thumbValueAlignment","setValue","updateFromProtobuf","componentDidUpdate","maybeUpdateFromProtobuf","componentWillUnmount","disconnect","start","end","dataType","DataType","DATETIME","DATE","TIME","format","utc","alignValueOnThumb","slider","thumb","thumbValue","sliderPosition","getBoundingClientRect","thumbPosition","thumbValuePosition","thumbMidpoint","left","width","thumbValueOverflowsLeft","thumbValueOverflowsRight","right","style","_this$thumbRef$","_this$thumbRef$2","_this$thumbValueRef$","_this$thumbValueRef$2","sliderDiv","current","thumb1Div","thumb2Div","thumb1ValueDiv","thumb2ValueDiv","labelGap","thumb1","thumb2","thumb1Value","thumb2Value","moveLeft","concat","render","_element$labelVisibil","theme","colors","fonts","fontSizes","spacing","manageFormClearListener","formId","labelVisibility","help","content","placement","TOP_RIGHT","step","onChange","overrides","Root","paddingTop","twoThirdsSmFont","Thumb","Tick","fontFamily","monospace","fontSize","sm","Track","backgroundColor","paddingBottom","paddingLeft","paddingRight","InnerTrack","_ref2","height","background","darkenedBgMix25","TickBar"],"sources":["../../../../src/components/widgets/Slider/Slider.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\nimport pick from \"lodash/pick\"\nimport { StyleProps, Slider as UISlider } from \"baseui/slider\"\nimport { withTheme } from \"@emotion/react\"\nimport { sprintf } from \"sprintf-js\"\nimport { FormClearHelper } from \"@streamlit/lib/src/components/widgets/Form\"\nimport {\n  WidgetStateManager,\n  Source,\n} from \"@streamlit/lib/src/WidgetStateManager\"\nimport { Slider as SliderProto } from \"@streamlit/lib/src/proto\"\nimport {\n  debounce,\n  labelVisibilityProtoValueToEnum,\n} from \"@streamlit/lib/src/util/utils\"\nimport moment from \"moment\"\nimport {\n  WidgetLabel,\n  StyledWidgetLabelHelp,\n} from \"@streamlit/lib/src/components/widgets/BaseWidget\"\nimport TooltipIcon from \"@streamlit/lib/src/components/shared/TooltipIcon\"\nimport { Placement } from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\nimport {\n  StyledThumb,\n  StyledThumbValue,\n  StyledTickBar,\n  StyledTickBarItem,\n} from \"./styled-components\"\n\nconst DEBOUNCE_TIME_MS = 200\n\nexport interface Props {\n  disabled: boolean\n  element: SliderProto\n  theme: EmotionTheme\n  widgetMgr: WidgetStateManager\n  width: number\n  fragmentId?: string\n}\n\ninterface State {\n  /**\n   * The value specified by the user via the UI. If the user didn't touch this\n   * widget's UI, the default value is used.\n   */\n  value: number[]\n}\n\nclass Slider extends React.PureComponent<Props, State> {\n  private readonly formClearHelper = new FormClearHelper()\n\n  public state: State\n\n  private sliderRef = React.createRef<HTMLDivElement>()\n\n  private thumbRef: React.MutableRefObject<HTMLDivElement>[] = []\n\n  private thumbValueRef: React.RefObject<HTMLDivElement>[] = []\n\n  private readonly commitWidgetValueDebounced: (source: Source) => void\n\n  public constructor(props: Props) {\n    super(props)\n    this.commitWidgetValueDebounced = debounce(\n      DEBOUNCE_TIME_MS,\n      this.commitWidgetValue.bind(this)\n    )\n    this.state = { value: this.initialValue }\n  }\n\n  get initialValue(): number[] {\n    const storedValue = this.props.widgetMgr.getDoubleArrayValue(\n      this.props.element\n    )\n    return storedValue !== undefined ? storedValue : this.props.element.default\n  }\n\n  public componentDidMount(): void {\n    // Check thumb value's alignment vs. slider container\n    // Delay the alignment to allow the page layout to complete\n    setTimeout(() => {\n      this.thumbValueAlignment()\n    }, 0)\n\n    if (this.props.element.setValue) {\n      this.updateFromProtobuf()\n    } else {\n      this.commitWidgetValue({ fromUi: false })\n    }\n  }\n\n  public componentDidUpdate(): void {\n    this.maybeUpdateFromProtobuf()\n  }\n\n  public componentWillUnmount(): void {\n    this.formClearHelper.disconnect()\n  }\n\n  private maybeUpdateFromProtobuf(): void {\n    const { setValue } = this.props.element\n    if (setValue) {\n      this.updateFromProtobuf()\n    }\n  }\n\n  private updateFromProtobuf(): void {\n    const { value } = this.props.element\n    this.props.element.setValue = false\n    this.setState({ value }, () => {\n      this.commitWidgetValue({ fromUi: false })\n    })\n  }\n\n  /** Commit state.value to the WidgetStateManager. */\n  private commitWidgetValue = (source: Source): void => {\n    const { widgetMgr, element, fragmentId } = this.props\n    widgetMgr.setDoubleArrayValue(\n      element,\n      this.state.value,\n      source,\n      fragmentId\n    )\n  }\n\n  /**\n   * If we're part of a clear_on_submit form, this will be called when our\n   * form is submitted. Restore our default value and update the WidgetManager.\n   */\n  private onFormCleared = (): void => {\n    this.setState(\n      (_, prevProps) => {\n        return { value: prevProps.element.default }\n      },\n      () => this.commitWidgetValue({ fromUi: true })\n    )\n  }\n\n  private handleChange = ({ value }: { value: number[] }): void => {\n    this.setState({ value }, () =>\n      this.commitWidgetValueDebounced({ fromUi: true })\n    )\n  }\n\n  /**\n   * Return the value of the slider. This will either be an array with\n   * one value (for a single value slider), or an array with two\n   * values (for a range slider).\n   */\n  private get value(): number[] {\n    const { min, max } = this.props.element\n    const { value } = this.state\n    let start = value[0]\n    let end = value.length > 1 ? value[1] : value[0]\n    // Adjust the value if it's out of bounds.\n    if (start > end) {\n      start = end\n    }\n    if (start < min) {\n      start = min\n    }\n    if (start > max) {\n      start = max\n    }\n    if (end < min) {\n      end = min\n    }\n    if (end > max) {\n      end = max\n    }\n    return value.length > 1 ? [start, end] : [start]\n  }\n\n  private isDateTimeType(): boolean {\n    const { dataType } = this.props.element\n    return (\n      dataType === SliderProto.DataType.DATETIME ||\n      dataType === SliderProto.DataType.DATE ||\n      dataType === SliderProto.DataType.TIME\n    )\n  }\n\n  private formatValue(value: number): string {\n    const { format, options } = this.props.element\n    if (this.isDateTimeType()) {\n      // Python datetime uses microseconds, but JS & Moment uses milliseconds\n      // The timestamp is always set to the UTC timezone, even so, the actual timezone\n      // for this timestamp in the backend could be different.\n      // However, the frontend component does not need to know about the actual timezone.\n      return moment.utc(value / 1000).format(format)\n    }\n\n    if (options.length > 0) {\n      return sprintf(format, options[value])\n    }\n\n    return sprintf(format, value)\n  }\n\n  private alignValueOnThumb(\n    slider: HTMLDivElement | null,\n    thumb: HTMLDivElement | null,\n    thumbValue: HTMLDivElement | null\n  ): void {\n    if (slider && thumb && thumbValue) {\n      const sliderPosition = slider.getBoundingClientRect()\n      const thumbPosition = thumb.getBoundingClientRect()\n      const thumbValuePosition = thumbValue.getBoundingClientRect()\n\n      const thumbMidpoint = thumbPosition.left + thumbPosition.width / 2\n      const thumbValueOverflowsLeft =\n        thumbMidpoint - thumbValuePosition.width / 2 < sliderPosition.left\n      const thumbValueOverflowsRight =\n        thumbMidpoint + thumbValuePosition.width / 2 > sliderPosition.right\n\n      thumbValue.style.left = thumbValueOverflowsLeft ? \"0\" : \"\"\n      thumbValue.style.right = thumbValueOverflowsRight ? \"0\" : \"\"\n    }\n  }\n\n  private thumbValueAlignment(): void {\n    const sliderDiv = this.sliderRef.current\n    const thumb1Div = this.thumbRef[0]?.current\n    const thumb2Div = this.thumbRef[1]?.current\n    const thumb1ValueDiv = this.thumbValueRef[0]?.current\n    const thumb2ValueDiv = this.thumbValueRef[1]?.current\n    // Minimum gap between thumb values (in px)\n    const labelGap = 16\n\n    // Handles label alignment over each thumb\n    this.alignValueOnThumb(sliderDiv, thumb1Div, thumb1ValueDiv)\n    this.alignValueOnThumb(sliderDiv, thumb2Div, thumb2ValueDiv)\n\n    // Checks & handles label spacing when two thumb values & they overlap\n    if (\n      sliderDiv &&\n      thumb1Div &&\n      thumb2Div &&\n      thumb1ValueDiv &&\n      thumb2ValueDiv\n    ) {\n      const slider = sliderDiv.getBoundingClientRect()\n      const thumb1 = thumb1Div.getBoundingClientRect()\n      const thumb2 = thumb2Div.getBoundingClientRect()\n      const thumb1Value = thumb1ValueDiv.getBoundingClientRect()\n      const thumb2Value = thumb2ValueDiv.getBoundingClientRect()\n\n      // Check if thumb values are overlapping or too close together\n      if (thumb1Value.right + labelGap > thumb2Value.left) {\n        // Check whether to shift 1st thumb value left or 2nd thumb value right\n        const moveLeft =\n          thumb2Value.left - labelGap - thumb1Value.width > slider.left\n\n        if (moveLeft) {\n          thumb1ValueDiv.style.right = `${\n            thumb2Value.width + labelGap - (thumb2.right - thumb1.right)\n          }px`\n        } else {\n          thumb2ValueDiv.style.left = `${\n            thumb1Value.width + labelGap - (thumb2.left - thumb1.left)\n          }px`\n        }\n      }\n    }\n  }\n\n  // eslint-disable-next-line react/display-name\n  private renderThumb = React.forwardRef<HTMLDivElement, StyleProps>(\n    (props: StyleProps, ref): JSX.Element => {\n      const { $value, $thumbIndex } = props\n      const thumbIndex = $thumbIndex || 0\n      this.thumbRef[thumbIndex] = ref as React.MutableRefObject<HTMLDivElement>\n      this.thumbValueRef[thumbIndex] ||= React.createRef<HTMLDivElement>()\n\n      const formattedValue = $value\n        ? this.formatValue($value[$thumbIndex as number])\n        : \"\"\n      const passThrough = pick(props, [\n        \"role\",\n        \"style\",\n        \"aria-valuemax\",\n        \"aria-valuemin\",\n        \"aria-valuenow\",\n        \"tabIndex\",\n        \"onKeyUp\",\n        \"onKeyDown\",\n        \"onMouseEnter\",\n        \"onMouseLeave\",\n        \"draggable\",\n      ])\n      const ariaValueText: Record<string, string> = {}\n\n      if (this.props.element.options.length > 0 || this.isDateTimeType()) {\n        ariaValueText[\"aria-valuetext\"] = formattedValue\n      }\n\n      return (\n        <StyledThumb\n          {...passThrough}\n          disabled={props.$disabled === true}\n          ref={this.thumbRef[thumbIndex]}\n          aria-valuetext={formattedValue}\n          aria-label={this.props.element.label}\n        >\n          <StyledThumbValue\n            className=\"StyledThumbValue\"\n            data-testid=\"stThumbValue\"\n            disabled={props.$disabled === true}\n            ref={this.thumbValueRef[thumbIndex]}\n          >\n            {formattedValue}\n          </StyledThumbValue>\n        </StyledThumb>\n      )\n    }\n  )\n\n  private renderTickBar = (): JSX.Element => {\n    const { disabled, element } = this.props\n    const { max, min } = element\n\n    return (\n      <StyledTickBar data-testid=\"stTickBar\">\n        <StyledTickBarItem disabled={disabled} data-testid=\"stTickBarMin\">\n          {this.formatValue(min)}\n        </StyledTickBarItem>\n        <StyledTickBarItem disabled={disabled} data-testid=\"stTickBarMax\">\n          {this.formatValue(max)}\n        </StyledTickBarItem>\n      </StyledTickBar>\n    )\n  }\n\n  public render(): React.ReactNode {\n    const { disabled, element, theme, width, widgetMgr } = this.props\n    const { colors, fonts, fontSizes, spacing } = theme\n    const style = { width }\n\n    // Manage our form-clear event handler.\n    this.formClearHelper.manageFormClearListener(\n      widgetMgr,\n      element.formId,\n      this.onFormCleared\n    )\n\n    // Check the thumb value's alignment vs. slider container\n    this.thumbValueAlignment()\n\n    return (\n      <div\n        ref={this.sliderRef}\n        className=\"stSlider\"\n        data-testid=\"stSlider\"\n        style={style}\n      >\n        <WidgetLabel\n          label={element.label}\n          disabled={disabled}\n          labelVisibility={labelVisibilityProtoValueToEnum(\n            element.labelVisibility?.value\n          )}\n        >\n          {element.help && (\n            <StyledWidgetLabelHelp>\n              <TooltipIcon\n                content={element.help}\n                placement={Placement.TOP_RIGHT}\n              />\n            </StyledWidgetLabelHelp>\n          )}\n        </WidgetLabel>\n        <UISlider\n          min={element.min}\n          max={element.max}\n          step={element.step}\n          value={this.value}\n          onChange={this.handleChange}\n          disabled={disabled}\n          overrides={{\n            Root: {\n              style: {\n                paddingTop: spacing.twoThirdsSmFont,\n              },\n            },\n            Thumb: this.renderThumb,\n            Tick: {\n              style: {\n                fontFamily: fonts.monospace,\n                fontSize: fontSizes.sm,\n              },\n            },\n            Track: {\n              style: {\n                backgroundColor: \"none !important\",\n                paddingBottom: 0,\n                paddingLeft: 0,\n                paddingRight: 0,\n                paddingTop: spacing.twoThirdsSmFont,\n              },\n            },\n            InnerTrack: {\n              style: ({ $disabled }: StyleProps) => ({\n                height: \"4px\",\n                ...($disabled ? { background: colors.darkenedBgMix25 } : {}),\n              }),\n            },\n            TickBar: this.renderTickBar,\n          }}\n        />\n      </div>\n    )\n  }\n}\n\nexport default withTheme(Slider)\n"],"mappings":"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"}