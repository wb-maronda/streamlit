{"version":3,"file":"Form.test.js","names":["React","screen","ScriptRunState","render","WidgetStateManager","Form","jsx","_jsx","describe","getProps","props","arguments","length","undefined","formId","width","hasSubmitButton","scriptRunState","RUNNING","clearOnSubmit","enterToSubmit","widgetMgr","sendRerunBackMsg","jest","fn","formsDataChanged","border","it","formElement","getByTestId","expect","toBeInTheDocument","toHaveClass","rerender","queryByTestId","not","NOT_RUNNING","getByText","queryByText"],"sources":["../../../../src/components/widgets/Form/Form.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\n\nimport \"@testing-library/jest-dom\"\nimport { screen } from \"@testing-library/react\"\n\nimport { ScriptRunState } from \"@streamlit/lib/src/ScriptRunState\"\nimport { render } from \"@streamlit/lib/src/test_util\"\nimport { WidgetStateManager } from \"@streamlit/lib/src/WidgetStateManager\"\n\nimport { Form, Props } from \"./Form\"\n\ndescribe(\"Form\", () => {\n  function getProps(props: Partial<Props> = {}): Props {\n    return {\n      formId: \"mockFormId\",\n      width: 100,\n      hasSubmitButton: false,\n      scriptRunState: ScriptRunState.RUNNING,\n      clearOnSubmit: false,\n      enterToSubmit: true,\n      widgetMgr: new WidgetStateManager({\n        sendRerunBackMsg: jest.fn(),\n        formsDataChanged: jest.fn(),\n      }),\n      border: false,\n      ...props,\n    }\n  }\n  it(\"renders without crashing\", () => {\n    render(<Form {...getProps()} />)\n    const formElement = screen.getByTestId(\"stForm\")\n    expect(formElement).toBeInTheDocument()\n    expect(formElement).toHaveClass(\"stForm\")\n  })\n\n  it(\"shows error if !hasSubmitButton && scriptRunState==NOT_RUNNING\", () => {\n    const props = getProps({\n      hasSubmitButton: false,\n      scriptRunState: ScriptRunState.RUNNING,\n    })\n    const { rerender } = render(<Form {...props} />)\n\n    // We have no Submit Button, but the app is still running\n    expect(screen.queryByTestId(\"stFormSubmitButton\")).not.toBeInTheDocument()\n\n    // When the app stops running, we show an error if the submit button\n    // is still missing.\n    rerender(\n      <Form {...getProps({ scriptRunState: ScriptRunState.NOT_RUNNING })} />\n    )\n    expect(screen.getByText(\"Missing Submit Button\")).toBeInTheDocument()\n\n    // If the app restarts, we continue to show the error...\n    rerender(\n      <Form {...getProps({ scriptRunState: ScriptRunState.RUNNING })} />\n    )\n    expect(screen.getByText(\"Missing Submit Button\")).toBeInTheDocument()\n\n    // Until we get a submit button, and the error is removed immediately,\n    // regardless of ScriptRunState.\n    rerender(<Form {...getProps({ hasSubmitButton: true })} />)\n    expect(screen.getByTestId(\"stForm\")).toBeInTheDocument()\n    expect(screen.queryByText(\"Missing Submit Button\")).not.toBeInTheDocument()\n  })\n})\n"],"mappings":"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"}