{"version":3,"file":"NumberInput.js","names":["React","Minus","Plus","withTheme","sprintf","Input","UIInput","uniqueId","isInForm","isNullOrUndefined","labelVisibilityProtoValueToEnum","notNullOrUndefined","FormClearHelper","logWarning","NumberInput","NumberInputProto","TooltipIcon","Placement","Icon","InputInstructions","StyledWidgetLabelHelp","WidgetLabel","StyledInputContainer","StyledInputControl","StyledInputControls","StyledInstructionsContainer","jsx","_jsx","jsxs","_jsxs","getNonEmptyString","value","undefined","getInitialValue","props","isIntData","element","dataType","DataType","INT","storedValue","widgetMgr","getIntValue","getDoubleValue","default","getStep","_ref","step","formatValue","_ref2","format","formatString","strStep","toString","FLOAT","includes","decimalPlaces","split","length","e","String","canDecrement","min","canIncrement","max","_ref3","disabled","width","theme","fragmentId","elementDataType","id","elementId","formId","elementFormId","elementDefault","elementFormat","hasMin","Infinity","hasMax","setStep","useState","initialValue","dirty","setDirty","setValue","formattedValue","setFormattedValue","isFocused","setIsFocused","inputRef","useRef","formClearHelper","canDec","canInc","inForm","allowFormEnterToSubmit","useEffect","commitValue","useCallback","_ref4","source","current","reportValidity","newValue","setIntValue","setDoubleValue","Error","onBlur","fromUi","onFocus","updateFromProtobuf","formClearHelperCopy","disconnect","clearable","manageFormClearListener","onChange","target","numValue","parseInt","parseFloat","increment","decrement","onKeyDown","key","preventDefault","onKeyPress","submitForm","className","style","children","label","labelVisibility","htmlFor","help","content","placement","TOP_RIGHT","type","placeholder","clearOnEscape","overrides","ClearIcon","Svg","color","colors","darkGray","transform","spacing","twoXL","marginRight","fill","bodyText","lineHeight","lineHeights","inputWidget","paddingRight","sm","paddingLeft","paddingBottom","paddingTop","InputContainer","borderTopRightRadius","borderBottomRightRadius","Root","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","breakpoints","hideNumberInputControls","onClick","tabIndex","size","hideWidgetDetails","allowEnterToSubmit"],"sources":["../../../../src/components/widgets/NumberInput/NumberInput.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport { Minus, Plus } from \"@emotion-icons/open-iconic\"\nimport { withTheme } from \"@emotion/react\"\nimport { sprintf } from \"sprintf-js\"\nimport { Input as UIInput } from \"baseui/input\"\nimport uniqueId from \"lodash/uniqueId\"\n\nimport {\n  isInForm,\n  isNullOrUndefined,\n  labelVisibilityProtoValueToEnum,\n  notNullOrUndefined,\n} from \"@streamlit/lib/src/util/utils\"\nimport { FormClearHelper } from \"@streamlit/lib/src/components/widgets/Form\"\nimport { logWarning } from \"@streamlit/lib/src/util/log\"\nimport { NumberInput as NumberInputProto } from \"@streamlit/lib/src/proto\"\nimport {\n  Source,\n  WidgetStateManager,\n} from \"@streamlit/lib/src/WidgetStateManager\"\nimport TooltipIcon from \"@streamlit/lib/src/components/shared/TooltipIcon\"\nimport { Placement } from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport InputInstructions from \"@streamlit/lib/src/components/shared/InputInstructions/InputInstructions\"\nimport {\n  StyledWidgetLabelHelp,\n  WidgetLabel,\n} from \"@streamlit/lib/src/components/widgets/BaseWidget\"\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\n\nimport {\n  StyledInputContainer,\n  StyledInputControl,\n  StyledInputControls,\n  StyledInstructionsContainer,\n} from \"./styled-components\"\n\n/**\n * Return a string property from an element. If the string is\n * null or empty, return undefined instead.\n */\nfunction getNonEmptyString(\n  value: string | null | undefined\n): string | undefined {\n  return isNullOrUndefined(value) || value === \"\" ? undefined : value\n}\n\n/**\n * This function returns the initial value for the NumberInput widget\n * via the widget manager.\n */\nconst getInitialValue = (\n  props: Pick<Props, \"element\" | \"widgetMgr\">\n): number | null => {\n  const isIntData = props.element.dataType === NumberInputProto.DataType.INT\n  const storedValue = isIntData\n    ? props.widgetMgr.getIntValue(props.element)\n    : props.widgetMgr.getDoubleValue(props.element)\n  return storedValue ?? props.element.default ?? null\n}\n\nconst getStep = ({\n  step,\n  dataType,\n}: Pick<NumberInputProto, \"step\" | \"dataType\">): number => {\n  if (step) {\n    return step\n  }\n  if (dataType === NumberInputProto.DataType.INT) {\n    return 1\n  }\n  return 0.01\n}\n\n/**\n * Utilizes the sprintf library to format a number value\n * according to a given format string.\n */\nexport const formatValue = ({\n  value,\n  format,\n  step,\n  dataType,\n}: {\n  value: number | null\n  format?: string | null\n  step?: number\n  dataType: NumberInputProto.DataType\n}): string | null => {\n  if (isNullOrUndefined(value)) {\n    return null\n  }\n\n  let formatString = getNonEmptyString(format)\n\n  if (isNullOrUndefined(formatString) && notNullOrUndefined(step)) {\n    const strStep = step.toString()\n    if (\n      dataType === NumberInputProto.DataType.FLOAT &&\n      step !== 0 &&\n      strStep.includes(\".\")\n    ) {\n      const decimalPlaces = strStep.split(\".\")[1].length\n      formatString = `%0.${decimalPlaces}f`\n    }\n  }\n\n  if (isNullOrUndefined(formatString)) {\n    return value.toString()\n  }\n\n  try {\n    return sprintf(formatString, value)\n  } catch (e) {\n    logWarning(`Error in sprintf(${formatString}, ${value}): ${e}`)\n    return String(value)\n  }\n}\n\nexport const canDecrement = (\n  value: number | null,\n  step: number,\n  min: number\n): boolean => {\n  if (isNullOrUndefined(value)) {\n    return false\n  }\n  return value - step >= min\n}\n\nexport const canIncrement = (\n  value: number | null,\n  step: number,\n  max: number\n): boolean => {\n  if (isNullOrUndefined(value)) {\n    return false\n  }\n  return value + step <= max\n}\n\nexport interface Props {\n  disabled: boolean\n  element: NumberInputProto\n  widgetMgr: WidgetStateManager\n  width: number\n  theme: EmotionTheme\n  fragmentId?: string\n}\n\nexport const NumberInput: React.FC<Props> = ({\n  disabled,\n  element,\n  widgetMgr,\n  width,\n  theme,\n  fragmentId,\n}: Props): ReactElement => {\n  const {\n    dataType: elementDataType,\n    id: elementId,\n    formId: elementFormId,\n    default: elementDefault,\n    format: elementFormat,\n  } = element\n  const min = element.hasMin ? element.min : -Infinity\n  const max = element.hasMax ? element.max : +Infinity\n\n  const [step, setStep] = React.useState<number>(getStep(element))\n  const initialValue = getInitialValue({ element, widgetMgr })\n  const [dirty, setDirty] = React.useState(false)\n  const [value, setValue] = React.useState<number | null>(initialValue)\n  const [formattedValue, setFormattedValue] = React.useState<string | null>(\n    formatValue({ value: initialValue, ...element, step })\n  )\n  const [isFocused, setIsFocused] = React.useState(false)\n  const inputRef = React.useRef<HTMLInputElement | HTMLTextAreaElement>(null)\n  const formClearHelper = React.useRef(new FormClearHelper())\n  const id = React.useRef(uniqueId(\"number_input_\"))\n\n  const canDec = canDecrement(value, step, min)\n  const canInc = canIncrement(value, step, max)\n\n  const inForm = isInForm({ formId: elementFormId })\n  // Allows form submission on Enter & displays Enter instructions\n  const allowFormEnterToSubmit =\n    widgetMgr.allowFormEnterToSubmit(elementFormId)\n\n  // update the step if the props change\n  React.useEffect(() => {\n    setStep(getStep({ step: element.step, dataType: element.dataType }))\n  }, [element.dataType, element.step])\n\n  const commitValue = React.useCallback(\n    ({ value, source }: { value: number | null; source: Source }) => {\n      if (notNullOrUndefined(value) && (min > value || value > max)) {\n        inputRef.current?.reportValidity()\n      } else {\n        const newValue = value ?? elementDefault ?? null\n\n        switch (elementDataType) {\n          case NumberInputProto.DataType.INT:\n            widgetMgr.setIntValue(\n              { id: elementId, formId: elementFormId },\n              newValue,\n              source,\n              fragmentId\n            )\n            break\n          case NumberInputProto.DataType.FLOAT:\n            widgetMgr.setDoubleValue(\n              { id: elementId, formId: elementFormId },\n              newValue,\n              source,\n              fragmentId\n            )\n            break\n          default:\n            throw new Error(\"Invalid data type\")\n        }\n\n        setDirty(false)\n        setValue(newValue)\n        setFormattedValue(\n          formatValue({\n            value: newValue,\n            dataType: elementDataType,\n            format: elementFormat,\n            step,\n          })\n        )\n      }\n    },\n    [\n      min,\n      max,\n      inputRef,\n      widgetMgr,\n      fragmentId,\n      step,\n      elementDataType,\n      elementId,\n      elementFormId,\n      elementDefault,\n      elementFormat,\n    ]\n  )\n\n  const onBlur = (): void => {\n    if (dirty) {\n      commitValue({ value, source: { fromUi: true } })\n    }\n    setIsFocused(false)\n  }\n\n  const onFocus = (): void => {\n    setIsFocused(true)\n  }\n\n  const updateFromProtobuf = (): void => {\n    const { value } = element\n    element.setValue = false\n    setValue(value ?? null)\n    setFormattedValue(formatValue({ value: value ?? null, ...element, step }))\n    commitValue({ value: value ?? null, source: { fromUi: false } })\n  }\n\n  // on component mount, we want to update the value from protobuf if setValue is true, otherwise commit current value\n  React.useEffect(() => {\n    const formClearHelperCopy = formClearHelper.current\n    if (element.setValue) {\n      updateFromProtobuf()\n    } else {\n      commitValue({ value, source: { fromUi: false } })\n    }\n\n    return () => {\n      formClearHelperCopy.disconnect()\n    }\n\n    // I don't want to run this effect on every render, only on mount.\n    // Additionally, it's okay if commitValue changes, because we only call\n    // it once in the beginning anyways.\n    /* eslint-disable react-hooks/exhaustive-deps */\n  }, [])\n\n  // update from protobuf whenever component updates if element.setValue is truthy\n  if (element.setValue) {\n    updateFromProtobuf()\n  }\n\n  const clearable = isNullOrUndefined(element.default) && !disabled\n\n  formClearHelper.current.manageFormClearListener(\n    widgetMgr,\n    element.formId,\n    () => {\n      setValue(element.default ?? null)\n      commitValue({ value, source: { fromUi: true } })\n    }\n  )\n\n  const onChange = (\n    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>\n  ): void => {\n    const { value } = e.target\n\n    if (value === \"\") {\n      setDirty(true)\n      setValue(null)\n      setFormattedValue(null)\n    } else {\n      let numValue: number\n\n      if (element.dataType === NumberInputProto.DataType.INT) {\n        numValue = parseInt(value, 10)\n      } else {\n        numValue = parseFloat(value)\n      }\n\n      setDirty(true)\n      setValue(numValue)\n      setFormattedValue(value)\n    }\n  }\n\n  const increment = React.useCallback(() => {\n    if (canInc) {\n      setDirty(true)\n      commitValue({ value: (value ?? min) + step, source: { fromUi: true } })\n    }\n  }, [value, min, step, canInc])\n\n  const decrement = React.useCallback(() => {\n    if (canDec) {\n      setDirty(true)\n      commitValue({ value: (value ?? max) - step, source: { fromUi: true } })\n    }\n  }, [value, max, step, canDec])\n\n  const onKeyDown = React.useCallback(\n    (e: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>): void => {\n      const { key } = e\n\n      switch (key) {\n        case \"ArrowUp\":\n          e.preventDefault()\n          increment()\n          break\n        case \"ArrowDown\":\n          e.preventDefault()\n          decrement()\n          break\n        default:\n      }\n    },\n    [increment, decrement]\n  )\n\n  const onKeyPress = React.useCallback(\n    (e: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>): void => {\n      if (e.key === \"Enter\") {\n        if (dirty) {\n          commitValue({ value, source: { fromUi: true } })\n        }\n        if (allowFormEnterToSubmit) {\n          widgetMgr.submitForm(elementFormId, fragmentId)\n        }\n      }\n    },\n    [\n      dirty,\n      value,\n      commitValue,\n      widgetMgr,\n      elementFormId,\n      fragmentId,\n      allowFormEnterToSubmit,\n    ]\n  )\n\n  return (\n    <div\n      className=\"stNumberInput\"\n      data-testid=\"stNumberInput\"\n      style={{ width }}\n    >\n      <WidgetLabel\n        label={element.label}\n        disabled={disabled}\n        labelVisibility={labelVisibilityProtoValueToEnum(\n          element.labelVisibility?.value\n        )}\n        htmlFor={id.current}\n      >\n        {element.help && (\n          <StyledWidgetLabelHelp>\n            <TooltipIcon\n              content={element.help}\n              placement={Placement.TOP_RIGHT}\n            />\n          </StyledWidgetLabelHelp>\n        )}\n      </WidgetLabel>\n      <StyledInputContainer\n        className={isFocused ? \"focused\" : \"\"}\n        data-testid=\"stNumberInputContainer\"\n      >\n        <UIInput\n          type=\"number\"\n          inputRef={inputRef}\n          value={formattedValue ?? \"\"}\n          placeholder={element.placeholder}\n          onBlur={() => onBlur()}\n          onFocus={() => onFocus()}\n          onChange={e => onChange(e)}\n          onKeyPress={e => onKeyPress(e)}\n          onKeyDown={e => onKeyDown(e)}\n          clearable={clearable}\n          clearOnEscape={clearable}\n          disabled={disabled}\n          aria-label={element.label}\n          id={id.current}\n          overrides={{\n            ClearIcon: {\n              props: {\n                overrides: {\n                  Svg: {\n                    style: {\n                      color: theme.colors.darkGray,\n                      // Since the close icon is an SVG, and we can't control its viewbox nor its attributes,\n                      // Let's use a scale transform effect to make it bigger.\n                      // The width property only enlarges its bounding box, so it's easier to click.\n                      transform: \"scale(1.4)\",\n                      width: theme.spacing.twoXL,\n                      marginRight: \"-1.25em\",\n                      \":hover\": {\n                        fill: theme.colors.bodyText,\n                      },\n                    },\n                  },\n                },\n              },\n            },\n            Input: {\n              props: {\n                \"data-testid\": \"stNumberInputField\",\n                step: step,\n                min: min,\n                max: max,\n              },\n              style: {\n                lineHeight: theme.lineHeights.inputWidget,\n                // Baseweb requires long-hand props, short-hand leads to weird bugs & warnings.\n                paddingRight: theme.spacing.sm,\n                paddingLeft: theme.spacing.sm,\n                paddingBottom: theme.spacing.sm,\n                paddingTop: theme.spacing.sm,\n              },\n            },\n            InputContainer: {\n              style: () => ({\n                borderTopRightRadius: 0,\n                borderBottomRightRadius: 0,\n              }),\n            },\n            Root: {\n              style: () => ({\n                // Baseweb requires long-hand props, short-hand leads to weird bugs & warnings.\n                borderTopRightRadius: 0,\n                borderBottomRightRadius: 0,\n                borderLeftWidth: 0,\n                borderRightWidth: 0,\n                borderTopWidth: 0,\n                borderBottomWidth: 0,\n              }),\n            },\n          }}\n        />\n        {/* We only want to show the increment/decrement controls when there is sufficient room to display the value and these controls. */}\n        {width > theme.breakpoints.hideNumberInputControls && (\n          <StyledInputControls>\n            <StyledInputControl\n              data-testid=\"stNumberInputStepDown\"\n              onClick={decrement}\n              disabled={!canDec || disabled}\n              tabIndex={-1}\n            >\n              <Icon\n                content={Minus}\n                size=\"xs\"\n                color={canDec ? \"inherit\" : \"disabled\"}\n              />\n            </StyledInputControl>\n            <StyledInputControl\n              data-testid=\"stNumberInputStepUp\"\n              onClick={increment}\n              disabled={!canInc || disabled}\n              tabIndex={-1}\n            >\n              <Icon\n                content={Plus}\n                size=\"xs\"\n                color={canInc ? \"inherit\" : \"disabled\"}\n              />\n            </StyledInputControl>\n          </StyledInputControls>\n        )}\n      </StyledInputContainer>\n      {/* Hide the \"Please enter to apply\" text in small widget sizes */}\n      {width > theme.breakpoints.hideWidgetDetails && (\n        <StyledInstructionsContainer clearable={clearable}>\n          <InputInstructions\n            dirty={dirty}\n            value={formattedValue ?? \"\"}\n            inForm={inForm}\n            allowEnterToSubmit={allowFormEnterToSubmit || !inForm}\n          />\n        </StyledInstructionsContainer>\n      )}\n    </div>\n  )\n}\n\nexport default withTheme(NumberInput)\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,MAAwB,OAAO;AAE3C,SAASC,KAAK,EAAEC,IAAI,QAAQ,4BAA4B;AACxD,SAASC,SAAS,QAAQ,gBAAgB;AAC1C,SAASC,OAAO,QAAQ,YAAY;AACpC,SAASC,KAAK,IAAIC,OAAO,QAAQ,cAAc;AAC/C,OAAOC,QAAQ,MAAM,iBAAiB;AAEtC,SACEC,QAAQ,EACRC,iBAAiB,EACjBC,+BAA+B,EAC/BC,kBAAkB;AAEpB,SAASC,eAAe;AACxB,SAASC,UAAU;AACnB,SAASC,WAAW,IAAIC,gBAAgB;AAKxC,OAAOC,WAAW;AAClB,SAASC,SAAS;AAClB,OAAOC,IAAI;AACX,OAAOC,iBAAiB;AACxB,SACEC,qBAAqB,EACrBC,WAAW;AAIb,SACEC,oBAAoB,EACpBC,kBAAkB,EAClBC,mBAAmB,EACnBC,2BAA2B;;AAG7B;AACA;AACA;AACA;AAHA,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAIA,SAASC,iBAAiBA,CACxBC,KAAgC,EACZ;EACpB,OAAOtB,iBAAiB,CAACsB,KAAK,CAAC,IAAIA,KAAK,KAAK,EAAE,GAAGC,SAAS,GAAGD,KAAK;AACrE;;AAEA;AACA;AACA;AACA;AACA,MAAME,eAAe,GACnBC,KAA2C,IACzB;EAClB,MAAMC,SAAS,GAAGD,KAAK,CAACE,OAAO,CAACC,QAAQ,KAAKtB,gBAAgB,CAACuB,QAAQ,CAACC,GAAG;EAC1E,MAAMC,WAAW,GAAGL,SAAS,GACzBD,KAAK,CAACO,SAAS,CAACC,WAAW,CAACR,KAAK,CAACE,OAAO,CAAC,GAC1CF,KAAK,CAACO,SAAS,CAACE,cAAc,CAACT,KAAK,CAACE,OAAO,CAAC;EACjD,OAAOI,WAAW,IAAIN,KAAK,CAACE,OAAO,CAACQ,OAAO,IAAI,IAAI;AACrD,CAAC;AAED,MAAMC,OAAO,GAAGC,IAAA,IAG2C;EAAA,IAH1C;IACfC,IAAI;IACJV;EAC2C,CAAC,GAAAS,IAAA;EAC5C,IAAIC,IAAI,EAAE;IACR,OAAOA,IAAI;EACb;EACA,IAAIV,QAAQ,KAAKtB,gBAAgB,CAACuB,QAAQ,CAACC,GAAG,EAAE;IAC9C,OAAO,CAAC;EACV;EACA,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA,OAAO,MAAMS,WAAW,GAAGC,KAAA,IAUN;EAAA,IAVO;IAC1BlB,KAAK;IACLmB,MAAM;IACNH,IAAI;IACJV;EAMF,CAAC,GAAAY,KAAA;EACC,IAAIxC,iBAAiB,CAACsB,KAAK,CAAC,EAAE;IAC5B,OAAO,IAAI;EACb;EAEA,IAAIoB,YAAY,GAAGrB,iBAAiB,CAACoB,MAAM,CAAC;EAE5C,IAAIzC,iBAAiB,CAAC0C,YAAY,CAAC,IAAIxC,kBAAkB,CAACoC,IAAI,CAAC,EAAE;IAC/D,MAAMK,OAAO,GAAGL,IAAI,CAACM,QAAQ,CAAC,CAAC;IAC/B,IACEhB,QAAQ,KAAKtB,gBAAgB,CAACuB,QAAQ,CAACgB,KAAK,IAC5CP,IAAI,KAAK,CAAC,IACVK,OAAO,CAACG,QAAQ,CAAC,GAAG,CAAC,EACrB;MACA,MAAMC,aAAa,GAAGJ,OAAO,CAACK,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACC,MAAM;MAClDP,YAAY,GAAI,MAAKK,aAAc,GAAE;IACvC;EACF;EAEA,IAAI/C,iBAAiB,CAAC0C,YAAY,CAAC,EAAE;IACnC,OAAOpB,KAAK,CAACsB,QAAQ,CAAC,CAAC;EACzB;EAEA,IAAI;IACF,OAAOjD,OAAO,CAAC+C,YAAY,EAAEpB,KAAK,CAAC;EACrC,CAAC,CAAC,OAAO4B,CAAC,EAAE;IACV9C,UAAU,CAAE,oBAAmBsC,YAAa,KAAIpB,KAAM,MAAK4B,CAAE,EAAC,CAAC;IAC/D,OAAOC,MAAM,CAAC7B,KAAK,CAAC;EACtB;AACF,CAAC;AAED,OAAO,MAAM8B,YAAY,GAAGA,CAC1B9B,KAAoB,EACpBgB,IAAY,EACZe,GAAW,KACC;EACZ,IAAIrD,iBAAiB,CAACsB,KAAK,CAAC,EAAE;IAC5B,OAAO,KAAK;EACd;EACA,OAAOA,KAAK,GAAGgB,IAAI,IAAIe,GAAG;AAC5B,CAAC;AAED,OAAO,MAAMC,YAAY,GAAGA,CAC1BhC,KAAoB,EACpBgB,IAAY,EACZiB,GAAW,KACC;EACZ,IAAIvD,iBAAiB,CAACsB,KAAK,CAAC,EAAE;IAC5B,OAAO,KAAK;EACd;EACA,OAAOA,KAAK,GAAGgB,IAAI,IAAIiB,GAAG;AAC5B,CAAC;AAWD,OAAO,MAAMlD,WAA4B,GAAGmD,KAAA,IAOjB;EAAA,IAPkB;IAC3CC,QAAQ;IACR9B,OAAO;IACPK,SAAS;IACT0B,KAAK;IACLC,KAAK;IACLC;EACK,CAAC,GAAAJ,KAAA;EACN,MAAM;IACJ5B,QAAQ,EAAEiC,eAAe;IACzBC,EAAE,EAAEC,SAAS;IACbC,MAAM,EAAEC,aAAa;IACrB9B,OAAO,EAAE+B,cAAc;IACvBzB,MAAM,EAAE0B;EACV,CAAC,GAAGxC,OAAO;EACX,MAAM0B,GAAG,GAAG1B,OAAO,CAACyC,MAAM,GAAGzC,OAAO,CAAC0B,GAAG,GAAG,CAACgB,QAAQ;EACpD,MAAMd,GAAG,GAAG5B,OAAO,CAAC2C,MAAM,GAAG3C,OAAO,CAAC4B,GAAG,GAAG,CAACc,QAAQ;EAEpD,MAAM,CAAC/B,IAAI,EAAEiC,OAAO,CAAC,GAAGhF,KAAK,CAACiF,QAAQ,CAASpC,OAAO,CAACT,OAAO,CAAC,CAAC;EAChE,MAAM8C,YAAY,GAAGjD,eAAe,CAAC;IAAEG,OAAO;IAAEK;EAAU,CAAC,CAAC;EAC5D,MAAM,CAAC0C,KAAK,EAAEC,QAAQ,CAAC,GAAGpF,KAAK,CAACiF,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAAClD,KAAK,EAAEsD,QAAQ,CAAC,GAAGrF,KAAK,CAACiF,QAAQ,CAAgBC,YAAY,CAAC;EACrE,MAAM,CAACI,cAAc,EAAEC,iBAAiB,CAAC,GAAGvF,KAAK,CAACiF,QAAQ,CACxDjC,WAAW,CAAC;IAAEjB,KAAK,EAAEmD,YAAY;IAAE,GAAG9C,OAAO;IAAEW;EAAK,CAAC,CACvD,CAAC;EACD,MAAM,CAACyC,SAAS,EAAEC,YAAY,CAAC,GAAGzF,KAAK,CAACiF,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAMS,QAAQ,GAAG1F,KAAK,CAAC2F,MAAM,CAAyC,IAAI,CAAC;EAC3E,MAAMC,eAAe,GAAG5F,KAAK,CAAC2F,MAAM,CAAC,IAAI/E,eAAe,CAAC,CAAC,CAAC;EAC3D,MAAM2D,EAAE,GAAGvE,KAAK,CAAC2F,MAAM,CAACpF,QAAQ,CAAC,eAAe,CAAC,CAAC;EAElD,MAAMsF,MAAM,GAAGhC,YAAY,CAAC9B,KAAK,EAAEgB,IAAI,EAAEe,GAAG,CAAC;EAC7C,MAAMgC,MAAM,GAAG/B,YAAY,CAAChC,KAAK,EAAEgB,IAAI,EAAEiB,GAAG,CAAC;EAE7C,MAAM+B,MAAM,GAAGvF,QAAQ,CAAC;IAAEiE,MAAM,EAAEC;EAAc,CAAC,CAAC;EAClD;EACA,MAAMsB,sBAAsB,GAC1BvD,SAAS,CAACuD,sBAAsB,CAACtB,aAAa,CAAC;;EAEjD;EACA1E,KAAK,CAACiG,SAAS,CAAC,MAAM;IACpBjB,OAAO,CAACnC,OAAO,CAAC;MAAEE,IAAI,EAAEX,OAAO,CAACW,IAAI;MAAEV,QAAQ,EAAED,OAAO,CAACC;IAAS,CAAC,CAAC,CAAC;EACtE,CAAC,EAAE,CAACD,OAAO,CAACC,QAAQ,EAAED,OAAO,CAACW,IAAI,CAAC,CAAC;EAEpC,MAAMmD,WAAW,GAAGlG,KAAK,CAACmG,WAAW,CACnCC,KAAA,IAAiE;IAAA,IAAhE;MAAErE,KAAK;MAAEsE;IAAiD,CAAC,GAAAD,KAAA;IAC1D,IAAIzF,kBAAkB,CAACoB,KAAK,CAAC,KAAK+B,GAAG,GAAG/B,KAAK,IAAIA,KAAK,GAAGiC,GAAG,CAAC,EAAE;MAC7D0B,QAAQ,CAACY,OAAO,EAAEC,cAAc,CAAC,CAAC;IACpC,CAAC,MAAM;MACL,MAAMC,QAAQ,GAAGzE,KAAK,IAAI4C,cAAc,IAAI,IAAI;MAEhD,QAAQL,eAAe;QACrB,KAAKvD,gBAAgB,CAACuB,QAAQ,CAACC,GAAG;UAChCE,SAAS,CAACgE,WAAW,CACnB;YAAElC,EAAE,EAAEC,SAAS;YAAEC,MAAM,EAAEC;UAAc,CAAC,EACxC8B,QAAQ,EACRH,MAAM,EACNhC,UACF,CAAC;UACD;QACF,KAAKtD,gBAAgB,CAACuB,QAAQ,CAACgB,KAAK;UAClCb,SAAS,CAACiE,cAAc,CACtB;YAAEnC,EAAE,EAAEC,SAAS;YAAEC,MAAM,EAAEC;UAAc,CAAC,EACxC8B,QAAQ,EACRH,MAAM,EACNhC,UACF,CAAC;UACD;QACF;UACE,MAAM,IAAIsC,KAAK,CAAC,mBAAmB,CAAC;MACxC;MAEAvB,QAAQ,CAAC,KAAK,CAAC;MACfC,QAAQ,CAACmB,QAAQ,CAAC;MAClBjB,iBAAiB,CACfvC,WAAW,CAAC;QACVjB,KAAK,EAAEyE,QAAQ;QACfnE,QAAQ,EAAEiC,eAAe;QACzBpB,MAAM,EAAE0B,aAAa;QACrB7B;MACF,CAAC,CACH,CAAC;IACH;EACF,CAAC,EACD,CACEe,GAAG,EACHE,GAAG,EACH0B,QAAQ,EACRjD,SAAS,EACT4B,UAAU,EACVtB,IAAI,EACJuB,eAAe,EACfE,SAAS,EACTE,aAAa,EACbC,cAAc,EACdC,aAAa,CAEjB,CAAC;EAED,MAAMgC,MAAM,GAAGA,CAAA,KAAY;IACzB,IAAIzB,KAAK,EAAE;MACTe,WAAW,CAAC;QAAEnE,KAAK;QAAEsE,MAAM,EAAE;UAAEQ,MAAM,EAAE;QAAK;MAAE,CAAC,CAAC;IAClD;IACApB,YAAY,CAAC,KAAK,CAAC;EACrB,CAAC;EAED,MAAMqB,OAAO,GAAGA,CAAA,KAAY;IAC1BrB,YAAY,CAAC,IAAI,CAAC;EACpB,CAAC;EAED,MAAMsB,kBAAkB,GAAGA,CAAA,KAAY;IACrC,MAAM;MAAEhF;IAAM,CAAC,GAAGK,OAAO;IACzBA,OAAO,CAACiD,QAAQ,GAAG,KAAK;IACxBA,QAAQ,CAACtD,KAAK,IAAI,IAAI,CAAC;IACvBwD,iBAAiB,CAACvC,WAAW,CAAC;MAAEjB,KAAK,EAAEA,KAAK,IAAI,IAAI;MAAE,GAAGK,OAAO;MAAEW;IAAK,CAAC,CAAC,CAAC;IAC1EmD,WAAW,CAAC;MAAEnE,KAAK,EAAEA,KAAK,IAAI,IAAI;MAAEsE,MAAM,EAAE;QAAEQ,MAAM,EAAE;MAAM;IAAE,CAAC,CAAC;EAClE,CAAC;;EAED;EACA7G,KAAK,CAACiG,SAAS,CAAC,MAAM;IACpB,MAAMe,mBAAmB,GAAGpB,eAAe,CAACU,OAAO;IACnD,IAAIlE,OAAO,CAACiD,QAAQ,EAAE;MACpB0B,kBAAkB,CAAC,CAAC;IACtB,CAAC,MAAM;MACLb,WAAW,CAAC;QAAEnE,KAAK;QAAEsE,MAAM,EAAE;UAAEQ,MAAM,EAAE;QAAM;MAAE,CAAC,CAAC;IACnD;IAEA,OAAO,MAAM;MACXG,mBAAmB,CAACC,UAAU,CAAC,CAAC;IAClC,CAAC;;IAED;IACA;IACA;IACA;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,IAAI7E,OAAO,CAACiD,QAAQ,EAAE;IACpB0B,kBAAkB,CAAC,CAAC;EACtB;EAEA,MAAMG,SAAS,GAAGzG,iBAAiB,CAAC2B,OAAO,CAACQ,OAAO,CAAC,IAAI,CAACsB,QAAQ;EAEjE0B,eAAe,CAACU,OAAO,CAACa,uBAAuB,CAC7C1E,SAAS,EACTL,OAAO,CAACqC,MAAM,EACd,MAAM;IACJY,QAAQ,CAACjD,OAAO,CAACQ,OAAO,IAAI,IAAI,CAAC;IACjCsD,WAAW,CAAC;MAAEnE,KAAK;MAAEsE,MAAM,EAAE;QAAEQ,MAAM,EAAE;MAAK;IAAE,CAAC,CAAC;EAClD,CACF,CAAC;EAED,MAAMO,QAAQ,GACZzD,CAA4D,IACnD;IACT,MAAM;MAAE5B;IAAM,CAAC,GAAG4B,CAAC,CAAC0D,MAAM;IAE1B,IAAItF,KAAK,KAAK,EAAE,EAAE;MAChBqD,QAAQ,CAAC,IAAI,CAAC;MACdC,QAAQ,CAAC,IAAI,CAAC;MACdE,iBAAiB,CAAC,IAAI,CAAC;IACzB,CAAC,MAAM;MACL,IAAI+B,QAAgB;MAEpB,IAAIlF,OAAO,CAACC,QAAQ,KAAKtB,gBAAgB,CAACuB,QAAQ,CAACC,GAAG,EAAE;QACtD+E,QAAQ,GAAGC,QAAQ,CAACxF,KAAK,EAAE,EAAE,CAAC;MAChC,CAAC,MAAM;QACLuF,QAAQ,GAAGE,UAAU,CAACzF,KAAK,CAAC;MAC9B;MAEAqD,QAAQ,CAAC,IAAI,CAAC;MACdC,QAAQ,CAACiC,QAAQ,CAAC;MAClB/B,iBAAiB,CAACxD,KAAK,CAAC;IAC1B;EACF,CAAC;EAED,MAAM0F,SAAS,GAAGzH,KAAK,CAACmG,WAAW,CAAC,MAAM;IACxC,IAAIL,MAAM,EAAE;MACVV,QAAQ,CAAC,IAAI,CAAC;MACdc,WAAW,CAAC;QAAEnE,KAAK,EAAE,CAACA,KAAK,IAAI+B,GAAG,IAAIf,IAAI;QAAEsD,MAAM,EAAE;UAAEQ,MAAM,EAAE;QAAK;MAAE,CAAC,CAAC;IACzE;EACF,CAAC,EAAE,CAAC9E,KAAK,EAAE+B,GAAG,EAAEf,IAAI,EAAE+C,MAAM,CAAC,CAAC;EAE9B,MAAM4B,SAAS,GAAG1H,KAAK,CAACmG,WAAW,CAAC,MAAM;IACxC,IAAIN,MAAM,EAAE;MACVT,QAAQ,CAAC,IAAI,CAAC;MACdc,WAAW,CAAC;QAAEnE,KAAK,EAAE,CAACA,KAAK,IAAIiC,GAAG,IAAIjB,IAAI;QAAEsD,MAAM,EAAE;UAAEQ,MAAM,EAAE;QAAK;MAAE,CAAC,CAAC;IACzE;EACF,CAAC,EAAE,CAAC9E,KAAK,EAAEiC,GAAG,EAAEjB,IAAI,EAAE8C,MAAM,CAAC,CAAC;EAE9B,MAAM8B,SAAS,GAAG3H,KAAK,CAACmG,WAAW,CAChCxC,CAA8D,IAAW;IACxE,MAAM;MAAEiE;IAAI,CAAC,GAAGjE,CAAC;IAEjB,QAAQiE,GAAG;MACT,KAAK,SAAS;QACZjE,CAAC,CAACkE,cAAc,CAAC,CAAC;QAClBJ,SAAS,CAAC,CAAC;QACX;MACF,KAAK,WAAW;QACd9D,CAAC,CAACkE,cAAc,CAAC,CAAC;QAClBH,SAAS,CAAC,CAAC;QACX;MACF;IACF;EACF,CAAC,EACD,CAACD,SAAS,EAAEC,SAAS,CACvB,CAAC;EAED,MAAMI,UAAU,GAAG9H,KAAK,CAACmG,WAAW,CACjCxC,CAA8D,IAAW;IACxE,IAAIA,CAAC,CAACiE,GAAG,KAAK,OAAO,EAAE;MACrB,IAAIzC,KAAK,EAAE;QACTe,WAAW,CAAC;UAAEnE,KAAK;UAAEsE,MAAM,EAAE;YAAEQ,MAAM,EAAE;UAAK;QAAE,CAAC,CAAC;MAClD;MACA,IAAIb,sBAAsB,EAAE;QAC1BvD,SAAS,CAACsF,UAAU,CAACrD,aAAa,EAAEL,UAAU,CAAC;MACjD;IACF;EACF,CAAC,EACD,CACEc,KAAK,EACLpD,KAAK,EACLmE,WAAW,EACXzD,SAAS,EACTiC,aAAa,EACbL,UAAU,EACV2B,sBAAsB,CAE1B,CAAC;EAED,oBACEnE,KAAA;IACEmG,SAAS,EAAC,eAAe;IACzB,eAAY,eAAe;IAC3BC,KAAK,EAAE;MAAE9D;IAAM,CAAE;IAAA+D,QAAA,gBAEjBvG,IAAA,CAACN,WAAW;MACV8G,KAAK,EAAE/F,OAAO,CAAC+F,KAAM;MACrBjE,QAAQ,EAAEA,QAAS;MACnBkE,eAAe,EAAE1H,+BAA+B,CAC9C0B,OAAO,CAACgG,eAAe,EAAErG,KAC3B,CAAE;MACFsG,OAAO,EAAE9D,EAAE,CAAC+B,OAAQ;MAAA4B,QAAA,EAEnB9F,OAAO,CAACkG,IAAI,iBACX3G,IAAA,CAACP,qBAAqB;QAAA8G,QAAA,eACpBvG,IAAA,CAACX,WAAW;UACVuH,OAAO,EAAEnG,OAAO,CAACkG,IAAK;UACtBE,SAAS,EAAEvH,SAAS,CAACwH;QAAU,CAChC;MAAC,CACmB;IACxB,CACU,CAAC,eACd5G,KAAA,CAACP,oBAAoB;MACnB0G,SAAS,EAAExC,SAAS,GAAG,SAAS,GAAG,EAAG;MACtC,eAAY,wBAAwB;MAAA0C,QAAA,gBAEpCvG,IAAA,CAACrB,OAAO;QACNoI,IAAI,EAAC,QAAQ;QACbhD,QAAQ,EAAEA,QAAS;QACnB3D,KAAK,EAAEuD,cAAc,IAAI,EAAG;QAC5BqD,WAAW,EAAEvG,OAAO,CAACuG,WAAY;QACjC/B,MAAM,EAAEA,CAAA,KAAMA,MAAM,CAAC,CAAE;QACvBE,OAAO,EAAEA,CAAA,KAAMA,OAAO,CAAC,CAAE;QACzBM,QAAQ,EAAEzD,CAAC,IAAIyD,QAAQ,CAACzD,CAAC,CAAE;QAC3BmE,UAAU,EAAEnE,CAAC,IAAImE,UAAU,CAACnE,CAAC,CAAE;QAC/BgE,SAAS,EAAEhE,CAAC,IAAIgE,SAAS,CAAChE,CAAC,CAAE;QAC7BuD,SAAS,EAAEA,SAAU;QACrB0B,aAAa,EAAE1B,SAAU;QACzBhD,QAAQ,EAAEA,QAAS;QACnB,cAAY9B,OAAO,CAAC+F,KAAM;QAC1B5D,EAAE,EAAEA,EAAE,CAAC+B,OAAQ;QACfuC,SAAS,EAAE;UACTC,SAAS,EAAE;YACT5G,KAAK,EAAE;cACL2G,SAAS,EAAE;gBACTE,GAAG,EAAE;kBACHd,KAAK,EAAE;oBACLe,KAAK,EAAE5E,KAAK,CAAC6E,MAAM,CAACC,QAAQ;oBAC5B;oBACA;oBACA;oBACAC,SAAS,EAAE,YAAY;oBACvBhF,KAAK,EAAEC,KAAK,CAACgF,OAAO,CAACC,KAAK;oBAC1BC,WAAW,EAAE,SAAS;oBACtB,QAAQ,EAAE;sBACRC,IAAI,EAAEnF,KAAK,CAAC6E,MAAM,CAACO;oBACrB;kBACF;gBACF;cACF;YACF;UACF,CAAC;UACDnJ,KAAK,EAAE;YACL6B,KAAK,EAAE;cACL,aAAa,EAAE,oBAAoB;cACnCa,IAAI,EAAEA,IAAI;cACVe,GAAG,EAAEA,GAAG;cACRE,GAAG,EAAEA;YACP,CAAC;YACDiE,KAAK,EAAE;cACLwB,UAAU,EAAErF,KAAK,CAACsF,WAAW,CAACC,WAAW;cACzC;cACAC,YAAY,EAAExF,KAAK,CAACgF,OAAO,CAACS,EAAE;cAC9BC,WAAW,EAAE1F,KAAK,CAACgF,OAAO,CAACS,EAAE;cAC7BE,aAAa,EAAE3F,KAAK,CAACgF,OAAO,CAACS,EAAE;cAC/BG,UAAU,EAAE5F,KAAK,CAACgF,OAAO,CAACS;YAC5B;UACF,CAAC;UACDI,cAAc,EAAE;YACdhC,KAAK,EAAEA,CAAA,MAAO;cACZiC,oBAAoB,EAAE,CAAC;cACvBC,uBAAuB,EAAE;YAC3B,CAAC;UACH,CAAC;UACDC,IAAI,EAAE;YACJnC,KAAK,EAAEA,CAAA,MAAO;cACZ;cACAiC,oBAAoB,EAAE,CAAC;cACvBC,uBAAuB,EAAE,CAAC;cAC1BE,eAAe,EAAE,CAAC;cAClBC,gBAAgB,EAAE,CAAC;cACnBC,cAAc,EAAE,CAAC;cACjBC,iBAAiB,EAAE;YACrB,CAAC;UACH;QACF;MAAE,CACH,CAAC,EAEDrG,KAAK,GAAGC,KAAK,CAACqG,WAAW,CAACC,uBAAuB,iBAChD7I,KAAA,CAACL,mBAAmB;QAAA0G,QAAA,gBAClBvG,IAAA,CAACJ,kBAAkB;UACjB,eAAY,uBAAuB;UACnCoJ,OAAO,EAAEjD,SAAU;UACnBxD,QAAQ,EAAE,CAAC2B,MAAM,IAAI3B,QAAS;UAC9B0G,QAAQ,EAAE,CAAC,CAAE;UAAA1C,QAAA,eAEbvG,IAAA,CAACT,IAAI;YACHqH,OAAO,EAAEtI,KAAM;YACf4K,IAAI,EAAC,IAAI;YACT7B,KAAK,EAAEnD,MAAM,GAAG,SAAS,GAAG;UAAW,CACxC;QAAC,CACgB,CAAC,eACrBlE,IAAA,CAACJ,kBAAkB;UACjB,eAAY,qBAAqB;UACjCoJ,OAAO,EAAElD,SAAU;UACnBvD,QAAQ,EAAE,CAAC4B,MAAM,IAAI5B,QAAS;UAC9B0G,QAAQ,EAAE,CAAC,CAAE;UAAA1C,QAAA,eAEbvG,IAAA,CAACT,IAAI;YACHqH,OAAO,EAAErI,IAAK;YACd2K,IAAI,EAAC,IAAI;YACT7B,KAAK,EAAElD,MAAM,GAAG,SAAS,GAAG;UAAW,CACxC;QAAC,CACgB,CAAC;MAAA,CACF,CACtB;IAAA,CACmB,CAAC,EAEtB3B,KAAK,GAAGC,KAAK,CAACqG,WAAW,CAACK,iBAAiB,iBAC1CnJ,IAAA,CAACF,2BAA2B;MAACyF,SAAS,EAAEA,SAAU;MAAAgB,QAAA,eAChDvG,IAAA,CAACR,iBAAiB;QAChBgE,KAAK,EAAEA,KAAM;QACbpD,KAAK,EAAEuD,cAAc,IAAI,EAAG;QAC5BS,MAAM,EAAEA,MAAO;QACfgF,kBAAkB,EAAE/E,sBAAsB,IAAI,CAACD;MAAO,CACvD;IAAC,CACyB,CAC9B;EAAA,CACE,CAAC;AAEV,CAAC;AAED,eAAe5F,SAAS,CAACW,WAAW,CAAC"}