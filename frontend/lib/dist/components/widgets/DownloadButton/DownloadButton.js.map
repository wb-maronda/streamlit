{"version":3,"file":"DownloadButton.js","names":["React","BaseButton","BaseButtonTooltip","BaseButtonKind","BaseButtonSize","StreamlitMarkdown","LibContext","jsx","_jsx","createDownloadLink","endpoints","url","enforceDownloadInNewTab","link","document","createElement","uri","buildMediaURL","setAttribute","DownloadButton","props","disabled","element","widgetMgr","width","fragmentId","style","libConfig","useContext","kind","type","PRIMARY","SECONDARY","handleDownloadClick","setTriggerValue","fromUi","click","fluidWidth","help","className","children","size","SMALL","onClick","useContainerWidth","source","label","allowHTML","isLabel","largerLabel","disableLinks"],"sources":["../../../../src/components/widgets/DownloadButton/DownloadButton.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\nimport { DownloadButton as DownloadButtonProto } from \"@streamlit/lib/src/proto\"\nimport BaseButton, {\n  BaseButtonTooltip,\n  BaseButtonKind,\n  BaseButtonSize,\n} from \"@streamlit/lib/src/components/shared/BaseButton\"\nimport { WidgetStateManager } from \"@streamlit/lib/src/WidgetStateManager\"\nimport StreamlitMarkdown from \"@streamlit/lib/src/components/shared/StreamlitMarkdown\"\nimport { StreamlitEndpoints } from \"@streamlit/lib/src/StreamlitEndpoints\"\nimport { LibContext } from \"@streamlit/lib/src/components/core/LibContext\"\n\nexport interface Props {\n  endpoints: StreamlitEndpoints\n  disabled: boolean\n  element: DownloadButtonProto\n  widgetMgr: WidgetStateManager\n  width: number\n  fragmentId?: string\n}\n\nexport function createDownloadLink(\n  endpoints: StreamlitEndpoints,\n  url: string,\n  enforceDownloadInNewTab: boolean\n): HTMLAnchorElement {\n  const link = document.createElement(\"a\")\n  const uri = endpoints.buildMediaURL(url)\n  link.setAttribute(\"href\", uri)\n  if (enforceDownloadInNewTab) {\n    link.setAttribute(\"target\", \"_blank\")\n  } else {\n    link.setAttribute(\"target\", \"_self\")\n  }\n  link.setAttribute(\"download\", \"\")\n  return link\n}\n\nfunction DownloadButton(props: Props): ReactElement {\n  const { disabled, element, widgetMgr, width, endpoints, fragmentId } = props\n  const style = { width }\n  const {\n    libConfig: { enforceDownloadInNewTab = false }, // Default to false, if no libConfig, e.g. for tests\n  } = React.useContext(LibContext)\n\n  const kind =\n    element.type === \"primary\"\n      ? BaseButtonKind.PRIMARY\n      : BaseButtonKind.SECONDARY\n\n  const handleDownloadClick: () => void = () => {\n    // Downloads are only done on links, so create a hidden one and click it\n    // for the user.\n    widgetMgr.setTriggerValue(element, { fromUi: true }, fragmentId)\n    const link = createDownloadLink(\n      endpoints,\n      element.url,\n      enforceDownloadInNewTab\n    )\n    link.click()\n  }\n\n  // When useContainerWidth true & has help tooltip,\n  // we need to pass the container width down to the button\n  const fluidWidth = element.help ? width : true\n\n  return (\n    <div\n      className=\"row-widget stDownloadButton\"\n      data-testid=\"stDownloadButton\"\n      style={style}\n    >\n      <BaseButtonTooltip help={element.help}>\n        <BaseButton\n          kind={kind}\n          size={BaseButtonSize.SMALL}\n          disabled={disabled}\n          onClick={handleDownloadClick}\n          fluidWidth={element.useContainerWidth ? fluidWidth : false}\n        >\n          <StreamlitMarkdown\n            source={element.label}\n            allowHTML={false}\n            isLabel\n            largerLabel\n            disableLinks\n          />\n        </BaseButton>\n      </BaseButtonTooltip>\n    </div>\n  )\n}\n\nexport default DownloadButton\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,MAAwB,OAAO;AAE3C,OAAOC,UAAU,IACfC,iBAAiB,EACjBC,cAAc,EACdC,cAAc;AAGhB,OAAOC,iBAAiB;AAExB,SAASC,UAAU;AAAuD,SAAAC,GAAA,IAAAC,IAAA;AAW1E,OAAO,SAASC,kBAAkBA,CAChCC,SAA6B,EAC7BC,GAAW,EACXC,uBAAgC,EACb;EACnB,MAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;EACxC,MAAMC,GAAG,GAAGN,SAAS,CAACO,aAAa,CAACN,GAAG,CAAC;EACxCE,IAAI,CAACK,YAAY,CAAC,MAAM,EAAEF,GAAG,CAAC;EAC9B,IAAIJ,uBAAuB,EAAE;IAC3BC,IAAI,CAACK,YAAY,CAAC,QAAQ,EAAE,QAAQ,CAAC;EACvC,CAAC,MAAM;IACLL,IAAI,CAACK,YAAY,CAAC,QAAQ,EAAE,OAAO,CAAC;EACtC;EACAL,IAAI,CAACK,YAAY,CAAC,UAAU,EAAE,EAAE,CAAC;EACjC,OAAOL,IAAI;AACb;AAEA,SAASM,cAAcA,CAACC,KAAY,EAAgB;EAClD,MAAM;IAAEC,QAAQ;IAAEC,OAAO;IAAEC,SAAS;IAAEC,KAAK;IAAEd,SAAS;IAAEe;EAAW,CAAC,GAAGL,KAAK;EAC5E,MAAMM,KAAK,GAAG;IAAEF;EAAM,CAAC;EACvB,MAAM;IACJG,SAAS,EAAE;MAAEf,uBAAuB,GAAG;IAAM,CAAC,CAAE;EAClD,CAAC,GAAGZ,KAAK,CAAC4B,UAAU,CAACtB,UAAU,CAAC;EAEhC,MAAMuB,IAAI,GACRP,OAAO,CAACQ,IAAI,KAAK,SAAS,GACtB3B,cAAc,CAAC4B,OAAO,GACtB5B,cAAc,CAAC6B,SAAS;EAE9B,MAAMC,mBAA+B,GAAGA,CAAA,KAAM;IAC5C;IACA;IACAV,SAAS,CAACW,eAAe,CAACZ,OAAO,EAAE;MAAEa,MAAM,EAAE;IAAK,CAAC,EAAEV,UAAU,CAAC;IAChE,MAAMZ,IAAI,GAAGJ,kBAAkB,CAC7BC,SAAS,EACTY,OAAO,CAACX,GAAG,EACXC,uBACF,CAAC;IACDC,IAAI,CAACuB,KAAK,CAAC,CAAC;EACd,CAAC;;EAED;EACA;EACA,MAAMC,UAAU,GAAGf,OAAO,CAACgB,IAAI,GAAGd,KAAK,GAAG,IAAI;EAE9C,oBACEhB,IAAA;IACE+B,SAAS,EAAC,6BAA6B;IACvC,eAAY,kBAAkB;IAC9Bb,KAAK,EAAEA,KAAM;IAAAc,QAAA,eAEbhC,IAAA,CAACN,iBAAiB;MAACoC,IAAI,EAAEhB,OAAO,CAACgB,IAAK;MAAAE,QAAA,eACpChC,IAAA,CAACP,UAAU;QACT4B,IAAI,EAAEA,IAAK;QACXY,IAAI,EAAErC,cAAc,CAACsC,KAAM;QAC3BrB,QAAQ,EAAEA,QAAS;QACnBsB,OAAO,EAAEV,mBAAoB;QAC7BI,UAAU,EAAEf,OAAO,CAACsB,iBAAiB,GAAGP,UAAU,GAAG,KAAM;QAAAG,QAAA,eAE3DhC,IAAA,CAACH,iBAAiB;UAChBwC,MAAM,EAAEvB,OAAO,CAACwB,KAAM;UACtBC,SAAS,EAAE,KAAM;UACjBC,OAAO;UACPC,WAAW;UACXC,YAAY;QAAA,CACb;MAAC,CACQ;IAAC,CACI;EAAC,CACjB,CAAC;AAEV;AAEA,eAAe/B,cAAc"}