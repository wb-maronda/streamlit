{"version":3,"file":"Checkbox.test.js","names":["React","act","fireEvent","screen","WidgetStateManager","render","Checkbox","CheckboxProto","LabelVisibilityMessage","LabelVisibilityMessageProto","jsx","_jsx","getProps","elementProps","arguments","length","undefined","widgetProps","element","create","id","label","default","type","StyleType","DEFAULT","width","disabled","widgetMgr","sendRerunBackMsg","jest","fn","formsDataChanged","describe","it","props","expect","getByRole","toBeInTheDocument","spyOn","setBoolValue","toHaveBeenCalledWith","fromUi","checkboxElement","getByTestId","toHaveClass","toHaveStyle","getByText","labelVisibility","value","LabelVisibilityOptions","HIDDEN","COLLAPSED","not","toBeChecked","toBeDisabled","click","fragmentId","formId","setFormSubmitBehaviors","toHaveBeenLastCalledWith","submitForm"],"sources":["../../../../src/components/widgets/Checkbox/Checkbox.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\n\nimport { act, fireEvent, screen } from \"@testing-library/react\"\nimport \"@testing-library/jest-dom\"\n\nimport { WidgetStateManager } from \"@streamlit/lib/src/WidgetStateManager\"\nimport { render } from \"@streamlit/lib/src/test_util\"\nimport {\n  Checkbox as CheckboxProto,\n  LabelVisibilityMessage as LabelVisibilityMessageProto,\n} from \"@streamlit/lib/src/proto\"\n\nimport Checkbox, { Props } from \"./Checkbox\"\n\nconst getProps = (\n  elementProps: Partial<CheckboxProto> = {},\n  widgetProps: Partial<Props> = {}\n): Props => ({\n  element: CheckboxProto.create({\n    id: \"1\",\n    label: \"Label\",\n    default: false,\n    type: CheckboxProto.StyleType.DEFAULT,\n    ...elementProps,\n  }),\n  width: 0,\n  disabled: false,\n  widgetMgr: new WidgetStateManager({\n    sendRerunBackMsg: jest.fn(),\n    formsDataChanged: jest.fn(),\n  }),\n  ...widgetProps,\n})\n\ndescribe(\"Checkbox widget\", () => {\n  it(\"renders without crashing\", () => {\n    const props = getProps()\n    render(<Checkbox {...props} />)\n\n    expect(screen.getByRole(\"checkbox\")).toBeInTheDocument()\n  })\n\n  it(\"sets widget value on mount\", () => {\n    const props = getProps()\n    jest.spyOn(props.widgetMgr, \"setBoolValue\")\n\n    render(<Checkbox {...props} />)\n\n    expect(props.widgetMgr.setBoolValue).toHaveBeenCalledWith(\n      props.element,\n      props.element.default,\n      { fromUi: false },\n      undefined\n    )\n  })\n\n  it(\"has correct className and style\", () => {\n    const props = getProps()\n    render(<Checkbox {...props} />)\n    const checkboxElement = screen.getByTestId(\"stCheckbox\")\n\n    expect(checkboxElement).toHaveClass(\"stCheckbox\")\n    expect(checkboxElement).toHaveStyle(`width: ${props.width}px`)\n  })\n\n  it(\"renders a label\", () => {\n    const props = getProps()\n    render(<Checkbox {...props} />)\n    expect(screen.getByText(props.element.label)).toBeInTheDocument()\n  })\n\n  it(\"pass labelVisibility prop to StyledContent correctly when hidden\", () => {\n    const props = getProps({\n      labelVisibility: {\n        value: LabelVisibilityMessageProto.LabelVisibilityOptions.HIDDEN,\n      },\n    })\n\n    render(<Checkbox {...props} />)\n    expect(screen.getByTestId(\"stWidgetLabel\")).toHaveStyle(\n      \"visibility: hidden\"\n    )\n  })\n\n  it(\"pass labelVisibility prop to StyledContent correctly when collapsed\", () => {\n    const props = getProps({\n      labelVisibility: {\n        value: LabelVisibilityMessageProto.LabelVisibilityOptions.COLLAPSED,\n      },\n    })\n\n    render(<Checkbox {...props} />)\n\n    expect(screen.getByTestId(\"stWidgetLabel\")).toHaveStyle(\"display: none\")\n  })\n\n  it(\"is unchecked by default\", () => {\n    const props = getProps()\n    render(<Checkbox {...props} />)\n\n    expect(screen.getByRole(\"checkbox\")).not.toBeChecked()\n  })\n\n  it(\"is not disabled by default\", () => {\n    const props = getProps()\n    render(<Checkbox {...props} />)\n\n    expect(screen.getByRole(\"checkbox\")).not.toBeDisabled()\n  })\n\n  it(\"handles the onChange event\", () => {\n    const props = getProps()\n    jest.spyOn(props.widgetMgr, \"setBoolValue\")\n\n    render(<Checkbox {...props} />)\n\n    fireEvent.click(screen.getByRole(\"checkbox\"))\n\n    expect(props.widgetMgr.setBoolValue).toHaveBeenCalledWith(\n      props.element,\n      true,\n      { fromUi: true },\n      undefined\n    )\n    expect(screen.getByRole(\"checkbox\")).toBeChecked()\n  })\n\n  it(\"can pass fragmentId to setBoolValue\", () => {\n    const props = getProps(undefined, { fragmentId: \"myFragmentId\" })\n    jest.spyOn(props.widgetMgr, \"setBoolValue\")\n\n    render(<Checkbox {...props} />)\n\n    fireEvent.click(screen.getByRole(\"checkbox\"))\n\n    expect(props.widgetMgr.setBoolValue).toHaveBeenCalledWith(\n      props.element,\n      true,\n      { fromUi: true },\n      \"myFragmentId\"\n    )\n  })\n\n  it(\"resets its value when form is cleared\", async () => {\n    // Create a widget in a clearOnSubmit form\n    const props = getProps({ formId: \"form\" })\n    props.widgetMgr.setFormSubmitBehaviors(\"form\", true)\n\n    jest.spyOn(props.widgetMgr, \"setBoolValue\")\n\n    render(<Checkbox {...props} />)\n\n    // Change the widget value\n    fireEvent.click(screen.getByRole(\"checkbox\"))\n\n    expect(screen.getByRole(\"checkbox\")).toBeChecked()\n    expect(props.widgetMgr.setBoolValue).toHaveBeenLastCalledWith(\n      props.element,\n      true,\n      { fromUi: true },\n      undefined\n    )\n\n    // \"Submit\" the form\n    await act(() => {\n      props.widgetMgr.submitForm(\"form\", undefined)\n    })\n\n    // Our widget should be reset, and the widgetMgr should be updated\n    expect(screen.getByRole(\"checkbox\")).not.toBeChecked()\n    expect(props.widgetMgr.setBoolValue).toHaveBeenLastCalledWith(\n      props.element,\n      props.element.default,\n      {\n        fromUi: true,\n      },\n      undefined\n    )\n  })\n})\n"],"mappings":"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"}