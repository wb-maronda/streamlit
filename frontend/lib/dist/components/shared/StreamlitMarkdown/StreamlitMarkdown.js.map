{"version":3,"file":"StreamlitMarkdown.js","names":["React","PureComponent","visit","useTheme","ReactMarkdown","once","omit","remarkDirective","remarkMathPlugin","rehypeRaw","rehypeKatex","Link2","LinkIcon","remarkEmoji","remarkGfm","CodeBlock","IsDialogContext","IsSidebarContext","ErrorBoundary","InlineTooltipIcon","getMarkdownTextColors","getMarkdownBgColors","LibContext","StyledLinkIcon","StyledHeadingActionElements","StyledStreamlitMarkdown","StyledHeadingWithActionElements","xxhash","StreamlitSyntaxHighlighter","Fragment","_Fragment","jsx","_jsx","jsxs","_jsxs","Tags","createAnchorFromText","text","newAnchor","isASCII","test","toLowerCase","split","filter","Boolean","join","h32","toString","transformLinkUri","href","scrollNodeIntoView","node","scrollIntoView","HeaderActionElements","_ref","elementId","help","hideAnchor","children","content","concat","size","HeadingWithActionElements","_ref2","tag","anchor","propsAnchor","tagProps","isInSidebar","useContext","isInDialog","setElementId","useState","target","setTarget","addScriptFinishedHandler","removeScriptFinishedHandler","onScriptFinished","useCallback","window","setTimeout","useEffect","ref","textContent","location","hash","slice","isInSidebarOrDialog","actionElements","attributes","id","headerElementWithActions","createElement","CustomHeading","_ref3","rest","tagName","CustomCodeTag","_ref4","inline","className","props","match","exec","codeText","String","trim","replace","language","showLineNumbers","RenderedMarkdown","_ref5","allowHTML","source","overrideComponents","isLabel","disableLinks","renderers","pre","code","a","LinkWithTargetBlank","h1","h2","h3","h4","h5","h6","theme","red","orange","yellow","green","blue","violet","purple","gray","redbg","orangebg","yellowbg","greenbg","bluebg","violetbg","purplebg","graybg","colorMapping","Map","Object","entries","grey","rainbow","remarkColoring","tree","type","nodeName","name","has","data","style","get","hName","hProperties","plugins","rehypePlugins","disallowed","remarkPlugins","components","disallowedElements","unwrapDisallowed","StreamlitMarkdown","constructor","arguments","context","componentDidCatch","assign","Error","message","stack","render","isCaption","boldLabel","largerLabel","isToast","contextType","startsWith","title","rel"],"sources":["../../../../src/components/shared/StreamlitMarkdown/StreamlitMarkdown.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  CSSProperties,\n  FunctionComponent,\n  HTMLProps,\n  PureComponent,\n  ReactElement,\n  ReactNode,\n} from \"react\"\nimport { visit } from \"unist-util-visit\"\nimport { useTheme } from \"@emotion/react\"\nimport ReactMarkdown from \"react-markdown\"\nimport { PluggableList } from \"react-markdown/lib/react-markdown\"\nimport {\n  Components,\n  ReactMarkdownProps,\n} from \"react-markdown/lib/ast-to-react\"\nimport once from \"lodash/once\"\nimport omit from \"lodash/omit\"\nimport remarkDirective from \"remark-directive\"\nimport remarkMathPlugin from \"remark-math\"\nimport rehypeRaw from \"rehype-raw\"\nimport rehypeKatex from \"rehype-katex\"\nimport { Link2 as LinkIcon } from \"react-feather\"\nimport remarkEmoji from \"remark-emoji\"\nimport remarkGfm from \"remark-gfm\"\nimport CodeBlock from \"@streamlit/lib/src/components/elements/CodeBlock\"\nimport IsDialogContext from \"@streamlit/lib/src/components/core/IsDialogContext\"\nimport IsSidebarContext from \"@streamlit/lib/src/components/core/IsSidebarContext\"\nimport ErrorBoundary from \"@streamlit/lib/src/components/shared/ErrorBoundary\"\nimport { InlineTooltipIcon } from \"@streamlit/lib/src/components/shared/TooltipIcon\"\nimport {\n  getMarkdownTextColors,\n  getMarkdownBgColors,\n} from \"@streamlit/lib/src/theme\"\n\nimport { LibContext } from \"@streamlit/lib/src/components/core/LibContext\"\nimport {\n  StyledLinkIcon,\n  StyledHeadingActionElements,\n  StyledStreamlitMarkdown,\n  StyledHeadingWithActionElements,\n} from \"./styled-components\"\n\nimport \"katex/dist/katex.min.css\"\nimport xxhash from \"xxhashjs\"\nimport StreamlitSyntaxHighlighter from \"@streamlit/lib/src/components/elements/CodeBlock/StreamlitSyntaxHighlighter\"\n\nexport enum Tags {\n  H1 = \"h1\",\n  H2 = \"h2\",\n  H3 = \"h3\",\n}\n\nexport interface Props {\n  /**\n   * The Markdown formatted text to render.\n   */\n  source: string\n\n  /**\n   * True if HTML is allowed in the source string. If this is false,\n   * any HTML will be escaped in the output.\n   */\n  allowHTML: boolean\n  style?: CSSProperties\n  isCaption?: boolean\n\n  /**\n   * Indicates widget labels & restricts allowed elements\n   */\n  isLabel?: boolean\n\n  /**\n   * Make the label bold\n   */\n  boldLabel?: boolean\n\n  /**\n   * Checkbox labels have larger font sizing\n   */\n  largerLabel?: boolean\n\n  /**\n   * Does not allow links\n   */\n  disableLinks?: boolean\n\n  /**\n   * Toast has smaller font sizing & special CSS\n   */\n  isToast?: boolean\n}\n\n/**\n * Creates a slug suitable for use as an anchor given a string.\n * Splits the string on non-alphanumeric characters, and joins with a dash.\n */\nexport function createAnchorFromText(text: string | null): string {\n  let newAnchor = \"\"\n  // Check if the text is valid ASCII characters - necessary for fully functional anchors (issue #5291)\n  const isASCII = text && /^[\\x00-\\x7F]*$/.test(text)\n\n  if (isASCII) {\n    newAnchor = text\n      ?.toLowerCase()\n      .split(/[^\\p{L}\\p{N}]+/gu) // split on non-alphanumeric characters\n      .filter(Boolean) // filter out falsy values using Boolean constructor\n      .join(\"-\")\n  } else if (text) {\n    // if the text is not valid ASCII, use a hash of the text\n    newAnchor = xxhash.h32(text, 0xabcd).toString(16)\n  }\n  return newAnchor\n}\n\n// Note: React markdown limits hrefs to specific protocols ('http', 'https',\n// 'mailto', 'tel') We are essentially allowing any URL (a data URL). It can\n// be considered a security flaw, but developers can choose to expose it.\nfunction transformLinkUri(href: string): string {\n  return href\n}\n\n// wrapping in `once` ensures we only scroll once\nconst scrollNodeIntoView = once((node: HTMLElement): void => {\n  node.scrollIntoView(true)\n})\n\ninterface HeadingActionElements {\n  elementId?: string\n  help?: string\n  hideAnchor?: boolean\n}\n\nconst HeaderActionElements: FunctionComponent<HeadingActionElements> = ({\n  elementId,\n  help,\n  hideAnchor,\n}) => {\n  if (!help && hideAnchor) {\n    return <></>\n  }\n\n  return (\n    <StyledHeadingActionElements data-testid=\"stHeaderActionElements\">\n      {help && <InlineTooltipIcon content={help} />}\n      {elementId && !hideAnchor && (\n        <StyledLinkIcon href={`#${elementId}`}>\n          <LinkIcon size=\"18\" />\n        </StyledLinkIcon>\n      )}\n    </StyledHeadingActionElements>\n  )\n}\n\ninterface HeadingWithActionElementsProps {\n  tag: string\n  anchor?: string\n  hideAnchor?: boolean\n  children: ReactNode[] | ReactNode\n  tagProps?: HTMLProps<HTMLHeadingElement>\n  help?: string\n}\n\nexport const HeadingWithActionElements: FunctionComponent<\n  React.PropsWithChildren<HeadingWithActionElementsProps>\n> = ({ tag, anchor: propsAnchor, help, hideAnchor, children, tagProps }) => {\n  const isInSidebar = React.useContext(IsSidebarContext)\n  const isInDialog = React.useContext(IsDialogContext)\n  const [elementId, setElementId] = React.useState(propsAnchor)\n  const [target, setTarget] = React.useState<HTMLElement | null>(null)\n\n  const { addScriptFinishedHandler, removeScriptFinishedHandler } =\n    React.useContext(LibContext)\n  const onScriptFinished = React.useCallback(() => {\n    if (target !== null) {\n      // wait a bit for everything on page to finish loading\n      window.setTimeout(() => {\n        scrollNodeIntoView(target)\n      }, 300)\n    }\n  }, [target])\n\n  React.useEffect(() => {\n    addScriptFinishedHandler(onScriptFinished)\n    return () => {\n      removeScriptFinishedHandler(onScriptFinished)\n    }\n  }, [addScriptFinishedHandler, removeScriptFinishedHandler, onScriptFinished])\n\n  const ref = React.useCallback(\n    (node: any) => {\n      if (node === null) {\n        return\n      }\n\n      const anchor = propsAnchor || createAnchorFromText(node.textContent)\n      setElementId(anchor)\n      if (window.location.hash.slice(1) === anchor) {\n        setTarget(node)\n      }\n    },\n    [propsAnchor]\n  )\n\n  const isInSidebarOrDialog = isInSidebar || isInDialog\n  const actionElements = (\n    <HeaderActionElements\n      elementId={elementId}\n      help={help}\n      hideAnchor={hideAnchor || isInSidebarOrDialog}\n    />\n  )\n\n  const attributes = isInSidebarOrDialog ? {} : { ref, id: elementId }\n  // We nest the action-elements (tooltip, link-icon) into the header element (e.g. h1),\n  // so that it appears inline. For context: we also tried setting the h's display attribute to 'inline', but\n  // then we would need to add padding to the outer container and fiddle with the vertical alignment.\n  const headerElementWithActions = React.createElement(\n    tag,\n    {\n      ...tagProps,\n      ...attributes,\n    },\n    <>\n      {children}\n      {actionElements}\n    </>\n  )\n\n  // we don't want to apply styling, so return the \"raw\" header\n  if (isInSidebarOrDialog) {\n    return headerElementWithActions\n  }\n\n  return (\n    <StyledHeadingWithActionElements data-testid=\"stHeadingWithActionElements\">\n      {headerElementWithActions}\n    </StyledHeadingWithActionElements>\n  )\n}\n\ntype HeadingProps = JSX.IntrinsicElements[\"h1\"] &\n  ReactMarkdownProps & { level: number; \"data-anchor\"?: string }\n\nexport const CustomHeading: FunctionComponent<\n  React.PropsWithChildren<HeadingProps>\n> = ({ node, children, ...rest }) => {\n  const anchor = rest[\"data-anchor\"]\n  return (\n    <HeadingWithActionElements\n      tag={node.tagName}\n      anchor={anchor}\n      tagProps={rest}\n    >\n      {children}\n    </HeadingWithActionElements>\n  )\n}\nexport interface RenderedMarkdownProps {\n  /**\n   * The Markdown formatted text to render.\n   */\n  source: string\n\n  /**\n   * True if HTML is allowed in the source string. If this is false,\n   * any HTML will be escaped in the output.\n   */\n  allowHTML: boolean\n\n  overrideComponents?: Components\n\n  /**\n   * Indicates widget labels & restricts allowed elements\n   */\n  isLabel?: boolean\n\n  /**\n   * Does not allow links\n   */\n  disableLinks?: boolean\n}\n\nexport type CustomCodeTagProps = JSX.IntrinsicElements[\"code\"] &\n  ReactMarkdownProps & { inline?: boolean }\n\n/**\n * Renders code tag with highlighting based on requested language.\n */\nexport const CustomCodeTag: FunctionComponent<\n  React.PropsWithChildren<CustomCodeTagProps>\n> = ({ inline, className, children, ...props }) => {\n  const match = /language-(\\w+)/.exec(className || \"\")\n  const codeText = String(children).trim().replace(/\\n$/, \"\")\n\n  const language = (match && match[1]) || \"\"\n  return !inline ? (\n    <StreamlitSyntaxHighlighter language={language} showLineNumbers={false}>\n      {codeText}\n    </StreamlitSyntaxHighlighter>\n  ) : (\n    <code className={className} {...omit(props, \"node\")}>\n      {children}\n    </code>\n  )\n}\n\nexport function RenderedMarkdown({\n  allowHTML,\n  source,\n  overrideComponents,\n  isLabel,\n  disableLinks,\n}: RenderedMarkdownProps): ReactElement {\n  const renderers: Components = {\n    pre: CodeBlock,\n    code: CustomCodeTag,\n    a: LinkWithTargetBlank,\n    h1: CustomHeading,\n    h2: CustomHeading,\n    h3: CustomHeading,\n    h4: CustomHeading,\n    h5: CustomHeading,\n    h6: CustomHeading,\n    ...(overrideComponents || {}),\n  }\n  const theme = useTheme()\n  const { red, orange, yellow, green, blue, violet, purple, gray } =\n    getMarkdownTextColors(theme)\n  const {\n    redbg,\n    orangebg,\n    yellowbg,\n    greenbg,\n    bluebg,\n    violetbg,\n    purplebg,\n    graybg,\n  } = getMarkdownBgColors(theme)\n  const colorMapping = new Map(\n    Object.entries({\n      red: `color: ${red}`,\n      blue: `color: ${blue}`,\n      green: `color: ${green}`,\n      violet: `color: ${violet}`,\n      orange: `color: ${orange}`,\n      gray: `color: ${gray}`,\n      grey: `color: ${gray}`,\n      // Gradient from red, orange, yellow, green, blue, violet, purple\n      rainbow: `color: transparent; background-clip: text; -webkit-background-clip: text; background-image: linear-gradient(to right,\n        ${red}, ${orange}, ${yellow}, ${green}, ${blue}, ${violet}, ${purple});`,\n      \"red-background\": `background-color: ${redbg}`,\n      \"blue-background\": `background-color: ${bluebg}`,\n      \"green-background\": `background-color: ${greenbg}`,\n      \"violet-background\": `background-color: ${violetbg}`,\n      \"orange-background\": `background-color: ${orangebg}`,\n      \"gray-background\": `background-color: ${graybg}`,\n      \"grey-background\": `background-color: ${graybg}`,\n      // Gradient from red, orange, yellow, green, blue, violet, purple\n      \"rainbow-background\": `background: linear-gradient(to right,\n        ${redbg}, ${orangebg}, ${yellowbg}, ${greenbg}, ${bluebg}, ${violetbg}, ${purplebg});`,\n    })\n  )\n  function remarkColoring() {\n    return (tree: any) => {\n      visit(tree, node => {\n        if (node.type === \"textDirective\") {\n          const nodeName = String(node.name)\n          if (colorMapping.has(nodeName)) {\n            const data = node.data || (node.data = {})\n            const style = colorMapping.get(nodeName)\n            data.hName = \"span\"\n            data.hProperties = data.hProperties || {}\n            data.hProperties.style = style\n            // Add class for background color for custom styling\n            if (\n              style &&\n              (/background-color:/.test(style) || /background:/.test(style))\n            ) {\n              data.hProperties.className =\n                (data.hProperties.className || \"\") + \" has-background-color\"\n            }\n          }\n        }\n      })\n    }\n  }\n  const plugins = [\n    remarkMathPlugin,\n    remarkEmoji,\n    remarkGfm,\n    remarkDirective,\n    remarkColoring,\n  ]\n\n  const rehypePlugins: PluggableList = [\n    rehypeKatex,\n    ...(allowHTML ? [rehypeRaw] : []),\n  ]\n\n  // Sets disallowed markdown for widget labels\n  const disallowed = [\n    // Restricts images, table elements, headings, unordered/ordered lists, task lists, horizontal rules, & blockquotes\n    \"img\",\n    \"table\",\n    \"thead\",\n    \"tbody\",\n    \"tr\",\n    \"th\",\n    \"td\",\n    \"h1\",\n    \"h2\",\n    \"h3\",\n    \"ul\",\n    \"ol\",\n    \"li\",\n    \"input\",\n    \"hr\",\n    \"blockquote\",\n    // additionally restrict links\n    ...(disableLinks ? [\"a\"] : []),\n  ]\n\n  return (\n    <ErrorBoundary>\n      <ReactMarkdown\n        remarkPlugins={plugins}\n        rehypePlugins={rehypePlugins}\n        components={renderers}\n        transformLinkUri={transformLinkUri}\n        disallowedElements={isLabel ? disallowed : []}\n        // unwrap and render children from invalid markdown\n        unwrapDisallowed={true}\n      >\n        {source}\n      </ReactMarkdown>\n    </ErrorBoundary>\n  )\n}\n\n/**\n * Wraps the <ReactMarkdown> component to include our standard\n * renderers and AST plugins (for syntax highlighting, HTML support, etc).\n */\nclass StreamlitMarkdown extends PureComponent<Props> {\n  static contextType = IsSidebarContext\n\n  context!: React.ContextType<typeof IsSidebarContext>\n\n  public componentDidCatch = (): void => {\n    const { source } = this.props\n\n    throw Object.assign(new Error(), {\n      name: \"Error parsing Markdown or HTML in this string\",\n      message: <p>{source}</p>,\n      stack: null,\n    })\n  }\n\n  public render(): ReactNode {\n    const {\n      source,\n      allowHTML,\n      style,\n      isCaption,\n      isLabel,\n      boldLabel,\n      largerLabel,\n      disableLinks,\n      isToast,\n    } = this.props\n    const isInSidebar = this.context\n\n    return (\n      <StyledStreamlitMarkdown\n        isCaption={Boolean(isCaption)}\n        isInSidebar={isInSidebar}\n        isLabel={isLabel}\n        boldLabel={boldLabel}\n        largerLabel={largerLabel}\n        isToast={isToast}\n        style={style}\n        data-testid={isCaption ? \"stCaptionContainer\" : \"stMarkdownContainer\"}\n      >\n        <RenderedMarkdown\n          source={source}\n          allowHTML={allowHTML}\n          isLabel={isLabel}\n          disableLinks={disableLinks}\n        />\n      </StyledStreamlitMarkdown>\n    )\n  }\n}\n\ninterface LinkProps {\n  node: any\n  children: ReactNode[]\n  href?: string\n  title?: string\n  target?: string\n  rel?: string\n}\n\n// Using target=\"_blank\" without rel=\"noopener noreferrer\" is a security risk:\n// see https://mathiasbynens.github.io/rel-noopener\nexport function LinkWithTargetBlank(props: LinkProps): ReactElement {\n  // if it's a #hash link, don't open in new tab\n  const { href } = props\n  if (href && href.startsWith(\"#\")) {\n    const { children, ...rest } = props\n    return <a {...omit(rest, \"node\")}>{children}</a>\n  }\n\n  const { title, children, target, rel, ...rest } = props\n  return (\n    <a\n      href={href}\n      title={title}\n      target={target || \"_blank\"}\n      rel={rel || \"noopener noreferrer\"}\n      {...omit(rest, \"node\")}\n    >\n      {children}\n    </a>\n  )\n}\n\nexport default StreamlitMarkdown\n"],"mappings":"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"}