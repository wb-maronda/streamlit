{"version":3,"file":"Heading.test.js","names":["React","screen","render","Heading","HeadingProto","IsDialogContext","IsSidebarContext","jsx","_jsx","getHeadingProps","elementProps","arguments","length","undefined","width","element","create","anchor","tag","body","describe","it","props","heading","getByRole","expect","toHaveTextContent","not","getByText","toBeInTheDocument","getAllByTestId","toHaveLength","link","hidden","toHaveAttribute","hideAnchor","queryByRole","Provider","value","children","help","tooltip","getByTestId","queryByTestId","divider","toHaveStyle"],"sources":["../../../../src/components/shared/StreamlitMarkdown/Heading.test.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\nimport \"@testing-library/jest-dom\"\n\nimport { screen } from \"@testing-library/react\"\nimport { render } from \"@streamlit/lib/src/test_util\"\nimport { Heading as HeadingProto } from \"@streamlit/lib/src/proto\"\nimport IsDialogContext from \"@streamlit/lib/src/components/core/IsDialogContext\"\nimport IsSidebarContext from \"@streamlit/lib/src/components/core/IsSidebarContext\"\nimport Heading, { HeadingProtoProps } from \"./Heading\"\n\nconst getHeadingProps = (\n  elementProps: Partial<HeadingProto> = {}\n): HeadingProtoProps => ({\n  width: 300,\n  element: HeadingProto.create({\n    anchor: \"some-anchor\",\n    tag: \"h1\",\n    body: `hello world\n             this is a new line`,\n    ...elementProps,\n  }),\n})\n\ndescribe(\"Heading\", () => {\n  it(\"renders properly after a new line\", () => {\n    const props = getHeadingProps()\n    render(<Heading {...props} />)\n\n    const heading = screen.getByRole(\"heading\")\n    expect(heading).toHaveTextContent(\"hello world\")\n    expect(heading).not.toHaveTextContent(\"this is a new line\")\n    expect(screen.getByText(\"this is a new line\")).toBeInTheDocument()\n    expect(screen.getAllByTestId(\"stMarkdownContainer\")).toHaveLength(1)\n  })\n\n  it(\"renders properly without a new line\", () => {\n    const props = getHeadingProps({ body: \"hello\" })\n    render(<Heading {...props} />)\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\"hello\")\n    expect(screen.getAllByTestId(\"stMarkdownContainer\")).toHaveLength(1)\n  })\n\n  it(\"renders anchor link\", () => {\n    const props = getHeadingProps({ body: \"hello\" })\n    render(<Heading {...props} />)\n\n    // trying to trigger the :hover css state did not work, so using 'hidden: true' here. We have an e2e test to check the hovering.\n    const link = screen.getByRole(\"link\", { hidden: true })\n    expect(link).toHaveAttribute(\"href\", \"#some-anchor\")\n  })\n\n  it(\"does not render anchor link when it is hidden\", () => {\n    const props = getHeadingProps({ body: \"hello\", hideAnchor: true })\n    render(<Heading {...props} />)\n\n    expect(screen.queryByRole(\"link\")).not.toBeInTheDocument()\n  })\n\n  it(\"does not render anchor link in sidebar\", () => {\n    const props = getHeadingProps()\n    render(\n      <IsSidebarContext.Provider value={true}>\n        <Heading {...props} />\n      </IsSidebarContext.Provider>\n    )\n    expect(screen.queryByRole(\"link\")).not.toBeInTheDocument()\n  })\n\n  it(\"does not render anchor link in dialog\", () => {\n    const props = getHeadingProps()\n    render(\n      <IsDialogContext.Provider value={true}>\n        <Heading {...props} />\n      </IsDialogContext.Provider>\n    )\n    expect(screen.queryByRole(\"link\")).not.toBeInTheDocument()\n  })\n\n  it(\"renders properly with help text\", () => {\n    const props = getHeadingProps({ body: \"hello\", help: \"help text\" })\n    render(<Heading {...props} />)\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\"hello\")\n    expect(screen.getAllByTestId(\"stMarkdownContainer\")).toHaveLength(1)\n\n    const tooltip = screen.getByTestId(\"stTooltipIcon\")\n    expect(tooltip).toBeInTheDocument()\n  })\n\n  it(\"renders properly with help text in sidebar\", () => {\n    const props = getHeadingProps({ body: \"hello\", help: \"help text\" })\n    render(\n      <IsSidebarContext.Provider value={true}>\n        <Heading {...props} />\n      </IsSidebarContext.Provider>\n    )\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\"hello\")\n    expect(screen.getAllByTestId(\"stMarkdownContainer\")).toHaveLength(1)\n\n    const tooltip = screen.getByTestId(\"stTooltipIcon\")\n    expect(tooltip).toBeInTheDocument()\n  })\n\n  it(\"renders properly with help text in dialog\", () => {\n    const props = getHeadingProps({ body: \"hello\", help: \"help text\" })\n    render(\n      <IsDialogContext.Provider value={true}>\n        <Heading {...props} />\n      </IsDialogContext.Provider>\n    )\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\"hello\")\n    expect(screen.getAllByTestId(\"stMarkdownContainer\")).toHaveLength(1)\n\n    const tooltip = screen.getByTestId(\"stTooltipIcon\")\n    expect(tooltip).toBeInTheDocument()\n  })\n\n  it(\"does not render ol block\", () => {\n    const props = getHeadingProps({ body: \"1) hello\" })\n    render(<Heading {...props} />)\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\"1) hello\")\n    expect(screen.queryByRole(\"list\")).not.toBeInTheDocument()\n  })\n\n  it(\"does not render ul block\", () => {\n    const props = getHeadingProps({ body: \"* hello\" })\n    render(<Heading {...props} />)\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\"* hello\")\n    expect(screen.queryByRole(\"list\")).not.toBeInTheDocument()\n  })\n\n  it(\"does not render blockquote with >\", () => {\n    const props = getHeadingProps({ body: \">hello\" })\n    render(<Heading {...props} />)\n\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\">hello\")\n    expect(screen.queryByRole(\"blockquote\")).not.toBeInTheDocument()\n  })\n\n  it(\"does not render tables\", () => {\n    const props = getHeadingProps({\n      body: `| Syntax | Description |\n           | ----------- | ----------- |\n           | Header      | Title       |\n           | Paragraph   | Text        |`,\n    })\n    render(<Heading {...props} />)\n\n    expect(screen.getByTestId(\"stMarkdownContainer\")).toHaveTextContent(\n      \"| Syntax | Description || ----------- | ----------- | | Header | Title | | Paragraph | Text |\"\n    )\n    expect(screen.getByRole(\"heading\")).toHaveTextContent(\n      `| Syntax | Description |`\n    )\n    expect(screen.queryByRole(\"table\")).not.toBeInTheDocument()\n    expect(screen.getAllByTestId(\"stMarkdownContainer\")).toHaveLength(1)\n  })\n\n  it(\"renders no divider by default\", () => {\n    const props = getHeadingProps()\n    render(<Heading {...props} />)\n\n    expect(screen.queryByTestId(\"stHeadingDivider\")).not.toBeInTheDocument()\n  })\n\n  it(\"renders a divider with given color\", () => {\n    // correct divider color mapping handled in Block.tsx\n    const props = getHeadingProps({ divider: \"#0068c9\" })\n    render(<Heading {...props} />)\n\n    const divider = screen.getByTestId(\"stHeadingDivider\")\n    expect(divider).toBeInTheDocument()\n    expect(divider).toHaveStyle(\"background-color: #0068c9\")\n  })\n})\n"],"mappings":"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"}