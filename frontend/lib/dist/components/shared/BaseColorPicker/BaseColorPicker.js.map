{"version":3,"file":"BaseColorPicker.js","names":["React","StatefulPopover","UIPopover","ChromePicker","WidgetLabel","StyledWidgetLabelHelpInline","TooltipIcon","Placement","logWarning","StyledColorPicker","StyledChromePicker","StyledColorPreview","StyledColorValue","StyledColorBlock","jsx","_jsx","jsxs","_jsxs","BaseColorPicker","PureComponent","constructor","arguments","state","value","props","onColorChange","color","setState","hex","onColorClose","onChange","componentDidUpdate","prevProps","_","componentDidCatch","error","name","concat","message","forceUpdate","render","width","showValue","label","labelVisibility","help","disabled","children","content","placement","TOP_RIGHT","onClose","disableAlpha","backgroundColor","toUpperCase"],"sources":["../../../../src/components/shared/BaseColorPicker/BaseColorPicker.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\nimport { StatefulPopover as UIPopover } from \"baseui/popover\"\nimport { ChromePicker, ColorResult } from \"react-color\"\nimport {\n  WidgetLabel,\n  StyledWidgetLabelHelpInline,\n} from \"@streamlit/lib/src/components/widgets/BaseWidget\"\nimport TooltipIcon from \"@streamlit/lib/src/components/shared/TooltipIcon\"\nimport { Placement } from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport { LabelVisibilityOptions } from \"@streamlit/lib/src/util/utils\"\nimport { logWarning } from \"@streamlit/lib/src/util/log\"\nimport {\n  StyledColorPicker,\n  StyledChromePicker,\n  StyledColorPreview,\n  StyledColorValue,\n  StyledColorBlock,\n} from \"./styled-components\"\n\nexport interface BaseColorPickerProps {\n  disabled: boolean\n  width?: number\n  value: string\n  showValue?: boolean\n  label: string\n  labelVisibility?: LabelVisibilityOptions\n  onChange: (value: string) => any\n  help?: string\n}\n\ninterface State {\n  /**\n   * The value specified by the user via the UI. If the user didn't touch this\n   * widget's UI, the default value is used.\n   */\n  value: string\n}\n\nclass BaseColorPicker extends React.PureComponent<\n  BaseColorPickerProps,\n  State\n> {\n  public state: State = {\n    value: this.props.value,\n  }\n\n  public componentDidUpdate(prevProps: BaseColorPickerProps): void {\n    if (\n      prevProps.value !== this.props.value &&\n      this.props.value !== this.state.value\n    ) {\n      this.setState((_, prevProps) => {\n        return { value: prevProps.value }\n      })\n    }\n  }\n\n  // Note: This is a \"local\" onChange handler used to update the color preview\n  // (allowing the user to click and drag). this.props.onChange is only called\n  // when the ColorPicker popover is closed.\n  private onColorChange = (color: ColorResult): void => {\n    this.setState({ value: color.hex })\n  }\n\n  private onColorClose = (): void => {\n    this.props.onChange(this.state.value)\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  public componentDidCatch(error: Error): void {\n    if (error?.name === \"SecurityError\") {\n      // 2021.06.30 - on Streamlit Sharing, ColorPicker throws a cross-origin\n      // error when its popover window is closed. There's an issue open in the\n      // react-color repo https://github.com/casesandberg/react-color/issues/806 -\n      // but it's months old and hasn't had a developer response.\n      logWarning(\n        `Swallowing ColorPicker SecurityError '${error.name}: ${error.message}'`\n      )\n\n      // We force an update after this error, to re-mount the UIPopover -\n      // because the error sometimes cause it to be unmounted. This is an\n      // unfortunate hack.\n      this.forceUpdate()\n    } else {\n      throw error\n    }\n  }\n\n  public render(): React.ReactNode {\n    const { width, showValue, label, labelVisibility, help, disabled } =\n      this.props\n    const { value } = this.state\n\n    return (\n      <StyledColorPicker\n        data-testid=\"stColorPicker\"\n        width={width}\n        disabled={disabled}\n      >\n        <WidgetLabel\n          label={label}\n          disabled={disabled}\n          labelVisibility={labelVisibility}\n        >\n          {help && (\n            <StyledWidgetLabelHelpInline>\n              <TooltipIcon content={help} placement={Placement.TOP_RIGHT} />\n            </StyledWidgetLabelHelpInline>\n          )}\n        </WidgetLabel>\n        <UIPopover\n          onClose={this.onColorClose}\n          content={() => (\n            <StyledChromePicker data-testid=\"stColorPickerPopover\">\n              <ChromePicker\n                color={value}\n                onChange={this.onColorChange}\n                disableAlpha={true}\n              />\n            </StyledChromePicker>\n          )}\n        >\n          <StyledColorPreview disabled={disabled}>\n            <StyledColorBlock\n              data-testid=\"stColorBlock\"\n              backgroundColor={value}\n              disabled={disabled}\n            />\n            {showValue && (\n              <StyledColorValue>{value.toUpperCase()}</StyledColorValue>\n            )}\n          </StyledColorPreview>\n        </UIPopover>\n      </StyledColorPicker>\n    )\n  }\n}\n\nexport default BaseColorPicker\n"],"mappings":"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"}