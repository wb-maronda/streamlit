{"version":3,"file":"withPagination.js","names":["React","useEffect","useState","hoistNonReactStatics","Pagination","usePrevious","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","calculateNumPages","items","pageSize","Math","ceil","length","withPagination","WrappedComponent","WithPagination","_ref","resetOnAdd","props","currentPage","updateCurrentPage","totalPages","updateTotalPages","prevItems","onNext","min","onPrevious","max","paginatedItems","slice","children","className"],"sources":["../../../src/hocs/withPagination/withPagination.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ComponentType, ReactElement, useEffect, useState } from \"react\"\nimport hoistNonReactStatics from \"hoist-non-react-statics\"\nimport Pagination from \"@streamlit/lib/src/hocs/withPagination/Pagination\"\nimport { usePrevious } from \"@streamlit/lib/src/util/Hooks\"\n\nexport interface Props {\n  items: any[]\n  pageSize: number\n  resetOnAdd: boolean\n}\n\nconst calculateNumPages = (items: any[], pageSize: number): number =>\n  Math.ceil(items.length / pageSize)\n\nconst withPagination = (\n  WrappedComponent: ComponentType<React.PropsWithChildren<any>>\n): ComponentType<React.PropsWithChildren<any>> => {\n  const WithPagination = ({\n    pageSize,\n    items,\n    resetOnAdd,\n    ...props\n  }: Props): ReactElement => {\n    const [currentPage, updateCurrentPage] = useState<number>(0)\n    const [totalPages, updateTotalPages] = useState<number>(\n      calculateNumPages(items, pageSize)\n    )\n\n    const prevItems: any[] = usePrevious(items)\n\n    useEffect(() => {\n      if (prevItems && prevItems.length !== items.length) {\n        updateTotalPages(calculateNumPages(items, pageSize))\n      }\n      if (prevItems && prevItems.length < items.length) {\n        if (resetOnAdd) {\n          updateCurrentPage(0)\n        }\n      } else if (currentPage + 1 >= totalPages) {\n        updateCurrentPage(totalPages - 1)\n      }\n    }, [items, currentPage, pageSize, prevItems, resetOnAdd, totalPages])\n\n    const onNext = (): void => {\n      updateCurrentPage(Math.min(currentPage + 1, totalPages - 1))\n    }\n\n    const onPrevious = (): void => {\n      updateCurrentPage(Math.max(0, currentPage - 1))\n    }\n\n    const paginatedItems = items.slice(\n      currentPage * pageSize,\n      currentPage * pageSize + pageSize\n    )\n    return (\n      <>\n        <WrappedComponent items={paginatedItems} {...props} />\n        {items.length > pageSize ? (\n          <Pagination\n            className=\"streamlit-paginator\"\n            pageSize={pageSize}\n            totalPages={totalPages}\n            currentPage={currentPage + 1}\n            onNext={onNext}\n            onPrevious={onPrevious}\n          />\n        ) : null}\n      </>\n    )\n  }\n  return hoistNonReactStatics(WithPagination, WrappedComponent)\n}\n\nexport default withPagination\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,IAAiCC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC/E,OAAOC,oBAAoB,MAAM,yBAAyB;AAC1D,OAAOC,UAAU;AACjB,SAASC,WAAW;AAAuC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAQ3D,MAAMC,iBAAiB,GAAGA,CAACC,KAAY,EAAEC,QAAgB,KACvDC,IAAI,CAACC,IAAI,CAACH,KAAK,CAACI,MAAM,GAAGH,QAAQ,CAAC;AAEpC,MAAMI,cAAc,GAClBC,gBAA6D,IACb;EAChD,MAAMC,cAAc,GAAGC,IAAA,IAKI;IAAA,IALH;MACtBP,QAAQ;MACRD,KAAK;MACLS,UAAU;MACV,GAAGC;IACE,CAAC,GAAAF,IAAA;IACN,MAAM,CAACG,WAAW,EAAEC,iBAAiB,CAAC,GAAGvB,QAAQ,CAAS,CAAC,CAAC;IAC5D,MAAM,CAACwB,UAAU,EAAEC,gBAAgB,CAAC,GAAGzB,QAAQ,CAC7CU,iBAAiB,CAACC,KAAK,EAAEC,QAAQ,CACnC,CAAC;IAED,MAAMc,SAAgB,GAAGvB,WAAW,CAACQ,KAAK,CAAC;IAE3CZ,SAAS,CAAC,MAAM;MACd,IAAI2B,SAAS,IAAIA,SAAS,CAACX,MAAM,KAAKJ,KAAK,CAACI,MAAM,EAAE;QAClDU,gBAAgB,CAACf,iBAAiB,CAACC,KAAK,EAAEC,QAAQ,CAAC,CAAC;MACtD;MACA,IAAIc,SAAS,IAAIA,SAAS,CAACX,MAAM,GAAGJ,KAAK,CAACI,MAAM,EAAE;QAChD,IAAIK,UAAU,EAAE;UACdG,iBAAiB,CAAC,CAAC,CAAC;QACtB;MACF,CAAC,MAAM,IAAID,WAAW,GAAG,CAAC,IAAIE,UAAU,EAAE;QACxCD,iBAAiB,CAACC,UAAU,GAAG,CAAC,CAAC;MACnC;IACF,CAAC,EAAE,CAACb,KAAK,EAAEW,WAAW,EAAEV,QAAQ,EAAEc,SAAS,EAAEN,UAAU,EAAEI,UAAU,CAAC,CAAC;IAErE,MAAMG,MAAM,GAAGA,CAAA,KAAY;MACzBJ,iBAAiB,CAACV,IAAI,CAACe,GAAG,CAACN,WAAW,GAAG,CAAC,EAAEE,UAAU,GAAG,CAAC,CAAC,CAAC;IAC9D,CAAC;IAED,MAAMK,UAAU,GAAGA,CAAA,KAAY;MAC7BN,iBAAiB,CAACV,IAAI,CAACiB,GAAG,CAAC,CAAC,EAAER,WAAW,GAAG,CAAC,CAAC,CAAC;IACjD,CAAC;IAED,MAAMS,cAAc,GAAGpB,KAAK,CAACqB,KAAK,CAChCV,WAAW,GAAGV,QAAQ,EACtBU,WAAW,GAAGV,QAAQ,GAAGA,QAC3B,CAAC;IACD,oBACEH,KAAA,CAAAF,SAAA;MAAA0B,QAAA,gBACE5B,IAAA,CAACY,gBAAgB;QAACN,KAAK,EAAEoB,cAAe;QAAA,GAAKV;MAAK,CAAG,CAAC,EACrDV,KAAK,CAACI,MAAM,GAAGH,QAAQ,gBACtBP,IAAA,CAACH,UAAU;QACTgC,SAAS,EAAC,qBAAqB;QAC/BtB,QAAQ,EAAEA,QAAS;QACnBY,UAAU,EAAEA,UAAW;QACvBF,WAAW,EAAEA,WAAW,GAAG,CAAE;QAC7BK,MAAM,EAAEA,MAAO;QACfE,UAAU,EAAEA;MAAW,CACxB,CAAC,GACA,IAAI;IAAA,CACR,CAAC;EAEP,CAAC;EACD,OAAO5B,oBAAoB,CAACiB,cAAc,EAAED,gBAAgB,CAAC;AAC/D,CAAC;AAED,eAAeD,cAAc"}